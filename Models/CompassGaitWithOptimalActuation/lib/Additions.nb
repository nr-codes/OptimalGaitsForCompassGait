(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 11.3' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[    224768,       4849]
NotebookOptionsPosition[    219432,       4746]
NotebookOutlinePosition[    219879,       4763]
CellTagsIndexPosition[    219836,       4760]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell["Begin Package", "Section",ExpressionUUID->"40d0816a-fa7f-4008-9d73-00e95e0ac4d3"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"BeginPackage", "[", 
    RowBox[{"\"\<BipedalLocomotion`CompassGait`\>\"", ",", " ", 
     RowBox[{"{", 
      RowBox[{
      "\"\<GlobalVariables`\>\"", ",", " ", "\"\<Derivatives`\>\"", ",", " ", 
       "\"\<RigidBodyDynamics`\>\"", ",", " ", "\"\<BipedalLocomotion`\>\"", 
       ",", " ", "\"\<BipedalLocomotion`Model`\>\"", ",", " ", 
       "\"\<ContinuationMethods`\>\"", ",", " ", "\"\<HybridDynamics`\>\"", 
       ",", " ", "\"\<Options`\>\""}], "}"}]}], "]"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"FindBifurcations", "::", "usage"}], " ", "=", " ", "\"\<\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"DistributeSIMple", "::", "usage"}], " ", "=", " ", "\"\<\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"RunInParallel", "::", "usage"}], " ", "=", " ", "\"\<\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"GetGaitParameters", "::", "usage"}], " ", "=", " ", "\"\<\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"PlotGaitParameters", "::", "usage"}], " ", "=", " ", "\"\<\>\""}],
   ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"TraceCurve", "::", "usage"}], " ", "=", " ", "\"\<\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"GaitEigenvalues", "::", "usage"}], " ", "=", " ", "\"\<\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"StateBasedSim", "::", "usage"}], " ", "=", " ", "\"\<\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"SaveDataCSV", "::", "usage"}], " ", "=", " ", "\"\<\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"ConvertCSV", "::", "usage"}], " ", "=", " ", "\"\<\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"FindAGait", "::", "usage"}], " ", "=", " ", "\"\<\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"FileToControllerParameters", "::", "usage"}], " ", "=", " ", 
   "\"\<\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"SummarizeGaitParameters", "::", "usage"}], " ", "=", " ", 
   "\"\<\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"FindCSVFile", "::", "usage"}], " ", "=", " ", "\"\<\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"GetTrajectory", "::", "usage"}], " ", "=", " ", "\"\<\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"CompareTrajectory", "::", "usage"}], " ", "=", " ", "\"\<\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"CompassGaitWalk", "::", "usage"}], " ", "=", " ", "\"\<\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"SortGaits", "::", "usage"}], " ", "=", "\"\<\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"TeXLabel", "::", "usage"}], " ", "=", " ", "\"\<\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"LabelTicks", "::", "usage"}], " ", "=", " ", "\"\<\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"LabelFrameTicks", "::", "usage"}], " ", "=", " ", "\"\<\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"SigFig", "::", "usage"}], " ", "=", " ", "\"\<\>\""}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Begin", "[", "\"\<`Private`\>\"", "]"}], ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.854554084870803*^9, 3.8545540851102533`*^9}, {
   3.854554383812429*^9, 3.854554398684801*^9}, 3.854554437340638*^9, {
   3.8545547908745203`*^9, 3.854554791324601*^9}, {3.854558164037156*^9, 
   3.854558169532133*^9}, {3.854938885118904*^9, 3.854938888488986*^9}, {
   3.855574024213398*^9, 3.855574041570818*^9}, {3.855643948502556*^9, 
   3.8556439650497627`*^9}, {3.8557247243995028`*^9, 3.855724734663471*^9}, {
   3.855724877672742*^9, 3.855724880593203*^9}, {3.855725445790845*^9, 
   3.855725478722309*^9}, {3.855726691250908*^9, 3.855726697410988*^9}, {
   3.8560941262825813`*^9, 3.856094142753953*^9}, {3.856094416757451*^9, 
   3.856094419253783*^9}, {3.856095030299399*^9, 3.856095034313809*^9}, {
   3.856096148385545*^9, 3.856096150972767*^9}, {3.856149000094036*^9, 
   3.8561490038372726`*^9}, 3.8565873896318493`*^9, {3.856632349008793*^9, 
   3.856632349158495*^9}, 3.8568017379792757`*^9, {3.856874794260404*^9, 
   3.8568747994298286`*^9}, {3.856879803808823*^9, 3.856879806700198*^9}, {
   3.856881309454574*^9, 3.8568815081717167`*^9}, {3.8568816407613277`*^9, 
   3.856881651985941*^9}, 3.856881684241455*^9, {3.856883570745899*^9, 
   3.856883572489773*^9}, {3.8569667503931417`*^9, 3.856966793378571*^9}, {
   3.8569668370260067`*^9, 3.856966853119844*^9}, {3.857298866118465*^9, 
   3.8572988700389223`*^9}, {3.866699217544802*^9, 3.866699217903943*^9}, {
   3.8666992643889484`*^9, 3.8666992649355526`*^9}, {3.8667022412233744`*^9, 
   3.8667022423331184`*^9}, {3.866789358097704*^9, 3.8667893694257917`*^9}, {
   3.8667896461138268`*^9, 3.86678964631691*^9}, {3.8668180509463143`*^9, 
   3.866818109088249*^9}, {3.867563707825089*^9, 3.8675637119975843`*^9}, {
   3.8676011026986303`*^9, 3.867601106655553*^9}, {3.867645945723783*^9, 
   3.867645948291234*^9}, {3.867652261787821*^9, 3.8676522619630117`*^9}, 
   3.867850332796513*^9, 3.877495888802729*^9, {3.8779517265226183`*^9, 
   3.8779517268216405`*^9}, {3.8780247314743958`*^9, 
   3.8780247355882373`*^9}, {3.8780443070574083`*^9, 
   3.8780443105604243`*^9}, {3.878060564268305*^9, 3.87806056743933*^9}, {
   3.8780963477082787`*^9, 3.8780963522428036`*^9}, 3.8780964951594205`*^9, {
   3.8780978828407407`*^9, 3.8780978862467337`*^9}, {3.8780979589322243`*^9, 
   3.878097960239607*^9}, {3.8802081013431387`*^9, 3.880208101675773*^9}, {
   3.880209481206045*^9, 3.8802094815706267`*^9}, {3.8802124584065313`*^9, 
   3.880212458565683*^9}, {3.880215064588605*^9, 3.8802150705335417`*^9}, {
   3.880215181208042*^9, 3.8802151841440635`*^9}, {3.8829464846841316`*^9, 
   3.8829464882336316`*^9}, {3.883584186905351*^9, 3.8835841881704054`*^9}, {
   3.8841428241740417`*^9, 3.884142827094029*^9}, {3.8841455662829924`*^9, 
   3.884145566424677*^9}, {3.884412695698783*^9, 3.884412698869625*^9}, 
   3.8844138553988314`*^9, {3.8848348998111105`*^9, 3.8848349392340384`*^9}, {
   3.884835020335183*^9, 3.8848350237427363`*^9}, {3.8850586065993176`*^9, 
   3.8850586432588587`*^9}, {3.885112032783352*^9, 3.88511203552642*^9}, {
   3.885112193947436*^9, 3.8851122063740473`*^9}, {3.8851844433858404`*^9, 
   3.8851844464489107`*^9}},
 CellLabel->
  "In[1197]:=",ExpressionUUID->"a3a7bad5-8560-44ad-8ff6-1f133d402706"],

Cell[CellGroupData[{

Cell["Parallel Environment", "Subsection",
 CellChangeTimes->{{3.8549388235365353`*^9, 
  3.854938844254402*^9}},ExpressionUUID->"0fc0648f-236c-473b-ba09-\
67dbd8378466"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"DistributeSIMple", "[", 
    RowBox[{"k_", ",", " ", "p_", ",", " ", "f_"}], "]"}], " ", ":=", " ", 
   RowBox[{"With", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"d", " ", "=", " ", 
       RowBox[{"BLPath", "[", 
        RowBox[{"\"\<Here\>\"", ",", " ", "\"\<\>\""}], "]"}]}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"CloseKernels", "[", "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"LaunchKernels", "[", "k", "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"ParallelEvaluate", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"SetDirectory", "[", 
         RowBox[{"FileNameJoin", "[", 
          RowBox[{"{", 
           RowBox[{"d", ",", " ", "\"\<../../\>\""}], "}"}], "]"}], "]"}], 
        ";", "\[IndentingNewLine]", 
        RowBox[{"<<", " ", "\"\<SIMple`\>\""}], ";", "\[IndentingNewLine]", 
        RowBox[{"<<", " ", "\"\<SIMple`Additions`\>\""}], ";", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"SetDirectory", "[", 
         RowBox[{"FileNameJoin", "[", 
          RowBox[{"{", 
           RowBox[{"d", ",", " ", "\"\<../\>\""}], "}"}], "]"}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"Get", "[", "p", "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"Block", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"NotebookDirectory", " ", "=", " ", 
            RowBox[{"(", 
             RowBox[{"d", "&"}], ")"}]}], "}"}], ",", " ", 
          RowBox[{
           RowBox[{"f", "[", "]"}], ";"}]}], "]"}], ";"}], 
       "\[IndentingNewLine]", "]"}], ";"}]}], "\[IndentingNewLine]", "]"}]}], 
  ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.854558085941215*^9, 3.854558100140071*^9}, {
  3.854558145559473*^9, 3.85455815483916*^9}, {3.854558191339294*^9, 
  3.854558194970531*^9}, {3.8545582281443253`*^9, 3.854558239510241*^9}, {
  3.8545585054222527`*^9, 3.854558577821374*^9}, {3.85455862739889*^9, 
  3.854558671755082*^9}, {3.854558783879055*^9, 3.8545587875287533`*^9}, {
  3.854558838633732*^9, 3.8545588414156*^9}, {3.8545588773656*^9, 
  3.85455887750552*^9}, {3.854893040687716*^9, 3.854893040847621*^9}},
 CellLabel->
  "In[1221]:=",ExpressionUUID->"ed2ed2d1-2eab-46b4-a7fb-a1e5b4baa8ce"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"Attributes", "[", "RunInParallel", "]"}], " ", "=", " ", 
    RowBox[{"{", "HoldAll", "}"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"RunInParallel", "[", 
    RowBox[{"x_", ",", " ", "i__"}], "]"}], " ", ":=", " ", 
   RowBox[{"With", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"path", " ", "=", " ", 
       RowBox[{"BLPath", "[", 
        RowBox[{"\"\<Here\>\"", ",", " ", "\"\<\>\""}], "]"}]}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"ParallelTable", "[", 
      RowBox[{
       RowBox[{"Block", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"NotebookDirectory", " ", "=", " ", 
           RowBox[{"(", 
            RowBox[{"path", "&"}], ")"}]}], "}"}], ",", " ", "x"}], "]"}], 
       ",", " ", "i"}], "]"}]}], "\[IndentingNewLine]", "]"}]}], 
  ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.8848350577043424`*^9, 3.8848351695053415`*^9}, 
   3.8848352153091645`*^9},
 CellLabel->
  "In[1222]:=",ExpressionUUID->"2fb20699-9b60-44eb-a329-8b1a8093b973"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Singular Points", "Subsection",
 CellChangeTimes->{{3.8549388235365353`*^9, 
  3.854938825559662*^9}},ExpressionUUID->"b8f7fd57-fdb1-4608-88ad-\
96a9dbd57358"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"AllRoots", "[", 
    RowBox[{"f_", ",", " ", "x0_", ",", " ", "x1_", ",", " ", 
     RowBox[{"N_", ":", "All"}], ",", " ", 
     RowBox[{"n_", ":", "100"}], ",", " ", 
     RowBox[{"tol_", ":", "Automatic"}]}], "]"}], " ", ":=", " ", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "x", ",", " ", "y", ",", " ", "r", ",", " ", "xr", ",", " ", "yr", ",", 
       " ", "e"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"x", " ", "=", " ", 
       RowBox[{"Subdivide", "[", 
        RowBox[{"x0", ",", " ", "x1", ",", " ", "n"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"DistributeDefinitions", "[", "f", "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"y", " ", "=", " ", 
       RowBox[{"ParallelMap", "[", 
        RowBox[{"f", ",", " ", "x"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"ListQ", "@", 
         RowBox[{"First", "@", "y"}]}], ",", " ", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"r", " ", "=", " ", "BipedalLocomotion`Private`binewton"}], 
         ";", "\[IndentingNewLine]", 
         RowBox[{"y", " ", "=", " ", 
          RowBox[{"y", "\[LeftDoubleBracket]", 
           RowBox[{"All", ",", " ", "1"}], "\[RightDoubleBracket]"}]}], ";"}],
         ",", " ", "\[IndentingNewLine]", 
        RowBox[{"(*", " ", "else", " ", "*)"}], "\[IndentingNewLine]", 
        RowBox[{"r", " ", "=", " ", "BipedalLocomotion`Private`brent"}]}], 
       "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"yr", " ", "=", " ", 
       RowBox[{
        RowBox[{"y", "\[LeftDoubleBracket]", 
         RowBox[{"1", ";;", 
          RowBox[{"-", "2"}]}], "\[RightDoubleBracket]"}], 
        RowBox[{"y", "\[LeftDoubleBracket]", 
         RowBox[{"2", ";;", 
          RowBox[{"-", "1"}]}], "\[RightDoubleBracket]"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"xr", " ", "=", " ", 
       RowBox[{"MapThread", "[", 
        RowBox[{"List", ",", " ", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"x", "\[LeftDoubleBracket]", 
            RowBox[{"1", ";;", 
             RowBox[{"-", "2"}]}], "\[RightDoubleBracket]"}], ",", " ", 
           RowBox[{"x", "\[LeftDoubleBracket]", 
            RowBox[{"2", ";;", 
             RowBox[{"-", "1"}]}], "\[RightDoubleBracket]"}]}], "}"}]}], 
        "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"xr", " ", "=", " ", 
       RowBox[{"Pick", "[", 
        RowBox[{"xr", ",", " ", "yr", ",", " ", 
         RowBox[{"z_", "/;", 
          RowBox[{"Negative", "@", "z"}]}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"xr", " ", "=", " ", 
       RowBox[{"Which", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Length", "@", "xr"}], " ", "\[Equal]", " ", "0"}], ",", 
         " ", "xr", ",", " ", 
         RowBox[{"IntegerQ", "[", "N", "]"}], ",", " ", 
         RowBox[{"Take", "[", 
          RowBox[{"xr", ",", " ", "N"}], "]"}], ",", " ", "True", ",", " ", 
         RowBox[{
         "xr", "\[LeftDoubleBracket]", "N", "\[RightDoubleBracket]"}]}], 
        "]"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"e", " ", "=", " ", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"tol", " ", "===", " ", "Automatic"}], ",", " ", 
         "BipedalLocomotion`Private`TOL", ",", " ", "tol"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"DistributeDefinitions", "[", 
       RowBox[{"r", ",", " ", "e"}], "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"r", " ", "=", " ", 
       RowBox[{"ParallelMap", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"r", "[", 
           RowBox[{"f", ",", " ", 
            RowBox[{
            "#", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], ",", 
            " ", 
            RowBox[{
            "#", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], ",", 
            " ", "e"}], "]"}], "&"}], ",", "  ", "xr"}], "]"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"ParallelMap", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"{", 
            RowBox[{"#", ",", " ", 
             RowBox[{"f", "[", "#", "]"}]}], "}"}], "&"}], ",", " ", "r"}], 
         "]"}], ",", " ", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"x", ",", " ", "y"}], "}"}], "\[Transpose]"}]}], "}"}]}]}], 
    "\[IndentingNewLine]", "]"}]}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.854962676902392*^9, 3.8549626969385977`*^9}, {
   3.854962871492098*^9, 3.854962875369658*^9}, {3.854962911192019*^9, 
   3.854962928375833*^9}, {3.854963081593204*^9, 3.854963085608158*^9}, {
   3.854963322167849*^9, 3.854963332669993*^9}, {3.854963422525527*^9, 
   3.854963474212572*^9}, {3.854963514479826*^9, 3.854963517139811*^9}, {
   3.854963810827924*^9, 3.854963826144905*^9}, {3.855148832864706*^9, 
   3.8551488458788147`*^9}, 3.85514895621675*^9, {3.8551489890337954`*^9, 
   3.855148993773328*^9}},
 CellLabel->
  "In[1224]:=",ExpressionUUID->"4149b298-a09d-49d7-9527-455e6527afa0"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"AllExtrema", "[", 
    RowBox[{"g_", ",", " ", "x0_", ",", " ", "x1_", ",", " ", 
     RowBox[{"h_", ":", "Automatic"}], ",", " ", 
     RowBox[{"N_", ":", "All"}], ",", " ", 
     RowBox[{"n_", ":", "100"}], ",", " ", 
     RowBox[{"tol_", ":", "Automatic"}]}], "]"}], " ", ":=", " ", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"f", ",", " ", "r", ",", " ", "p"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
      "use", " ", "finite", " ", "differencing", " ", "to", " ", "compute", 
       " ", "derivative"}], " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"With", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"h0", " ", "=", " ", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"h", " ", "===", " ", "Automatic"}], ",", " ", 
            RowBox[{"10", "^", 
             RowBox[{"-", "5"}]}], ",", " ", "h"}], "]"}]}], "}"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"f", " ", "=", " ", 
          RowBox[{
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"g", "[", 
               RowBox[{"#", " ", "+", " ", "h0"}], "]"}], "-", 
              RowBox[{"g", "[", 
               RowBox[{"#", " ", "-", " ", "h0"}], "]"}]}], ")"}], " ", "/", 
            " ", 
            RowBox[{"(", 
             RowBox[{"2", "h0"}], ")"}]}], "&"}]}], ";"}]}], 
       "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"r", ",", " ", "p"}], "}"}], " ", "=", " ", 
       RowBox[{"AllRoots", "[", 
        RowBox[{
        "f", ",", "x0", ",", " ", "x1", ",", " ", "N", ",", " ", "n", ",", 
         " ", "tol"}], "]"}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"r", " ", "=", " ", 
       RowBox[{"ParallelMap", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Insert", "[", 
           RowBox[{"#", ",", " ", 
            RowBox[{"g", "[", 
             RowBox[{
             "#", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
             "]"}], ",", " ", "2"}], "]"}], "&"}], ",", " ", "r"}], "]"}]}], 
      ";", "\[IndentingNewLine]", 
      RowBox[{"p", " ", "=", " ", 
       RowBox[{"ParallelMap", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Insert", "[", 
           RowBox[{"#", ",", " ", 
            RowBox[{"g", "[", 
             RowBox[{
             "#", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
             "]"}], ",", " ", "2"}], "]"}], "&"}], ",", " ", "p"}], "]"}]}], 
      ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{"r", ",", " ", "p"}], "}"}]}]}], "\[IndentingNewLine]", 
    "]"}]}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.854962729234233*^9, 3.85496285828948*^9}, {
   3.854962963393778*^9, 3.854962969998252*^9}, {3.854963107364153*^9, 
   3.854963109274497*^9}, {3.8549635752086267`*^9, 3.854963592049882*^9}, {
   3.8549641321573668`*^9, 3.854964237162204*^9}, {3.854964366259593*^9, 
   3.8549643799974318`*^9}, {3.8549647656158752`*^9, 
   3.8549647945100393`*^9}, {3.854967726119782*^9, 3.854967760924787*^9}, 
   3.8549677925793457`*^9, {3.855148857015077*^9, 3.8551488608406487`*^9}, {
   3.855148996959148*^9, 3.855148999854658*^9}},
 CellLabel->
  "In[1225]:=",ExpressionUUID->"f517c87a-0035-49e4-928e-1068c7bcf286"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"Options", "[", "FindBifurcations", "]"}], " ", "=", " ", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"\"\<i\>\"", " ", "\[Rule]", " ", "All"}], ",", " ", 
      RowBox[{"\"\<j\>\"", " ", "\[Rule]", " ", "All"}], ",", " ", 
      RowBox[{"\"\<svd\>\"", " ", "->", " ", "True"}]}], "}"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"SetRank", "[", 
     RowBox[{
      RowBox[{"t_", "?", "NumericQ"}], ",", " ", "f_", ",", " ", 
      RowBox[{"OptionsPattern", "[", "FindBifurcations", "]"}]}], "]"}], " ", 
    ":=", " ", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "c", ",", " ", "R", ",", " ", "S", ",", " ", "r", ",", " ", "i", ",", 
        " ", "j"}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"c", " ", "=", " ", 
        RowBox[{
         RowBox[{"BLbiped", "[", 
          RowBox[{"\"\<\[DoubleStruckC]\>\"", ",", " ", 
           RowBox[{"BLbiped", "[", "\"\<m[0]\>\"", "]"}], ",", " ", 
           "\"\<eq\>\""}], "]"}], "[", "t", "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"c", " ", "=", " ", 
        RowBox[{"CompassGaitPad", "[", 
         RowBox[{"c", ",", " ", 
          RowBox[{"\"\<\[Sigma]\>\"", " ", "\[Rule]", " ", "0.0"}], ",", " ", 
          RowBox[{"\"\<v\>\"", " ", "\[Rule]", " ", "0.0"}], ",", " ", 
          RowBox[{"\"\<J\>\"", " ", "->", " ", "0.0"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"i", " ", "=", " ", 
        RowBox[{"OptionValue", "[", "\"\<i\>\"", "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"j", " ", "=", " ", 
        RowBox[{"OptionValue", "[", "\"\<j\>\"", "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"R", " ", "=", " ", 
        RowBox[{"f", "[", "c", "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"S", " ", "=", " ", 
        RowBox[{
         RowBox[{"SingularValueDecomposition", "[", 
          RowBox[{"R", "\[LeftDoubleBracket]", 
           RowBox[{"2", ",", " ", "i", ",", " ", "j"}], 
           "\[RightDoubleBracket]"}], "]"}], "\[LeftDoubleBracket]", "2", 
         "\[RightDoubleBracket]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Length", "@", "S"}], " ", "-", " ", 
        RowBox[{"Count", "[", 
         RowBox[{
          RowBox[{"Normal", "@", 
           RowBox[{"Diagonal", "@", "S"}]}], ",", " ", 
          RowBox[{"_", "?", "PossibleZeroQ"}]}], "]"}]}]}]}], 
     "\[IndentingNewLine]", "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"IndicatorFunction", "[", 
     RowBox[{
      RowBox[{"t_", "?", "NumericQ"}], ",", " ", "f_"}], "]"}], " ", ":=", 
    " ", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "c", ",", " ", "H", ",", " ", "J", ",", " ", "\[Phi]", ",", " ", "z"}],
        "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
       "algebraic", " ", "bifurcation", " ", "equation", " ", "test"}], " ", 
       "*)"}], "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"c", " ", "=", " ", 
        RowBox[{
         RowBox[{"BLbiped", "[", 
          RowBox[{"\"\<\[DoubleStruckC]\>\"", ",", " ", 
           RowBox[{"BLbiped", "[", "\"\<m[0]\>\"", "]"}], ",", " ", 
           "\"\<eq\>\""}], "]"}], "[", "t", "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"c", " ", "=", " ", 
        RowBox[{"CompassGaitPad", "[", 
         RowBox[{"c", ",", " ", 
          RowBox[{"\"\<\[Sigma]\>\"", " ", "\[Rule]", " ", "0.0"}], ",", " ", 
          RowBox[{"\"\<v\>\"", " ", "\[Rule]", " ", "0.0"}], ",", " ", 
          RowBox[{"\"\<J\>\"", " ", "->", " ", "0.0"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"H", " ", "=", " ", 
        RowBox[{"FiniteDifferenceJacobian", "[", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"f", "[", "#", "]"}], "\[LeftDoubleBracket]", "2", 
            "\[RightDoubleBracket]"}], "&"}], ",", " ", "c"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"J", " ", "=", " ", 
        RowBox[{
         RowBox[{"f", "[", "c", "]"}], "\[LeftDoubleBracket]", "2", 
         "\[RightDoubleBracket]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"\[Phi]", " ", "=", " ", 
        RowBox[{
         RowBox[{
          RowBox[{"NullSpace", "[", "J", "]"}], "\[Transpose]"}], ".", 
         RowBox[{"{", 
          RowBox[{"1", ",", " ", "0"}], "}"}]}]}], ";", " ", 
       RowBox[{"(*", " ", 
        RowBox[{
         RowBox[{"take", " ", "the", " ", "non"}], "-", 
         RowBox[{"switching", " ", "time", " ", "vector"}]}], " ", "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{"z", "  ", "=", " ", 
        RowBox[{"NullSpace", "[", 
         RowBox[{"J", "\[Transpose]"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"Abs", "@", 
        RowBox[{"First", "[", 
         RowBox[{"z", ".", 
          RowBox[{"(", 
           RowBox[{"H", ".", "\[Phi]"}], ")"}], ".", "\[Phi]"}], "]"}]}]}]}], 
     "\[IndentingNewLine]", "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"IndicatorFunction", "[", 
     RowBox[{
      RowBox[{"t_", "?", "NumericQ"}], ",", " ", "r_", ",", " ", "f_", ",", 
      " ", 
      RowBox[{"OptionsPattern", "[", "FindBifurcations", "]"}]}], "]"}], " ", 
    ":=", " ", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"c", ",", " ", "R", ",", " ", "i", ",", " ", "j"}], "}"}], ",",
       "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{"constant", " ", "rank", " ", "test"}], " ", "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"c", " ", "=", " ", 
        RowBox[{
         RowBox[{"BLbiped", "[", 
          RowBox[{"\"\<\[DoubleStruckC]\>\"", ",", " ", 
           RowBox[{"BLbiped", "[", "\"\<m[0]\>\"", "]"}], ",", " ", 
           "\"\<eq\>\""}], "]"}], "[", "t", "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"c", " ", "=", " ", 
        RowBox[{"CompassGaitPad", "[", 
         RowBox[{"c", ",", " ", 
          RowBox[{"\"\<\[Sigma]\>\"", " ", "\[Rule]", " ", "0.0"}], ",", " ", 
          RowBox[{"\"\<v\>\"", " ", "\[Rule]", " ", "0.0"}], ",", " ", 
          RowBox[{"\"\<J\>\"", " ", "->", " ", "0.0"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"i", " ", "=", " ", 
        RowBox[{"OptionValue", "[", "\"\<i\>\"", "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"j", " ", "=", " ", 
        RowBox[{"OptionValue", "[", "\"\<j\>\"", "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"R", " ", "=", " ", 
        RowBox[{"f", "[", "c", "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"SingularValueList", "[", 
         RowBox[{
          RowBox[{"R", "\[LeftDoubleBracket]", 
           RowBox[{"2", ",", " ", "i", ",", " ", "j"}], 
           "\[RightDoubleBracket]"}], ",", " ", "r"}], "]"}], 
        "\[LeftDoubleBracket]", "r", "\[RightDoubleBracket]"}]}]}], 
     "\[IndentingNewLine]", "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"FindBifurcations", "[", 
    RowBox[{
    "f_", ",", " ", "t0_", ",", " ", "a_", ",", " ", "b_", ",", " ", "n_", 
     ",", " ", 
     RowBox[{"opts", ":", 
      RowBox[{"OptionsPattern", "[", "]"}]}]}], "]"}], " ", ":=", " ", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"r", ",", " ", "I"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"OptionValue", "[", "\"\<svd\>\"", "]"}], ",", " ", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"r", " ", "=", " ", 
          RowBox[{"SetRank", "[", 
           RowBox[{"t0", ",", " ", "f", ",", " ", "opts"}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"I", " ", "=", " ", 
          RowBox[{
           RowBox[{"IndicatorFunction", "[", 
            RowBox[{"#", ",", " ", "r", ",", " ", "f", ",", " ", "opts"}], 
            "]"}], "&"}]}], ";"}], ",", " ", "\[IndentingNewLine]", 
        RowBox[{"(*", " ", "else", " ", "*)"}], "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"I", " ", "=", " ", 
          RowBox[{
           RowBox[{"IndicatorFunction", "[", 
            RowBox[{"#", ",", " ", "f"}], "]"}], "&"}]}], ";"}]}], 
       "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"AllExtrema", "[", 
       RowBox[{
       "I", ",", " ", "a", ",", " ", "b", ",", " ", "Automatic", ",", " ", 
        "All", ",", " ", "n"}], "]"}]}]}], "\[IndentingNewLine]", "]"}]}], 
  ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.8545541624796*^9, 3.854554162679956*^9}, {
   3.854554200847146*^9, 3.854554201330524*^9}, {3.854554274547373*^9, 
   3.854554321798624*^9}, {3.854554374195717*^9, 3.854554377698922*^9}, 
   3.85455443987403*^9, {3.8545547681040697`*^9, 3.8545548358827467`*^9}, {
   3.854554869895545*^9, 3.854554931354805*^9}, {3.8545549879268847`*^9, 
   3.854554991161748*^9}, {3.854557226515216*^9, 3.854557227458611*^9}, {
   3.85455803689881*^9, 3.854558038658194*^9}, {3.854559008604949*^9, 
   3.854559013505961*^9}, {3.854559119958178*^9, 3.8545591304734907`*^9}, {
   3.854559216680736*^9, 3.854559230244138*^9}, {3.85455946529762*^9, 
   3.854559469280498*^9}, {3.854958367584342*^9, 3.8549585537905188`*^9}, {
   3.854958592298747*^9, 3.854958694964704*^9}, 3.854958744348557*^9, {
   3.854958812033319*^9, 3.854958818964958*^9}, {3.854959054190542*^9, 
   3.854959054645536*^9}, {3.8549592946134443`*^9, 3.854959385520667*^9}, {
   3.854960302104596*^9, 3.854960428031447*^9}, {3.85496053658902*^9, 
   3.854960545039123*^9}, {3.854960582955916*^9, 3.8549606366205473`*^9}, {
   3.854960710876046*^9, 3.8549607220241957`*^9}, {3.8549609209063663`*^9, 
   3.854961173170587*^9}, {3.854961229904434*^9, 3.854961239108302*^9}, {
   3.854961501602128*^9, 3.8549615174797897`*^9}, {3.85496156852798*^9, 
   3.854961579946329*^9}, {3.854961676134932*^9, 3.854961686834463*^9}, {
   3.854962201995597*^9, 3.854962203014393*^9}, {3.854962333851956*^9, 
   3.854962335447154*^9}, {3.85496299321769*^9, 3.854963057774544*^9}, {
   3.854967264155239*^9, 3.854967264499909*^9}, {3.855149975421509*^9, 
   3.855149998650141*^9}, {3.855150030800272*^9, 3.855150126266122*^9}, {
   3.856801737982956*^9, 3.8568017379862633`*^9}, {3.8771938626837616`*^9, 
   3.8771938662315383`*^9}, {3.877414234642157*^9, 3.8774142397617517`*^9}, {
   3.8779493902526035`*^9, 3.8779494475366936`*^9}, 3.877949506715537*^9, {
   3.8779495373397245`*^9, 3.877949546949417*^9}, {3.877949585803403*^9, 
   3.8779496195974846`*^9}, {3.877949654756876*^9, 3.877949676709132*^9}, {
   3.8779505601140594`*^9, 3.877950584329481*^9}, {3.877950726739441*^9, 
   3.877950730796841*^9}, {3.8779508726502037`*^9, 3.877950920649165*^9}, {
   3.8779509580769653`*^9, 3.8779509876895504`*^9}, 3.877951066395125*^9, {
   3.877951555001102*^9, 3.877951607724475*^9}, {3.877951798987305*^9, 
   3.8779517992695274`*^9}, 3.8779524460501366`*^9},
 CellLabel->
  "In[1226]:=",ExpressionUUID->"4f5010dd-2c29-457d-bb81-73f412955b33"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Gait Generation Routines", "Subsection",
 CellChangeTimes->{{3.8549388235365353`*^9, 3.854938844254402*^9}, {
  3.855724679892379*^9, 
  3.8557246841883087`*^9}},ExpressionUUID->"a3135dd4-19de-478e-8c76-\
8d257af77188"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"Options", "[", "SaveDataCSV", "]"}], " ", "=", " ", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"Write", " ", "\[Rule]", "  ", "None"}], ",", " ", 
      RowBox[{"\"\<ns\>\"", " ", "\[Rule]", " ", 
       RowBox[{"{", "}"}]}]}], "}"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"SaveDataCSV", "[", 
    RowBox[{
    "Man_", ",", " ", "z_", ",", " ", "z0_", ",", " ", "c_", ",", " ", "R_", 
     ",", " ", 
     RowBox[{"A_", ":", 
      RowBox[{"<|", "|>"}]}], ",", " ", 
     RowBox[{"opts", ":", 
      RowBox[{"OptionsPattern", "[", "]"}]}]}], "]"}], " ", ":=", " ", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", "o", "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"o", " ", "=", " ", 
       RowBox[{"OptionValue", "[", "Write", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"o", " ", "=!=", " ", "None"}], ",", " ", 
        RowBox[{
         RowBox[{"Export", "[", 
          RowBox[{"o", ",", 
           RowBox[{"{", 
            RowBox[{"Join", "[", 
             RowBox[{"z", ",", " ", "c"}], "]"}], "}"}], ",", "\"\<CSV\>\""}],
           "]"}], ";"}]}], "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"o", " ", "=", " ", 
       RowBox[{"FilterRules", "[", 
        RowBox[{
         RowBox[{"{", "opts", "}"}], ",", " ", 
         RowBox[{"Options", "@", "ContinuationMethods`Private`data"}]}], 
        "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"ContinuationMethods`Private`data", "[", 
       RowBox[{
       "Man", ",", " ", "z", ",", " ", "z0", ",", " ", "c", ",", " ", "R", 
        ",", " ", "A", ",", " ", "o"}], "]"}]}]}], "\[IndentingNewLine]", 
    "]"}]}], ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.8568738851802*^9, 3.856874052626979*^9}, {
  3.856874345846513*^9, 3.856874346155448*^9}, {3.856874604998075*^9, 
  3.856874669801087*^9}, {3.856874776125922*^9, 3.856874782729302*^9}, {
  3.856874881125875*^9, 3.856874956708856*^9}, {3.8568750474132023`*^9, 
  3.856875052267531*^9}, {3.8568752605370007`*^9, 3.856875260791774*^9}, {
  3.85687696453199*^9, 3.85687698361852*^9}, {3.856877360493216*^9, 
  3.856877365532975*^9}, {3.856877404695097*^9, 3.856877404766564*^9}, {
  3.856878396501712*^9, 3.856878428953266*^9}, {3.856878509246661*^9, 
  3.856878611422751*^9}, {3.8568787221135893`*^9, 3.8568787262518044`*^9}},
 CellLabel->
  "In[1231]:=",ExpressionUUID->"e217c29e-fa28-4204-acf9-013e59f6123f"],

Cell[CellGroupData[{

Cell["Generate a family of gaits", "Subsubsection",
 CellChangeTimes->{{3.8549388235365353`*^9, 3.854938844254402*^9}, {
  3.855724679892379*^9, 3.8557246841883087`*^9}, {3.880208141939741*^9, 
  3.880208166079578*^9}},ExpressionUUID->"26c93218-f94e-491c-a984-\
d86e5ef6845c"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"Options", "[", "TraceCurve", "]"}], " ", "=", " ", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"\"\<h\>\"", " ", "\[Rule]", " ", "Positive"}], ",", " ", 
      RowBox[{"\"\<m\>\"", " ", "\[Rule]", " ", "50"}], ",", " ", 
      RowBox[{"Tolerance", "\[Rule]", " ", "Automatic"}], ",", " ", 
      RowBox[{"\"\<f\>\"", " ", "\[Rule]", " ", "\"\<g\>\""}], ",", " ", 
      RowBox[{"BLGenerateGaits", " ", "\[Rule]", " ", 
       RowBox[{"{", "}"}]}], ",", " ", 
      RowBox[{"Write", " ", "\[Rule]", " ", "None"}], ",", " ", 
      RowBox[{"\"\<mon\>\"", " ", "->", " ", "Automatic"}], ",", " ", 
      RowBox[{"\"\<c0\>\"", " ", "\[Rule]", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"VectorQ", "[", "#", "]"}], ",", " ", "#", ",", " ", 
           RowBox[{
            RowBox[{"#", "[", 
             RowBox[{
              RowBox[{"{", "0", "}"}], ",", " ", "\"\<c\>\""}], "]"}], 
            "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], "]"}], 
         "&"}], ")"}]}]}], "}"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"TraceCurve", "[", 
    RowBox[{"c_", ",", " ", 
     RowBox[{"OptionsPattern", "[", "]"}]}], "]"}], " ", ":=", " ", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "opts", ",", " ", "c0", ",", " ", "man", ",", " ", "h", ",", " ", "m", 
       ",", " ", "tol", ",", " ", "f", ",", " ", "strm", ",", " ", "mon", ",",
        " ", "prnt"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"h", " ", "=", " ", 
       RowBox[{"OptionValue", "[", "\"\<h\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"h", " ", "=", " ", 
       RowBox[{"Which", "[", 
        RowBox[{
         RowBox[{"h", " ", "===", " ", "Positive"}], ",", " ", "0.02", ",", 
         " ", 
         RowBox[{"h", " ", "===", " ", "Negative"}], ",", " ", 
         RowBox[{"-", "0.02"}], ",", " ", "True", ",", " ", "h"}], "]"}]}], 
      ";", "\[IndentingNewLine]", 
      RowBox[{"m", " ", "=", " ", 
       RowBox[{"OptionValue", "[", "\"\<m\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"tol", " ", "=", " ", 
       RowBox[{"OptionValue", "[", "Tolerance", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"mon", " ", "=", " ", 
       RowBox[{"OptionValue", "[", "\"\<mon\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"prnt", " ", "=", " ", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"mon", " ", "===", " ", "None"}], ",", " ", "False", ",", 
         " ", "1"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"mon", " ", "=", " ", 
       RowBox[{"Which", "[", 
        RowBox[{
         RowBox[{"mon", " ", "===", " ", "Automatic"}], ",", " ", "tmon", ",",
          " ", 
         RowBox[{"mon", " ", "===", " ", "None"}], ",", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"{", "}"}], "&"}], ")"}], ",", " ", "True", ",", " ", 
         "mon"}], "]"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"strm", " ", "=", " ", 
       RowBox[{"OptionValue", "[", "Write", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"StringQ", "[", "strm", "]"}], ",", " ", 
        RowBox[{
         RowBox[{"strm", " ", "=", " ", 
          RowBox[{"OpenAppend", "[", 
           RowBox[{"strm", ",", " ", 
            RowBox[{"BinaryFormat", " ", "\[Rule]", " ", "True"}]}], "]"}]}], 
         ";"}]}], "]"}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"opts", " ", "=", " ", 
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{"#", " ", "\[Rule]", " ", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"10.0", "^", 
              RowBox[{"-", "4"}]}], ",", " ", "\[Infinity]"}], "}"}]}], ")"}],
          "&"}], " ", "/@", " ", "ti"}]}], ";", " ", 
      RowBox[{"(*", " ", 
       RowBox[{"\[Tau]", " ", ">", " ", "0"}], " ", "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{"opts", " ", "=", " ", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Man", "\[Rule]", " ", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"Method", " ", "\[Rule]", " ", "cmac"}], ",", " ", 
            RowBox[{"\"\<n\>\"", " ", "\[Rule]", " ", "Positive"}], ",", " ", 
            RowBox[{"Monitor", " ", "\[Rule]", " ", "mon"}], ",", " ", 
            "\[IndentingNewLine]", 
            RowBox[{"\"\<cmdata\>\"", " ", "\[Rule]", " ", "SaveDataCSV"}], 
            ",", "\[IndentingNewLine]", 
            RowBox[{"\"\<cm\>\"", " ", "\[Rule]", " ", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"\"\<max\>\"", " ", "\[Rule]", " ", "5"}], ",", " ", 
               RowBox[{"Print", " ", "\[Rule]", " ", "prnt"}], ",", " ", 
               RowBox[{"\"\<corrector\>\"", " ", "\[Rule]", " ", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"\"\<max\>\"", " ", "\[Rule]", " ", "5"}], ",", " ", 
                  RowBox[{"\"\<dtol\>\"", " ", "\[Rule]", " ", "2"}], ",", 
                  " ", 
                  RowBox[{"Print", " ", "\[Rule]", " ", "prnt"}], ",", " ", 
                  RowBox[{"\"\<b\>\"", " ", "\[Rule]", " ", "opts"}]}], 
                 "}"}]}], ",", " ", 
               RowBox[{"\"\<cmdata\>\"", " ", "\[Rule]", " ", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"\"\<ns\>\"", " ", "\[Rule]", " ", 
                   RowBox[{"Tolerance", " ", "\[Rule]", " ", "tol"}]}], ",", 
                  " ", 
                  RowBox[{"Write", " ", "\[Rule]", " ", "strm"}]}], "}"}]}]}],
               "}"}]}]}], "}"}]}], ",", " ", 
         RowBox[{"\"\<nstol\>\"", " ", "\[Rule]", " ", "tol"}], ",", " ", 
         RowBox[{"\"\<A\>\"", " ", "\[Rule]", " ", 
          RowBox[{"{", "1", "}"}]}]}], "}"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"opts", " ", "=", " ", 
       RowBox[{"MergeOpts", "[", 
        RowBox[{
         RowBox[{"OptionValue", "@", "BLGenerateGaits"}], ",", " ", "opts"}], 
        "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"c0", " ", "=", " ", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"NumericQ", "[", "c", "]"}], ",", " ", 
         RowBox[{"CompassGaitPad", "[", "c", "]"}], ",", " ", "c"}], "]"}]}], 
      ";", "\[IndentingNewLine]", 
      RowBox[{"f", " ", "=", " ", 
       RowBox[{"GetOptimalMap", "[", 
        RowBox[{
         RowBox[{"OptionValue", "[", "\"\<f\>\"", "]"}], ",", " ", 
         RowBox[{
          RowBox[{"OptionValue", "[", "\"\<c0\>\"", "]"}], "[", "c0", "]"}]}],
         "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"f", " ", "=", " ", 
       RowBox[{"BLGenerateGaits", "[", 
        RowBox[{
        "f", ",", " ", "c0", ",", " ", "h", ",", " ", "m", ",", " ", "opts"}],
         "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"strm", " ", "=!=", " ", "None"}], ",", " ", 
        RowBox[{
         RowBox[{"Close", "[", "strm", "]"}], ";"}]}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"KeySort", "@", 
       RowBox[{"Select", "[", 
        RowBox[{"f", ",", " ", 
         RowBox[{
          RowBox[{"#", " ", "=!=", " ", "$Failed"}], "&"}]}], "]"}]}]}]}], 
    "\[IndentingNewLine]", "]"}]}], ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.855724711507362*^9, 3.8557247158021803`*^9}, {
   3.8557247471013193`*^9, 3.855724778668936*^9}, {3.8557254787298822`*^9, 
   3.8557254787335453`*^9}, {3.855726320283205*^9, 3.855726329106023*^9}, {
   3.855726489181137*^9, 3.8557265802317944`*^9}, {3.855726735447865*^9, 
   3.855726812880075*^9}, {3.8557268446366587`*^9, 3.855726853806402*^9}, {
   3.855726884627103*^9, 3.855726961079726*^9}, {3.8557270061648703`*^9, 
   3.855727013117064*^9}, {3.855727062179574*^9, 3.855727072160458*^9}, {
   3.855727155871236*^9, 3.8557271810972757`*^9}, {3.855727262283147*^9, 
   3.855727276422496*^9}, {3.855727385890522*^9, 3.855727400756188*^9}, {
   3.855729382258709*^9, 3.855729446279772*^9}, {3.855729493492116*^9, 
   3.8557295020278254`*^9}, {3.8557298737777452`*^9, 3.855729933726367*^9}, 
   3.8557299788021793`*^9, {3.8565872489301987`*^9, 3.8565873156214733`*^9}, {
   3.856587384241568*^9, 3.856587385320904*^9}, {3.856587517621266*^9, 
   3.856587593180859*^9}, {3.8565876534048347`*^9, 3.8565876656924963`*^9}, {
   3.856587695851906*^9, 3.8565877004120417`*^9}, {3.8565879990268097`*^9, 
   3.856588188937069*^9}, {3.856588246055942*^9, 3.856588313321431*^9}, {
   3.856588355808392*^9, 3.856588399783524*^9}, {3.8565884332621202`*^9, 
   3.856588436464888*^9}, {3.856588473277075*^9, 3.856588489548547*^9}, {
   3.85658873294986*^9, 3.856588733123424*^9}, {3.8565887667613287`*^9, 
   3.856588800004479*^9}, {3.856591124801683*^9, 3.856591149403373*^9}, {
   3.856591190816606*^9, 3.8565912177023582`*^9}, 3.856591291030744*^9, {
   3.856591481922619*^9, 3.8565914860216923`*^9}, {3.856592185476012*^9, 
   3.856592201217637*^9}, {3.856592247293809*^9, 3.8565922476059732`*^9}, {
   3.8565923197292624`*^9, 3.8565923277291613`*^9}, {3.8565923909111423`*^9, 
   3.856592444517362*^9}, 3.856592484895276*^9, {3.8565926662119093`*^9, 
   3.8565926883046703`*^9}, {3.856592730399558*^9, 3.8565927313194723`*^9}, 
   3.856592767297781*^9, {3.8565938849667377`*^9, 3.856593968309268*^9}, {
   3.856593999788789*^9, 3.856594047648243*^9}, 3.85659408884538*^9, {
   3.8565943150370083`*^9, 3.856594361918103*^9}, {3.856594554570108*^9, 
   3.856594561874601*^9}, {3.856595084919137*^9, 3.856595101907007*^9}, {
   3.8565953512296743`*^9, 3.856595351443872*^9}, {3.8565963452063513`*^9, 
   3.856596360368923*^9}, {3.856596844619265*^9, 3.8565968458032293`*^9}, {
   3.8565977110438137`*^9, 3.85659771670227*^9}, 3.856597927068636*^9, {
   3.856621407422782*^9, 3.8566214188624763`*^9}, {3.8566232764378138`*^9, 
   3.856623280270056*^9}, {3.8566288430972843`*^9, 3.8566288539870453`*^9}, {
   3.856628895634552*^9, 3.856628895987537*^9}, {3.8566292850855293`*^9, 
   3.8566293176142*^9}, {3.856629418674306*^9, 3.856629429460453*^9}, {
   3.856632334158849*^9, 3.856632334773099*^9}, 3.8568017379936666`*^9, 
   3.856847647035862*^9, 3.856847740253965*^9, {3.856873840231414*^9, 
   3.85687384913268*^9}, {3.8568745302553263`*^9, 3.856874555437943*^9}, {
   3.856874676573533*^9, 3.856874679592189*^9}, {3.856874735611218*^9, 
   3.856874755833714*^9}, {3.856875117012826*^9, 3.856875176015986*^9}, {
   3.856875212353581*^9, 3.85687523552864*^9}, {3.8568753545003557`*^9, 
   3.8568753831919117`*^9}, {3.8568757574909763`*^9, 3.856875852123042*^9}, {
   3.856875890994533*^9, 3.85687589884235*^9}, {3.856876226780599*^9, 
   3.856876227449315*^9}, {3.8568771511575193`*^9, 3.856877163149777*^9}, {
   3.8568774498479767`*^9, 3.856877456430478*^9}, 3.856877516895208*^9, {
   3.856877556292469*^9, 3.856877592796825*^9}, {3.856877645675391*^9, 
   3.856877646566991*^9}, {3.856877745171905*^9, 3.856877747003873*^9}, {
   3.856877816410293*^9, 3.8568778279324217`*^9}, {3.8568783396518173`*^9, 
   3.856878362652561*^9}, {3.856878695655568*^9, 3.856878714686957*^9}, {
   3.856878785747252*^9, 3.8568787862515783`*^9}, 3.856894305838402*^9, {
   3.856894539874879*^9, 3.8568945479186153`*^9}, {3.857527655277907*^9, 
   3.857527839790515*^9}, {3.857529685333456*^9, 3.857529699077611*^9}, {
   3.857529742325179*^9, 3.857529786493309*^9}, {3.857529892604319*^9, 
   3.857529898983045*^9}, {3.857530186622283*^9, 3.857530187189048*^9}, {
   3.8667082034035807`*^9, 3.86670823817006*^9}, {3.866737606779976*^9, 
   3.8667376101706247`*^9}, {3.8667376764993505`*^9, 3.86673778007862*^9}, {
   3.8667378334384813`*^9, 3.8667378835328293`*^9}, {3.867562144558188*^9, 
   3.8675621742534447`*^9}, {3.867562561083692*^9, 3.867562641984715*^9}, {
   3.8802080628092465`*^9, 3.880208063596259*^9}},
 CellLabel->
  "In[1233]:=",ExpressionUUID->"b5d4582d-9c23-40d4-a4ce-c6341dcb8097"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Find a specific gait", "Subsubsection",
 CellChangeTimes->{{3.8549388235365353`*^9, 3.854938844254402*^9}, {
  3.855724679892379*^9, 3.8557246841883087`*^9}, {3.880208141939741*^9, 
  3.8802081475972233`*^9}},ExpressionUUID->"15499ed9-73ff-47c2-9a4b-\
dccbb90e892c"],

Cell["\<\
This function assumes that cmroot is called under the hood in Homotopy.\
\>", "Text",
 CellChangeTimes->{{3.877881884500114*^9, 
  3.8778818990150995`*^9}},ExpressionUUID->"dd5959e9-8e4e-4024-9909-\
499216d8530e"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"SortGaits", "[", 
     RowBox[{"file_String", ",", " ", 
      RowBox[{"path_", ":", "Automatic"}], ",", " ", 
      RowBox[{"f_", ":", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"#", "\[LeftDoubleBracket]", 
          RowBox[{"\"\<c\>\"", ",", " ", "1", ",", " ", "5"}], 
          "\[RightDoubleBracket]"}], "&"}], ")"}]}]}], "]"}], " ", ":=", " ", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"ctls", ",", " ", "A"}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"ctls", " ", "=", " ", 
        RowBox[{"FileToControllerParameters", "[", "file", "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"A", " ", "=", " ", 
        RowBox[{"ConvertCSV", "[", 
         RowBox[{"file", ",", " ", "path"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"SortGaits", "[", 
        RowBox[{"A", ",", " ", "f"}], "]"}]}]}], "\[IndentingNewLine]", 
     "]"}]}], ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"SortGaits", "[", 
    RowBox[{"A_Association", ",", " ", 
     RowBox[{"f_", ":", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"#", "\[LeftDoubleBracket]", 
         RowBox[{"\"\<c\>\"", ",", " ", "1", ",", " ", "5"}], 
         "\[RightDoubleBracket]"}], "&"}], ")"}]}]}], "]"}], " ", ":=", " ", 
   RowBox[{"SortBy", "[", 
    RowBox[{"A", ",", " ", "f"}], "]"}]}], ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.884412604833104*^9, 3.8844126907237854`*^9}, {
   3.884412728467968*^9, 3.884412787514537*^9}, {3.884412990141947*^9, 
   3.884413033559084*^9}, {3.884413398791577*^9, 3.8844133990908213`*^9}, {
   3.8844134324550295`*^9, 3.8844134696979017`*^9}, {3.8844135937627535`*^9, 
   3.884413618307155*^9}, 3.8844136610090523`*^9, {3.884413827364306*^9, 
   3.8844138326303444`*^9}, 
   3.8859687142355905`*^9},ExpressionUUID->"a66a4221-b087-486d-8743-\
e21226610c93"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"Options", "[", "FindAGait", "]"}], " ", "=", " ", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"\"\<i\>\"", " ", "\[Rule]", " ", "1"}], ",", " ", 
      RowBox[{"\"\<max\>\"", " ", "\[Rule]", " ", "25"}], ",", " ", 
      RowBox[{"\"\<f\>\"", " ", "\[Rule]", " ", "\"\<v\>\""}], ",", " ", 
      RowBox[{"\"\<h\>\"", " ", "\[Rule]", " ", "0.3"}], ",", " ", 
      RowBox[{"\"\<N\>\"", " ", "\[Rule]", " ", "1000"}], ",", " ", 
      RowBox[{"\"\<ftolfun\>\"", " ", "->", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"10.0", "^", 
          RowBox[{"-", "8"}]}], "&"}], ")"}]}], ",", " ", 
      RowBox[{"Man", " ", "->", " ", 
       RowBox[{"{", "}"}]}], ",", " ", 
      RowBox[{"CompassGait", " ", "->", " ", 
       RowBox[{"{", "}"}]}], ",", " ", 
      RowBox[{"\"\<polish\>\"", " ", "->", 
       RowBox[{"{", "}"}]}]}], "}"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"FindAGait", "[", 
     RowBox[{"file_String", ",", " ", 
      RowBox[{"path_", ":", "Automatic"}], ",", " ", 
      RowBox[{"opts", ":", 
       RowBox[{"OptionsPattern", "[", "]"}]}]}], "]"}], " ", ":=", " ", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"ctls", ",", " ", "A"}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"ctls", " ", "=", " ", 
        RowBox[{"FileToControllerParameters", "[", "file", "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"A", " ", "=", " ", 
        RowBox[{"ConvertCSV", "[", 
         RowBox[{"file", ",", " ", "path"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"FindAGait", "[", 
        RowBox[{"A", ",", " ", 
         RowBox[{"MergeOpts", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"CompassGait", " ", "->", " ", "ctls"}], "}"}], ",", " ", 
           RowBox[{"{", "opts", "}"}]}], "]"}]}], "]"}]}]}], 
     "\[IndentingNewLine]", "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"FindAGait", "[", 
     RowBox[{"A_Association", ",", " ", 
      RowBox[{"opts", ":", 
       RowBox[{"OptionsPattern", "[", "]"}]}]}], "]"}], " ", ":=", " ", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"c0", ",", " ", "i"}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"i", " ", "=", " ", 
        RowBox[{"OptionValue", "[", "\"\<i\>\"", "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"c0", " ", "=", " ", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"IntegerQ", "[", "i", "]"}], " ", "||", " ", 
           RowBox[{
            RowBox[{"Head", "[", "i", "]"}], " ", "===", " ", "Key"}]}], ",", 
          " ", "\[IndentingNewLine]", 
          RowBox[{"A", "\[LeftDoubleBracket]", 
           RowBox[{"i", ",", " ", "\"\<c\>\"", ",", " ", "1"}], 
           "\[RightDoubleBracket]"}], ",", " ", "\[IndentingNewLine]", 
          RowBox[{"(*", " ", "else", " ", "*)"}], "\[IndentingNewLine]", 
          RowBox[{"(*", 
           RowBox[{
            RowBox[{"MinimalBy", "[", 
             RowBox[{
              RowBox[{"Values", "@", 
               RowBox[{"A", "\[LeftDoubleBracket]", 
                RowBox[{"All", ",", " ", "\"\<c\>\"", ",", " ", "1"}], 
                "\[RightDoubleBracket]"}]}], ",", " ", "i", ",", " ", "1"}], 
             "]"}], "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
           "*)"}], "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"SortGaits", "[", 
            RowBox[{"A", ",", " ", "i"}], "]"}], "\[LeftDoubleBracket]", 
           RowBox[{"1", ",", " ", "\"\<c\>\"", ",", " ", "1"}], 
           "\[RightDoubleBracket]"}]}], "\[IndentingNewLine]", "]"}]}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"FindAGait", "[", 
        RowBox[{"c0", ",", " ", "opts"}], "]"}]}]}], "\[IndentingNewLine]", 
     "]"}]}], ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"FindAGait", "[", 
    RowBox[{"c0_", ",", " ", 
     RowBox[{"opts", ":", 
      RowBox[{"OptionsPattern", "[", "]"}]}]}], "]"}], " ", ":=", " ", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "f", ",", " ", "h", ",", " ", "N", ",", " ", "o", ",", " ", "strm"}], 
      "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"o", " ", "=", " ", 
       RowBox[{"OptionValue", "[", "CompassGait", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"o", " ", "=!=", " ", 
         RowBox[{"{", "}"}]}], ",", " ", 
        RowBox[{
         RowBox[{"CompassGait", "[", 
          RowBox[{"Normal", "@", "o"}], "]"}], ";"}]}], "]"}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"h", " ", "=", " ", 
       RowBox[{
        RowBox[{"OptionValue", "[", "\"\<ftolfun\>\"", "]"}], "[", "c0", 
        "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"o", " ", "=", " ", 
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{"#", " ", "\[Rule]", " ", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"10.0", "^", 
              RowBox[{"-", "4"}]}], ",", " ", "\[Infinity]"}], "}"}]}], ")"}],
          "&"}], " ", "/@", " ", "ti"}]}], ";", " ", 
      RowBox[{"(*", " ", 
       RowBox[{"\[Tau]", " ", ">", " ", "0"}], " ", "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{"o", " ", "=", " ", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"\"\<max\>\"", " ", "\[Rule]", " ", 
          RowBox[{"OptionValue", "[", "\"\<max\>\"", "]"}]}], ",", " ", 
         RowBox[{"\"\<b\>\"", " ", "\[Rule]", " ", "o"}], ",", " ", 
         RowBox[{"\"\<rtol\>\"", " ", "->", " ", 
          RowBox[{"10.0", "^", 
           RowBox[{"-", "8"}]}]}]}], "}"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"o", " ", "=", " ", 
       RowBox[{"\"\<cm\>\"", " ", "\[Rule]", " ", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"\"\<cm\>\"", " ", "\[Rule]", " ", 
           RowBox[{"\"\<corrector\>\"", " ", "\[Rule]", " ", "o"}]}], ",", 
          " ", 
          RowBox[{"\"\<ftol\>\"", " ", "->", " ", "h"}], ",", " ", 
          RowBox[{"\"\<lsopts\>\"", " ", "->", " ", 
           RowBox[{"\"\<stp\>\"", " ", "->", " ", "0.25"}]}]}], "}"}]}]}], 
      ";", "\[IndentingNewLine]", 
      RowBox[{"o", " ", "=", " ", 
       RowBox[{"MergeOpts", "[", 
        RowBox[{
         RowBox[{"OptionValue", "@", "Man"}], ",", " ", "o"}], "]"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"h", " ", "=", " ", 
       RowBox[{"OptionValue", "[", "\"\<h\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"N", " ", "=", " ", 
       RowBox[{"OptionValue", "[", "\"\<N\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"f", " ", "=", " ", 
       RowBox[{"OptionValue", "[", "\"\<f\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"f", " ", "=", " ", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"StringQ", "[", "f", "]"}], ",", " ", 
         RowBox[{"GetOptimalMap", "[", 
          RowBox[{"f", ",", " ", "c0"}], "]"}], ",", " ", "f"}], "]"}]}], ";",
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"f", " ", "=", " ", 
       RowBox[{"Homotopy", "[", 
        RowBox[{"f", ",", " ", "c0", ",", " ", "h", ",", " ", "N", ",", " ", 
         RowBox[{"Man", " ", "\[Rule]", " ", "o"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"f", " ", "=", " ", 
       RowBox[{"KeySort", "@", 
        RowBox[{"Select", "[", 
         RowBox[{"f", ",", " ", 
          RowBox[{
           RowBox[{"#", " ", "=!=", " ", "$Failed"}], "&"}]}], "]"}]}]}], ";",
       "\[IndentingNewLine]", 
      RowBox[{"polish", "[", 
       RowBox[{"f", ",", " ", 
        RowBox[{"Man", " ", "\[Rule]", " ", "o"}], ",", " ", "opts"}], 
       "]"}]}]}], "\[IndentingNewLine]", "]"}]}], ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.867601247420919*^9, 3.8676012510799503`*^9}, {
   3.86764473783585*^9, 3.867644848893539*^9}, {3.867644901375568*^9, 
   3.867644918895782*^9}, 3.867646185064752*^9, {3.867647468077837*^9, 
   3.867647599426897*^9}, {3.867648577533927*^9, 3.867648580762895*^9}, {
   3.867801360658922*^9, 3.867801392694916*^9}, {3.8678281587117443`*^9, 
   3.867828162079464*^9}, {3.867850309459352*^9, 3.8678503107083473`*^9}, {
   3.867850454267396*^9, 3.867850474605836*^9}, {3.867850528610352*^9, 
   3.86785052936141*^9}, {3.867850971012879*^9, 3.8678509743480186`*^9}, {
   3.867851187984522*^9, 3.867851189349975*^9}, {3.867852490515984*^9, 
   3.867852526955127*^9}, {3.867858956604643*^9, 3.867858990028037*^9}, {
   3.86785903822363*^9, 3.867859050025354*^9}, {3.867859088448473*^9, 
   3.8678590922071333`*^9}, {3.867859133958851*^9, 3.8678591379184113`*^9}, {
   3.867859362613443*^9, 3.867859402141081*^9}, {3.8678594422057133`*^9, 
   3.867859467424761*^9}, {3.867859557740994*^9, 3.867859783349279*^9}, {
   3.8679108786852083`*^9, 3.867910881233407*^9}, {3.867929736366331*^9, 
   3.86792973825629*^9}, {3.867938708286908*^9, 3.867938709593885*^9}, {
   3.867939230211896*^9, 3.867939242603128*^9}, {3.876151747506479*^9, 
   3.8761518009265137`*^9}, {3.8777951097404823`*^9, 
   3.8777951986767197`*^9}, {3.877839699430176*^9, 3.877839705212654*^9}, {
   3.877839741464472*^9, 3.8778397879916487`*^9}, 3.877846467062045*^9, {
   3.877846612752396*^9, 3.877846613198147*^9}, {3.877847528554184*^9, 
   3.8778475490001235`*^9}, {3.87784765605895*^9, 3.877847661685238*^9}, {
   3.8778775088404074`*^9, 3.8778775129840946`*^9}, 3.8778775618625436`*^9, {
   3.8778776175279474`*^9, 3.877877758090105*^9}, {3.87787795686366*^9, 
   3.877878157055771*^9}, {3.8778781896835804`*^9, 3.8778782470942616`*^9}, {
   3.8778795135880423`*^9, 3.877879542266404*^9}, {3.8778795766161156`*^9, 
   3.877879671489465*^9}, {3.8778797032234445`*^9, 3.877879915984208*^9}, {
   3.877879956976179*^9, 3.8778799782203307`*^9}, {3.8778800399179196`*^9, 
   3.8778801565080585`*^9}, {3.8778801887207737`*^9, 3.877880188925697*^9}, {
   3.8778802758784*^9, 3.8778803838206067`*^9}, {3.877880417412056*^9, 
   3.8778804204537387`*^9}, {3.877880508224307*^9, 3.877880518925691*^9}, {
   3.8778808770877576`*^9, 3.877880980146833*^9}, 3.877881148645591*^9, {
   3.877881490938893*^9, 3.877881501652607*^9}, {3.8778817711609993`*^9, 
   3.87788177152466*^9}, {3.8778818099385414`*^9, 3.8778818797993293`*^9}, {
   3.877881938781991*^9, 3.877881966190748*^9}, {3.87788200758395*^9, 
   3.8778820704179087`*^9}, {3.877882104571237*^9, 3.8778821390112457`*^9}, {
   3.8778822386342807`*^9, 3.8778822844792957`*^9}, {3.87788231521867*^9, 
   3.8778823156601305`*^9}, {3.877882360847379*^9, 3.8778824200358863`*^9}, {
   3.877882533725067*^9, 3.8778825400549994`*^9}, {3.877882709457656*^9, 
   3.8778827096479945`*^9}, {3.877882741419402*^9, 3.877882747654707*^9}, {
   3.8778828046832075`*^9, 3.87788280545115*^9}, {3.877882890105654*^9, 
   3.8778829093949227`*^9}, {3.877882980375189*^9, 3.8778829910317373`*^9}, {
   3.8778830551085863`*^9, 3.877883073696658*^9}, {3.8778831880485563`*^9, 
   3.8778831965736036`*^9}, {3.877883285904917*^9, 3.8778833252402496`*^9}, 
   3.8778835585359077`*^9, {3.877883889843643*^9, 3.877883908451098*^9}, {
   3.877884034178334*^9, 3.8778841059461336`*^9}, {3.877885137620186*^9, 
   3.8778852189014254`*^9}, {3.877917670396983*^9, 3.877917696317387*^9}, 
   3.8779192664514227`*^9, {3.8779193464071693`*^9, 3.87791935286985*^9}, {
   3.8779194034142375`*^9, 3.877919403982011*^9}, {3.877919458222002*^9, 
   3.87791955149023*^9}, {3.877919666627889*^9, 3.8779197371741276`*^9}, {
   3.8779198328518987`*^9, 3.8779198370890303`*^9}, {3.877919880910276*^9, 
   3.8779199079440947`*^9}, {3.877920026559231*^9, 3.8779200472453775`*^9}, {
   3.8779208309346037`*^9, 3.877920882869057*^9}, 3.877932155236844*^9, {
   3.8780440960045414`*^9, 3.878044115434576*^9}, {3.8780508649008193`*^9, 
   3.878050905506754*^9}, {3.8780509395904927`*^9, 3.8780509687058973`*^9}, {
   3.8780510142116437`*^9, 3.878051048093232*^9}, {3.8780515349786987`*^9, 
   3.878051535941904*^9}, {3.8780515877862625`*^9, 3.878051604712345*^9}, {
   3.8780516739919386`*^9, 3.8780516743214874`*^9}, {3.878051740337302*^9, 
   3.878051741077795*^9}, {3.878051949095476*^9, 3.8780519530578833`*^9}, 
   3.878052143059436*^9, {3.8780521828305545`*^9, 3.8780521829087024`*^9}, 
   3.878052215978898*^9, {3.8780528349992495`*^9, 3.878052837536091*^9}, {
   3.8780575885307217`*^9, 3.8780576219128227`*^9}, {3.878143089333541*^9, 
   3.8781431392410965`*^9}, {3.8781431876171827`*^9, 
   3.8781432461255507`*^9}, {3.878143315519075*^9, 3.878143320843173*^9}, {
   3.880208298454454*^9, 3.880208312319646*^9}, {3.8805579151649585`*^9, 
   3.8805579369172497`*^9}, {3.8805580838783317`*^9, 
   3.8805581237164974`*^9}, {3.8805584485213957`*^9, 
   3.8805585164598827`*^9}, {3.88055855644475*^9, 3.8805585878563156`*^9}, {
   3.8805596942319717`*^9, 3.8805596962661633`*^9}, {3.880560172656841*^9, 
   3.8805601812640233`*^9}, {3.880560291204421*^9, 3.88056029173812*^9}, {
   3.8805610403775663`*^9, 3.8805610487755966`*^9}, {3.8805611169063053`*^9, 
   3.880561128861253*^9}, {3.8805613055933695`*^9, 3.880561344163047*^9}, {
   3.8805633737636776`*^9, 3.880563375114994*^9}, {3.8805636902548466`*^9, 
   3.8805636920221853`*^9}, {3.8805639662171717`*^9, 
   3.8805639846301937`*^9}, {3.88056404503852*^9, 3.880564061517578*^9}, {
   3.8805641151387873`*^9, 3.880564133764892*^9}, {3.880564165721548*^9, 
   3.8805641661206913`*^9}, {3.880564541842415*^9, 3.8805645691783667`*^9}, {
   3.880564793547063*^9, 3.8805647940689836`*^9}, {3.880600685161587*^9, 
   3.880600701229308*^9}, {3.88060073996441*^9, 3.8806007441570435`*^9}, {
   3.8806009225240507`*^9, 3.880601015204486*^9}, {3.8806013078807707`*^9, 
   3.880601309147016*^9}, {3.8841427949195876`*^9, 3.88414279630117*^9}, {
   3.884142921077696*^9, 3.884142927718204*^9}, {3.8841430572232447`*^9, 
   3.884143058473009*^9}, {3.884143095558365*^9, 3.884143112247325*^9}, {
   3.88414316433681*^9, 3.88414316578887*^9}, {3.8841435519340897`*^9, 
   3.884143588106146*^9}, {3.884144507605937*^9, 3.8841445150254545`*^9}, {
   3.884145573552147*^9, 3.8841456180123253`*^9}, {3.884146143971935*^9, 
   3.8841461443171225`*^9}, {3.8841537040346932`*^9, 
   3.8841537465759664`*^9}, {3.88417895326724*^9, 3.884178969806837*^9}, 
   3.884180404462597*^9, {3.8844136484675384`*^9, 3.884413681722872*^9}, 
   3.8844137781383533`*^9, {3.884413808395246*^9, 3.8844138097013206`*^9}, {
   3.8844139340153074`*^9, 3.8844139484711313`*^9}, {3.884414424680843*^9, 
   3.8844144279656796`*^9}},
 CellLabel->
  "In[1237]:=",ExpressionUUID->"62c8c578-abea-4d3c-8fcd-9793ff0d6020"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{
     RowBox[{"maybe", " ", "move", " ", "into", " ", "Homotopy"}], "..."}], 
    "and", " ", "make", " ", "independent", " ", "from", " ", "FindAGait"}], 
   " ", "*)"}], " ", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"polish", "[", 
     RowBox[{"H_", ",", " ", 
      RowBox[{"OptionsPattern", "[", "FindAGait", "]"}]}], "]"}], " ", ":=", 
    " ", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "ftol", ",", " ", "o", ",", " ", "z0", ",", " ", "z", ",", " ", "C", 
        ",", " ", "C0", ",", " ", "R", ",", " ", "n", ",", " ", "a", ",", " ",
         "co"}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"o", " ", "=", " ", 
        RowBox[{"OptionValue", "[", "Man", "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"o", " ", "=", " ", 
        RowBox[{"OptionValue", "[", 
         RowBox[{"Man", ",", " ", "o", ",", " ", "\"\<cm\>\""}], "]"}]}], ";",
        "\[IndentingNewLine]", 
       RowBox[{"ftol", " ", "=", " ", 
        RowBox[{"OptionValue", "[", 
         RowBox[{"cmroot", ",", " ", "o", ",", " ", "\"\<ftol\>\""}], "]"}]}],
        ";", "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
         RowBox[{"co", " ", "=", " ", 
          RowBox[{"OptionValue", "[", 
           RowBox[{"cmroot", ",", " ", "o", ",", " ", "\"\<cm\>\""}], "]"}]}],
          ";", "\[IndentingNewLine]", 
         RowBox[{"co", " ", "=", " ", 
          RowBox[{"OptionValue", "[", 
           RowBox[{
            RowBox[{"OptionValue", "[", 
             RowBox[{"cmroot", ",", " ", "o", ",", " ", "Method"}], "]"}], 
            ",", " ", "co", ",", " ", "\"\<corrector\>\""}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"co", " ", "=", " ", 
          RowBox[{"MergeOpts", "[", 
           RowBox[{
            RowBox[{"OptionValue", "[", "\"\<polish\>\"", "]"}], ",", " ", 
            "co"}], "]"}]}], ";"}], "*)"}], "\[IndentingNewLine]", 
       RowBox[{"co", " ", "=", " ", 
        RowBox[{"OptionValue", "[", "\"\<polish\>\"", "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"o", "  ", "=", " ", 
        RowBox[{"OptionValue", "[", 
         RowBox[{"cmroot", ",", " ", "o", ",", " ", "\"\<cmdata\>\""}], 
         "]"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"C", " ", "=", " ", 
        RowBox[{"<|", "|>"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"Length", "@", "H"}], " ", ">", " ", "0"}], " ", "&&", " ", 
          RowBox[{
           RowBox[{"H", "\[LeftDoubleBracket]", 
            RowBox[{
             RowBox[{"-", "1"}], ",", " ", "\"\<cmroot\>\"", ",", " ", 
             "\"\<f\>\"", ",", " ", "1", ",", " ", "1"}], 
            "\[RightDoubleBracket]"}], " ", "<", " ", "ftol"}]}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"z0", " ", "=", " ", 
           RowBox[{"Last", "[", 
            RowBox[{"Keys", "[", "H", "]"}], "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"z", " ", "=", " ", 
           RowBox[{"z0", " ", "+", " ", "1"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"C0", " ", "=", " ", 
           RowBox[{"MapThread", "[", 
            RowBox[{"Join", ",", " ", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"H", "\[LeftDoubleBracket]", 
                RowBox[{
                 RowBox[{"-", "1"}], ",", " ", "\"\<c\>\""}], 
                "\[RightDoubleBracket]"}], ",", " ", 
               RowBox[{"H", "\[LeftDoubleBracket]", 
                RowBox[{
                 RowBox[{"-", "1"}], ",", " ", "\"\<\[Lambda]\>\""}], 
                "\[RightDoubleBracket]"}]}], "}"}]}], "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"a", " ", "=", " ", 
           RowBox[{
            RowBox[{"MapThread", "[", 
             RowBox[{"Join", ",", " ", 
              RowBox[{"{", 
               RowBox[{"#2", ",", " ", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"#1", "\[LeftDoubleBracket]", 
                   RowBox[{
                    RowBox[{"-", "1"}], ";;", 
                    RowBox[{"-", "1"}]}], "\[RightDoubleBracket]"}], ",", " ", 
                  RowBox[{"PadLeft", "[", 
                   RowBox[{
                    RowBox[{"{", 
                    RowBox[{"{", "1", "}"}], "}"}], ",", " ", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", " ", 
                    RowBox[{"Length", "@", "#1"}]}], "}"}]}], "]"}]}], 
                 "}"}]}], "}"}]}], "]"}], "&"}]}], ";", "\[IndentingNewLine]",
           "\[IndentingNewLine]", 
          RowBox[{"Catch", "[", "\[IndentingNewLine]", 
           RowBox[{"(*", " ", 
            RowBox[{
            "should", " ", "pass", " ", "in", " ", "corrector", " ", 
             "options"}], " ", "*)"}], "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{
             RowBox[{"{", 
              RowBox[{"C", ",", " ", "R", ",", " ", "n"}], "}"}], " ", "=", 
             " ", 
             RowBox[{"ContinuationMethods`Private`corrector", "[", 
              RowBox[{
               RowBox[{
               "C0", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
               ",", " ", "0", ",", " ", "C0", ",", " ", 
               RowBox[{"\"\<f+\>\"", " ", "->", " ", "a"}], ",", " ", "co"}], 
              "]"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
            RowBox[{"a", " ", "=", " ", 
             RowBox[{"<|", 
              RowBox[{"\"\<polish\>\"", " ", "\[Rule]", " ", 
               RowBox[{"<|", " ", 
                RowBox[{"\"\<nfev\>\"", " ", "\[Rule]", " ", "n"}], "|>"}]}], 
              "|>"}]}], ";", "\[IndentingNewLine]", 
            RowBox[{"Block", "[", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"ContinuationMethods`Private`rframe", " ", "=", " ", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{"#3", ",", " ", 
                    RowBox[{"{", "}"}]}], "}"}], "&"}], ")"}]}], "}"}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"C", " ", "=", " ", 
                RowBox[{"ContinuationMethods`Private`cmdata", "[", 
                 RowBox[{
                 "H", ",", " ", "z", ",", " ", "z0", ",", " ", "C", ",", 
                  RowBox[{"R", "\[LeftDoubleBracket]", 
                   RowBox[{"All", ",", " ", 
                    RowBox[{"1", ";;", 
                    RowBox[{"-", "2"}]}]}], "\[RightDoubleBracket]"}], ",", 
                  " ", "a", ",", " ", "o"}], "]"}]}], ";"}]}], 
             "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
            "\[IndentingNewLine]", 
            RowBox[{"(*", " ", 
             RowBox[{"parse", " ", "out", " ", "homotopy", " ", "parameter"}],
              " ", "*)"}], "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"C", "[", "\"\<\[Lambda]\>\"", "]"}], " ", "=", " ", 
             RowBox[{
              RowBox[{"C", "[", "\"\<c\>\"", "]"}], "\[LeftDoubleBracket]", 
              RowBox[{"All", ",", " ", 
               RowBox[{
                RowBox[{"-", "1"}], ";;", 
                RowBox[{"-", "1"}]}]}], "\[RightDoubleBracket]"}]}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"C", "[", "\"\<c\>\"", "]"}], " ", "=", " ", 
             RowBox[{
              RowBox[{"C", "[", "\"\<c\>\"", "]"}], "\[LeftDoubleBracket]", 
              RowBox[{"All", ",", " ", 
               RowBox[{"1", ";;", 
                RowBox[{"-", "2"}]}]}], "\[RightDoubleBracket]"}]}], ";", 
            "\[IndentingNewLine]", "\[IndentingNewLine]", 
            RowBox[{"(*", " ", 
             RowBox[{"create", " ", "new", " ", "entry"}], " ", "*)"}], 
            "\[IndentingNewLine]", 
            RowBox[{"C", " ", "=", " ", 
             RowBox[{"<|", 
              RowBox[{"z", " ", "->", " ", "C"}], "|>"}]}], ";"}], 
           "\[IndentingNewLine]", "]"}], ";"}]}], "\[IndentingNewLine]", 
        "]"}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"Join", "[", 
        RowBox[{"H", ",", " ", "C"}], "]"}]}]}], "\[IndentingNewLine]", 
     "]"}]}], ";"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.8841428071786876`*^9, 3.8841428110609474`*^9}, {
   3.884144525851452*^9, 3.8841445266099105`*^9}, {3.884144633867651*^9, 
   3.884144649296959*^9}, {3.8841448326600637`*^9, 3.884144835616144*^9}, {
   3.8841448895951643`*^9, 3.8841449015192184`*^9}, 3.884145342763153*^9, 
   3.8841455456183043`*^9, 3.8841455776954947`*^9, {3.884145652094592*^9, 
   3.884145701771469*^9}, {3.884146101941493*^9, 3.8841461210540094`*^9}, {
   3.884146265862274*^9, 3.884146303474944*^9}},
 CellLabel->
  "In[1241]:=",ExpressionUUID->"79daf6ca-e795-4ca2-888d-931c211b5630"],

Cell["need to fix bug in how i and tol are accessed", "Text",
 CellChangeTimes->{{3.8847938490058055`*^9, 
  3.8847938621023684`*^9}},ExpressionUUID->"e14340ba-8d25-46ab-873e-\
d757be768829"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"Attributes", "[", "GetTrajectory", "]"}], " ", "=", " ", 
    RowBox[{"{", "Listable", "}"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"GetTrajectory", "::", "\[Lambda]"}], " ", "=", " ", 
    "\"\<For ``, only reached \[Lambda] = `` (!= 0).\>\""}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"GetTrajectory", "[", 
    RowBox[{"\[Sigma]_", ",", " ", "file_", ",", " ", 
     RowBox[{"path_", ":", "Automatic"}], ",", " ", 
     RowBox[{"opts", ":", 
      RowBox[{"OptionsPattern", "[", "FindAGait", "]"}]}]}], "]"}], " ", ":=",
    " ", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "v", ",", " ", "f", ",", " ", "tol", ",", " ", "i", ",", " ", "hom", 
       ",", " ", "o", ",", " ", "c0", ",", " ", "M", ",", " ", "ann"}], "}"}],
      ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"f", " ", "=", " ", 
       RowBox[{"GetGaitParameters", "[", 
        RowBox[{"file", ",", " ", 
         RowBox[{"Path", " ", "->", " ", "path"}], ",", " ", 
         RowBox[{"\"\<i\>\"", " ", "->", " ", 
          RowBox[{"{", "\"\<v\>\"", "}"}]}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"v", " ", "=", " ", 
       RowBox[{"f", "\[LeftDoubleBracket]", 
        RowBox[{"1", ",", " ", "2", ",", " ", "1"}], 
        "\[RightDoubleBracket]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"ann", " ", "=", " ", 
       RowBox[{"f", "\[LeftDoubleBracket]", 
        RowBox[{"1", ",", " ", "3"}], "\[RightDoubleBracket]"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"f", " ", "=", " ", 
       RowBox[{
        RowBox[{"CompassGaitOpt", "[", 
         RowBox[{"##1", ",", 
          RowBox[{"\"\<\[Sigma]\>\"", "\[Rule]", " ", "\[Sigma]"}], ",", 
          RowBox[{"\"\<v\>\"", "\[Rule]", "v"}]}], "]"}], "&"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"i", " ", "=", " ", 
       RowBox[{
        RowBox[{"Abs", "[", 
         RowBox[{"#", "\[LeftDoubleBracket]", 
          RowBox[{"\"\<c\>\"", ",", " ", "1", ",", " ", "5"}], 
          "\[RightDoubleBracket]"}], "]"}], "&"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"tol", " ", "=", " ", 
       RowBox[{
        RowBox[{
         RowBox[{"10.0", "^", 
          RowBox[{"-", "2"}]}], "/", 
         RowBox[{"Abs", "[", 
          RowBox[{"#", "\[LeftDoubleBracket]", "5", "\[RightDoubleBracket]"}],
           "]"}]}], "&"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"o", " ", "=", " ", 
       RowBox[{"MergeOpts", "[", 
        RowBox[{
         RowBox[{"{", "opts", "}"}], ",", " ", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"\"\<f\>\"", " ", "\[Rule]", " ", "f"}], ",", " ", 
           RowBox[{"\"\<max\>\"", " ", "\[Rule]", " ", "25"}], ",", " ", 
           RowBox[{"\"\<h\>\"", " ", "\[Rule]", " ", "0.3"}], ",", " ", 
           RowBox[{"\"\<ftolfun\>\"", " ", "->", " ", "tol"}], ",", " ", 
           RowBox[{"\"\<i\>\"", " ", "->", " ", "i"}], ",", " ", 
           RowBox[{"Man", " ", "->", " ", 
            RowBox[{"Monitor", " ", "->", " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"{", "}"}], "&"}], ")"}]}]}]}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"hom", " ", "=", " ", 
       RowBox[{"FindAGait", "[", 
        RowBox[{"file", ",", " ", "path", ",", " ", "o"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Length", "@", "hom"}], " ", ">", " ", "0"}], 
        RowBox[{"(*", " ", 
         RowBox[{"&&", " ", 
          RowBox[{
           RowBox[{"Chop", "[", 
            RowBox[{"hom", "\[LeftDoubleBracket]", 
             RowBox[{
              RowBox[{"-", "1"}], ",", " ", "\"\<\[Lambda]\>\"", ",", " ", 
              "1", ",", " ", "1"}], "\[RightDoubleBracket]"}], "]"}], " ", "==",
            " ", "0"}]}], "*)"}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"Chop", "[", 
             RowBox[{"hom", "\[LeftDoubleBracket]", 
              RowBox[{
               RowBox[{"-", "1"}], ",", " ", "\"\<\[Lambda]\>\"", ",", " ", 
               "1", ",", " ", "1"}], "\[RightDoubleBracket]"}], "]"}], " ", "!=",
             " ", "0"}], ",", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"Message", "[", 
             RowBox[{
              RowBox[{"GetTrajectory", "::", "\[Lambda]"}], ",", " ", "file", 
              ",", " ", 
              RowBox[{"hom", "\[LeftDoubleBracket]", 
               RowBox[{
                RowBox[{"-", "1"}], ",", " ", "\"\<\[Lambda]\>\"", ",", " ", 
                "1", ",", " ", "1"}], "\[RightDoubleBracket]"}]}], "]"}], 
            ";"}]}], "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]",
          "\[IndentingNewLine]", 
         RowBox[{"c0", " ", "=", " ", 
          RowBox[{"hom", "\[LeftDoubleBracket]", 
           RowBox[{
            RowBox[{"-", "1"}], ",", " ", "\"\<c\>\"", ",", " ", "1"}], 
           "\[RightDoubleBracket]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"M", " ", "=", " ", 
          RowBox[{"P", "[", 
           RowBox[{
            RowBox[{"BLbiped", "[", "\"\<m[0]\>\"", "]"}], ",", " ", "c0"}], 
           "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"i", " ", "=", " ", 
          RowBox[{
           RowBox[{"Flatten", "[", 
            RowBox[{
             RowBox[{"M", "[", "\"\<x[t]\>\"", "]"}], "[", "\"\<Grid\>\"", 
             "]"}], "]"}], "\[LeftDoubleBracket]", 
           RowBox[{"3", ";;", 
            RowBox[{"-", "2"}]}], "\[RightDoubleBracket]"}]}], ";", " ", 
         RowBox[{"(*", " ", 
          RowBox[{
           RowBox[{"drop", " ", "pre"}], "-", " ", 
           RowBox[{"and", " ", "post"}], "-", "impacts"}], " ", "*)"}], 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"M", "[", "\"\<hom\>\"", "]"}], " ", "=", " ", "hom"}], ";",
          "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"M", "[", "\"\<ann\>\"", "]"}], " ", "=", " ", "ann"}], ";",
          "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"M", "[", "\"\<u[t]\>\"", "]"}], " ", "=", " ", 
          RowBox[{"With", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"u", " ", "=", " ", 
               RowBox[{"BLbiped", "[", "\"\<u\>\"", "]"}]}], ",", " ", 
              RowBox[{"m", " ", "=", " ", 
               RowBox[{"M", "[", "\"\<m[t]\>\"", "]"}]}], ",", " ", 
              RowBox[{"x", " ", "=", " ", 
               RowBox[{"M", "[", "\"\<x[t]\>\"", "]"}]}], ",", " ", 
              RowBox[{"c", " ", "=", " ", 
               RowBox[{"M", "[", "\"\<c[t]\>\"", "]"}]}], ",", " ", 
              RowBox[{"n", " ", "=", " ", "nc"}]}], "}"}], ",", " ", 
            RowBox[{
             RowBox[{
              RowBox[{"u", "[", 
               RowBox[{"m", "[", "#", "]"}], "]"}], "[", 
              RowBox[{
               RowBox[{"devec", "[", 
                RowBox[{
                 RowBox[{"x", "[", "#", "]"}], ",", " ", "nx"}], "]"}], ",", 
               " ", 
               RowBox[{"devec", "[", 
                RowBox[{
                 RowBox[{"c", "[", "#", "]"}], ",", " ", "n"}], "]"}]}], 
              "]"}], "&"}]}], "]"}]}], ";", "\[IndentingNewLine]", "M"}], ",",
         "\[IndentingNewLine]", 
        RowBox[{"(*", " ", "else", " ", "*)"}], "\[IndentingNewLine]", 
        RowBox[{"<|", 
         RowBox[{
          RowBox[{"\"\<hom\>\"", " ", "->", " ", "hom"}], ",", " ", 
          RowBox[{"\"\<ann\>\"", " ", "->", " ", "ann"}]}], "|>"}]}], 
       "\[IndentingNewLine]", "]"}]}]}], "\[IndentingNewLine]", "]"}]}], 
  ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.878056008818906*^9, 3.8780560221667767`*^9}, {
   3.8780571600827413`*^9, 3.8780571624915504`*^9}, 3.8780572218501186`*^9, {
   3.87805741421596*^9, 3.878057415951144*^9}, {3.8780579520398245`*^9, 
   3.8780579662718945`*^9}, {3.878058016957363*^9, 3.878058029263256*^9}, {
   3.878058068702365*^9, 3.878058080967225*^9}, {3.8780584795309143`*^9, 
   3.8780585080992637`*^9}, {3.878058548243252*^9, 3.8780585730742416`*^9}, {
   3.87805867561331*^9, 3.8780586757546406`*^9}, {3.878059094258921*^9, 
   3.8780590970551896`*^9}, {3.878059192412163*^9, 3.878059200666211*^9}, {
   3.878059264767993*^9, 3.8780593005416164`*^9}, {3.8780595261108656`*^9, 
   3.878059548355753*^9}, {3.8780596586382236`*^9, 3.8780597713951*^9}, {
   3.8780598454950056`*^9, 3.8780598563535013`*^9}, {3.8780599794038973`*^9, 
   3.8780600922349615`*^9}, {3.878060122836853*^9, 3.8780601246224327`*^9}, {
   3.8780601817375803`*^9, 3.878060261732552*^9}, {3.8780603313377247`*^9, 
   3.8780605377694883`*^9}, {3.878060720024785*^9, 3.8780607259474545`*^9}, {
   3.8780608194039617`*^9, 3.878060835902707*^9}, {3.878061311474519*^9, 
   3.878061377754534*^9}, {3.878061447922097*^9, 3.8780614513278103`*^9}, {
   3.878061663037053*^9, 3.878061707037074*^9}, 3.8780617427744493`*^9, {
   3.878062023382966*^9, 3.8780621302867403`*^9}, {3.8780633709095526`*^9, 
   3.8780633969207563`*^9}, {3.8780960647434435`*^9, 
   3.8780961425734267`*^9}, {3.8780961791834955`*^9, 
   3.8780962184865203`*^9}, {3.8780963302677903`*^9, 
   3.8780963396783495`*^9}, {3.878096394980807*^9, 3.8780964045286345`*^9}, {
   3.8780964902519655`*^9, 3.8780964913831387`*^9}, {3.8780965381292253`*^9, 
   3.8780965708438244`*^9}, {3.878096644693463*^9, 3.8780967459536905`*^9}, {
   3.8780968165390573`*^9, 3.8780968490074053`*^9}, {3.8780969358116856`*^9, 
   3.87809702722758*^9}, {3.8780971781363544`*^9, 3.8780971938205905`*^9}, {
   3.8780978074794044`*^9, 3.878097812421328*^9}, {3.878097996986662*^9, 
   3.8780980030393305`*^9}, 3.878098374449958*^9, {3.878098521744199*^9, 
   3.87809852583407*^9}, {3.878099096098735*^9, 3.8780990988669834`*^9}, {
   3.87809937980414*^9, 3.878099449961398*^9}, {3.878099481143253*^9, 
   3.878099522246394*^9}, {3.878099809610446*^9, 3.878099810473261*^9}, {
   3.8780998860523243`*^9, 3.8780999313378105`*^9}, {3.878100009293956*^9, 
   3.8781001013190002`*^9}, {3.8781003134835978`*^9, 3.878100382515292*^9}, {
   3.8781004518505573`*^9, 3.8781004675890074`*^9}, {3.8781006497858996`*^9, 
   3.878100664668063*^9}, {3.8781007070302477`*^9, 3.878100719400103*^9}, {
   3.878100835828381*^9, 3.878100838744221*^9}, {3.878100922646294*^9, 
   3.8781009232586217`*^9}, {3.878101083794809*^9, 3.8781010851441126`*^9}, {
   3.878101278466066*^9, 3.8781013119510765`*^9}, {3.878101373067719*^9, 
   3.8781014157073555`*^9}, {3.878101477198444*^9, 3.8781015298010683`*^9}, {
   3.8781016721084223`*^9, 3.878101698750016*^9}, {3.8781018758973885`*^9, 
   3.8781018773006363`*^9}, {3.878101970105899*^9, 3.878101981661041*^9}, {
   3.8781022326570044`*^9, 3.8781022682433567`*^9}, {3.8781023093089423`*^9, 
   3.8781023242040253`*^9}, {3.878102370311433*^9, 3.878102372521243*^9}, {
   3.8781036184292507`*^9, 3.87810362260781*^9}, {3.878103988853165*^9, 
   3.8781041065427403`*^9}, {3.878104938703347*^9, 3.8781049559561253`*^9}, {
   3.87810504846296*^9, 3.878105048604351*^9}, {3.8781052347748685`*^9, 
   3.878105267804171*^9}, 3.878105743708408*^9, 3.8781058281837883`*^9, {
   3.878106058620981*^9, 3.878106079526892*^9}, {3.878158501321662*^9, 
   3.8781585433327494`*^9}, {3.878158582828539*^9, 3.878158618087034*^9}, {
   3.8781587306168623`*^9, 3.8781587781240444`*^9}, {3.878158835401182*^9, 
   3.8781589753985443`*^9}, {3.878159026395094*^9, 3.878159054719136*^9}, {
   3.8781593653902054`*^9, 3.8781593976870337`*^9}, {3.8781631672085147`*^9, 
   3.8781631756556983`*^9}, 3.878163206741992*^9, {3.878181713496488*^9, 
   3.878181753615324*^9}, {3.8781826775567117`*^9, 3.8781827945328465`*^9}, {
   3.8781828335689664`*^9, 3.878182845443121*^9}, {3.8781832042383313`*^9, 
   3.878183263672725*^9}, 3.880208249362034*^9, {3.880209598520057*^9, 
   3.880209600700177*^9}, {3.880558669587536*^9, 3.8805586892735634`*^9}, {
   3.8805589673946676`*^9, 3.8805589695051966`*^9}, {3.8805590743770237`*^9, 
   3.880559185534339*^9}, {3.8805593319712086`*^9, 3.8805594268510633`*^9}, {
   3.8805623142790337`*^9, 3.8805623482691946`*^9}, {3.8805630526680393`*^9, 
   3.8805630564634075`*^9}, {3.8805633122370176`*^9, 3.880563315488472*^9}, 
   3.8805648980399714`*^9, {3.880565195656861*^9, 3.8805651962851725`*^9}, {
   3.8806014741641045`*^9, 3.8806016109905853`*^9}, {3.8841437876701484`*^9, 
   3.8841437917234645`*^9}, {3.884144439433318*^9, 3.884144440933064*^9}, 
   3.884793680746458*^9, {3.8847938125181165`*^9, 3.8847938263278847`*^9}},
 CellLabel->
  "In[1242]:=",ExpressionUUID->"1740d1b1-b4a6-45aa-a2a1-60258f70a1a0"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"CompareTrajectory", "[", 
     RowBox[{"\[Sigma]_", ",", " ", "file_", ",", " ", 
      RowBox[{"path_", ":", "Automatic"}], ",", " ", 
      RowBox[{"opts", ":", 
       RowBox[{"OptionsPattern", "[", "FindAGait", "]"}]}]}], "]"}], " ", ":=",
     " ", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"M", ",", " ", "I", ",", " ", "f"}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"M", " ", "=", " ", 
        RowBox[{"GetTrajectory", "[", 
         RowBox[{
         "\[Sigma]", ",", " ", "file", ",", " ", "path", ",", " ", "opts"}], 
         "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"CompareTrajectory", "[", 
          RowBox[{"M", ",", " ", "opts"}], "]"}], ",", " ", "M"}], "}"}]}]}], 
     "\[IndentingNewLine]", "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"CompareTrajectory", "[", "M_", "]"}], " ", ":=", " ", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"I", ",", " ", "f", ",", " ", "t", ",", " ", "J"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"J", " ", "=", " ", 
      RowBox[{"MapThread", "[", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"NIntegrate", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"#1", "[", 
              RowBox[{"t", " ", "#2"}], "]"}], ".", 
             RowBox[{"#1", "[", 
              RowBox[{"t", " ", "#2"}], "]"}]}], ",", " ", 
            RowBox[{"{", 
             RowBox[{"t", ",", " ", "0", ",", " ", "1"}], "}"}]}], "]"}], " ",
           "+", " ", 
          RowBox[{"#3", "^", "2"}]}], "&"}], ",", "  ", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"M", "\[LeftDoubleBracket]", 
           RowBox[{"All", ",", " ", "\"\<u[t]\>\""}], 
           "\[RightDoubleBracket]"}], ",", " ", 
          RowBox[{"M", "\[LeftDoubleBracket]", 
           RowBox[{"All", ",", " ", "\"\<T\>\"", ",", " ", 
            RowBox[{"-", "1"}]}], "\[RightDoubleBracket]"}], ",", " ", 
          RowBox[{"M", "\[LeftDoubleBracket]", 
           RowBox[{"All", ",", " ", "\"\<p\>\"", ",", " ", 
            RowBox[{"-", "2"}]}], "\[RightDoubleBracket]"}]}], "}"}]}], 
       "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"I", " ", "=", " ", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
          "\"\<x[t]\>\"", ",", " ", "\"\<x[t]\>\"", ",", " ", "\"\<x[t]\>\"", 
           ",", " ", "\"\<x[t]\>\"", ",", " ", "\"\<u[t]\>\""}], "}"}], ",", 
         " ", 
         RowBox[{"{", 
          RowBox[{"3", ",", " ", "4", ",", " ", 
           RowBox[{"nq", " ", "+", "3"}], ",", " ", 
           RowBox[{"nq", " ", "+", "4"}], ",", " ", "nq"}], "}"}]}], "}"}], 
       "\[Transpose]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"f", " ", "=", " ", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"With", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"a", " ", "=", " ", 
             RowBox[{"m", "[", 
              RowBox[{
              "i", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
              "]"}]}], ",", " ", 
            RowBox[{"T", " ", "=", " ", 
             RowBox[{
              RowBox[{"m", "[", "\"\<T\>\"", "]"}], "\[LeftDoubleBracket]", 
              RowBox[{"-", "1"}], "\[RightDoubleBracket]"}]}], ",", " ", 
            RowBox[{"j", " ", "=", " ", 
             RowBox[{"Last", "@", "i"}]}]}], "}"}], ",", " ", 
          RowBox[{"Indexed", "[", 
           RowBox[{
            RowBox[{"a", "[", 
             RowBox[{"t", " ", "T"}], "]"}], ",", " ", "j"}], "]"}]}], "]"}], 
        ",", " ", 
        RowBox[{"{", 
         RowBox[{"i", ",", " ", "I"}], "}"}], ",", " ", 
        RowBox[{"{", 
         RowBox[{"m", ",", " ", "M"}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"I", " ", "=", " ", 
      RowBox[{"{", 
       RowBox[{
       "\"\<\!\(\*SubscriptBox[\(q\), \(1\)]\) (left [dark gray] leg angle)\>\
\"", ",", " ", 
        "\"\<\!\(\*SubscriptBox[\(q\), \(2\)]\) (right [light gray] leg \
angle)\>\"", ",", " ", 
        "\"\<\!\(\*SubscriptBox[OverscriptBox[\(q\), \(.\)], \(1\)]\) (left \
[dark gray] leg angle)\>\"", ",", " ", 
        "\"\<\!\(\*SubscriptBox[OverscriptBox[\(q\), \(.\)], \(2\)]\) (right \
[light gray] leg angle)\>\"", ",", " ", "\"\<u (input)\>\""}], "}"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"Append", "[", 
      RowBox[{
       RowBox[{"MapThread", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Plot", "[", 
           RowBox[{"#1", ",", " ", 
            RowBox[{"{", 
             RowBox[{"t", ",", " ", "0", ",", " ", "1"}], "}"}], ",", " ", 
            RowBox[{"Frame", " ", "->", " ", "True"}], ",", " ", 
            RowBox[{"FrameLabel", "\[Rule]", 
             RowBox[{"{", 
              RowBox[{"\"\<t/\[Tau] (scaled time)\>\"", ",", " ", "#2"}], 
              "}"}]}], ",", " ", 
            RowBox[{"PlotLegends", "\[Rule]", " ", 
             RowBox[{"M", "\[LeftDoubleBracket]", 
              RowBox[{"All", ",", " ", "\"\<ann\>\""}], 
              "\[RightDoubleBracket]"}]}]}], "]"}], "&"}], ",", " ", 
         RowBox[{"{", 
          RowBox[{"f", ",", " ", "I"}], "}"}]}], "]"}], ",", " ", 
       RowBox[{"BarChart", "[", 
        RowBox[{
         RowBox[{"AssociationThread", "[", 
          RowBox[{
           RowBox[{"M", "\[LeftDoubleBracket]", 
            RowBox[{"All", ",", " ", "\"\<ann\>\""}], 
            "\[RightDoubleBracket]"}], " ", "->", " ", "J"}], "]"}], ",", " ", 
         RowBox[{"BarOrigin", "\[Rule]", "Left"}], " ", ",", " ", 
         RowBox[{"ChartLabels", "\[Rule]", " ", 
          RowBox[{"Placed", "[", 
           RowBox[{"Automatic", ",", " ", "Left"}], "]"}]}], ",", " ", 
         RowBox[{"ChartStyle", "\[Rule]", "\"\<Pastel\>\""}], ",", " ", 
         RowBox[{
         "PlotLabel", "\[Rule]", 
          "\"\<Cost Comparison: J = \[Integral]u.u dt + \[Iota]^2\>\""}]}], 
        "]"}]}], "]"}]}]}], "\[IndentingNewLine]", "]"}]}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.878056008818906*^9, 3.8780560221667767`*^9}, {
   3.8780571600827413`*^9, 3.8780571624915504`*^9}, 3.8780572218501186`*^9, {
   3.87805741421596*^9, 3.878057415951144*^9}, {3.8780579520398245`*^9, 
   3.8780579662718945`*^9}, {3.878058016957363*^9, 3.878058029263256*^9}, {
   3.878058068702365*^9, 3.878058080967225*^9}, {3.8780584795309143`*^9, 
   3.8780585080992637`*^9}, {3.878058548243252*^9, 3.8780585730742416`*^9}, {
   3.87805867561331*^9, 3.8780586757546406`*^9}, {3.878059094258921*^9, 
   3.8780590970551896`*^9}, {3.878059192412163*^9, 3.878059200666211*^9}, {
   3.878059264767993*^9, 3.8780593005416164`*^9}, {3.8780595261108656`*^9, 
   3.878059548355753*^9}, {3.8780596586382236`*^9, 3.8780597713951*^9}, {
   3.8780598454950056`*^9, 3.8780598563535013`*^9}, {3.8780599794038973`*^9, 
   3.8780600922349615`*^9}, {3.878060122836853*^9, 3.8780601246224327`*^9}, {
   3.8780601817375803`*^9, 3.878060261732552*^9}, {3.8780603313377247`*^9, 
   3.8780605377694883`*^9}, {3.878060720024785*^9, 3.8780607259474545`*^9}, {
   3.8780608194039617`*^9, 3.878060835902707*^9}, {3.878061311474519*^9, 
   3.878061377754534*^9}, {3.878061447922097*^9, 3.8780614513278103`*^9}, {
   3.878061663037053*^9, 3.878061707037074*^9}, 3.8780617427744493`*^9, {
   3.878062023382966*^9, 3.8780621302867403`*^9}, {3.8780633709095526`*^9, 
   3.8780633969207563`*^9}, {3.8780960647434435`*^9, 
   3.8780961425734267`*^9}, {3.8780961791834955`*^9, 
   3.8780962184865203`*^9}, {3.8780963302677903`*^9, 
   3.8780963396783495`*^9}, {3.878096394980807*^9, 3.8780964045286345`*^9}, {
   3.8780964902519655`*^9, 3.8780964913831387`*^9}, {3.8780965381292253`*^9, 
   3.8780965708438244`*^9}, {3.878096644693463*^9, 3.8780967459536905`*^9}, {
   3.8780968165390573`*^9, 3.8780968490074053`*^9}, {3.8780969358116856`*^9, 
   3.87809702722758*^9}, {3.8780971781363544`*^9, 3.8780971938205905`*^9}, {
   3.8780978074794044`*^9, 3.878097812421328*^9}, {3.878097996986662*^9, 
   3.8780980030393305`*^9}, 3.878098374449958*^9, {3.878098521744199*^9, 
   3.87809852583407*^9}, {3.878099096098735*^9, 3.8780990988669834`*^9}, {
   3.87809937980414*^9, 3.878099449961398*^9}, {3.878099481143253*^9, 
   3.878099522246394*^9}, {3.878099809610446*^9, 3.878099810473261*^9}, {
   3.8780998860523243`*^9, 3.8780999313378105`*^9}, {3.878100009293956*^9, 
   3.8781001013190002`*^9}, {3.8781003134835978`*^9, 3.878100382515292*^9}, {
   3.8781004518505573`*^9, 3.8781004675890074`*^9}, {3.8781006497858996`*^9, 
   3.878100664668063*^9}, {3.8781007070302477`*^9, 3.878100719400103*^9}, {
   3.878100835828381*^9, 3.878100838744221*^9}, {3.878100922646294*^9, 
   3.8781009232586217`*^9}, {3.878101083794809*^9, 3.8781010851441126`*^9}, {
   3.878101278466066*^9, 3.8781013119510765`*^9}, {3.878101373067719*^9, 
   3.8781014157073555`*^9}, {3.878101477198444*^9, 3.8781015298010683`*^9}, {
   3.8781016721084223`*^9, 3.878101698750016*^9}, {3.8781018758973885`*^9, 
   3.8781018773006363`*^9}, {3.878101970105899*^9, 3.878101981661041*^9}, {
   3.8781022326570044`*^9, 3.8781022682433567`*^9}, {3.8781023093089423`*^9, 
   3.8781023242040253`*^9}, {3.878102370311433*^9, 3.878102372521243*^9}, {
   3.8781036184292507`*^9, 3.87810362260781*^9}, {3.878103988853165*^9, 
   3.8781041065427403`*^9}, {3.878104938703347*^9, 3.8781049559561253`*^9}, {
   3.87810504846296*^9, 3.878105048604351*^9}, {3.8781052347748685`*^9, 
   3.878105267804171*^9}, 3.878105743708408*^9, 3.8781058281837883`*^9, {
   3.878106058620981*^9, 3.878106079526892*^9}, {3.878158501321662*^9, 
   3.8781585433327494`*^9}, {3.878158582828539*^9, 3.878158618087034*^9}, {
   3.8781587306168623`*^9, 3.8781587781240444`*^9}, {3.878158835401182*^9, 
   3.8781589753985443`*^9}, {3.878159026395094*^9, 3.878159054719136*^9}, {
   3.8781593653902054`*^9, 3.8781593976870337`*^9}, {3.8781631672085147`*^9, 
   3.8781631756556983`*^9}, 3.878163206741992*^9, {3.878181713496488*^9, 
   3.878181753615324*^9}, {3.8781826775567117`*^9, 3.8781827945328465`*^9}, {
   3.8781828335689664`*^9, 3.878182845443121*^9}, {3.8781832042383313`*^9, 
   3.878183263672725*^9}, 3.880208249362034*^9, {3.8802096115573463`*^9, 
   3.880209612359866*^9}, {3.8805594339251065`*^9, 3.8805594346342773`*^9}, {
   3.8805594820404243`*^9, 3.8805594850790505`*^9}},
 CellLabel->
  "In[1245]:=",ExpressionUUID->"35035a4e-bc5a-4fe6-a56d-ff9fb67102c5"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["CSV File Routines", "Subsection",
 CellChangeTimes->{{3.852300821539905*^9, 3.852300836657745*^9}, {
  3.8802079321837955`*^9, 3.88020793274927*^9}, {3.8802120176921835`*^9, 
  3.8802120258391833`*^9}},ExpressionUUID->"ab68d62e-a30f-4a4d-a6ee-\
eac1cb7d9996"],

Cell[BoxData[
 RowBox[{
  RowBox[{"csvsearchpath", " ", "=", " ", 
   RowBox[{"{", 
    RowBox[{
    "\"\<csv\>\"", ",", " ", "\"\<csv-e\>\"", ",", " ", "\"\<csv-56\>\""}], 
    "}"}]}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.8805251992095475`*^9, 3.8805252302218637`*^9}, {
  3.885215349891212*^9, 3.8852153518279877`*^9}, {3.8859707376881313`*^9, 
  3.885970737782382*^9}},ExpressionUUID->"5794ce50-8ae5-475c-a4e8-\
c2cdafe10ad0"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"FindCSVFile", "[", 
    RowBox[{"file_", ",", " ", 
     RowBox[{"d_", ":", "Automatic"}]}], "]"}], " ", ":=", " ", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"f", ",", " ", "p"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"Which", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"d", " ", "===", " ", "Automatic"}], ",", "  ", 
        RowBox[{
         RowBox[{"p", " ", "=", " ", "csvsearchpath"}], ";"}], ",", " ", 
        "\[IndentingNewLine]", 
        RowBox[{"!", 
         RowBox[{"VectorQ", "[", "d", "]"}]}], ",", " ", 
        RowBox[{
         RowBox[{"p", " ", "=", " ", 
          RowBox[{"{", "d", "}"}]}], ";"}], ",", "\[IndentingNewLine]", 
        "True", ",", " ", 
        RowBox[{
         RowBox[{"p", " ", "=", " ", "d"}], ";"}]}], "\[IndentingNewLine]", 
       "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"p", " ", "=", " ", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"d", " ", "=!=", " ", "None"}], ",", " ", 
         RowBox[{
          RowBox[{
           RowBox[{"BLPath", "[", 
            RowBox[{"\"\<Here\>\"", ",", " ", "#"}], "]"}], "&"}], " ", "/@", 
          " ", "p"}], ",", " ", "\"\<\>\""}], "]"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"f", " ", "=", " ", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"VectorQ", "[", "file", "]"}], ",", " ", "file", ",", " ", 
         RowBox[{"{", "file", "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"f", " ", "=", " ", 
       RowBox[{
        RowBox[{
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"StringEndsQ", "[", 
            RowBox[{"#", ",", " ", "\"\<.csv\>\""}], "]"}], ",", " ", "#", 
           ",", " ", 
           RowBox[{"#", " ", "<>", " ", "\"\<.csv\>\""}]}], "]"}], "&"}], " ",
         "/@", " ", "f"}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"FileNames", "[", 
       RowBox[{"f", ",", " ", "p"}], "]"}]}]}], "\[IndentingNewLine]", 
    "]"}]}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.867601247420919*^9, 3.8676012510799503`*^9}, {
   3.86764473783585*^9, 3.867644848893539*^9}, {3.867644901375568*^9, 
   3.867644918895782*^9}, {3.867646185064752*^9, 3.867646251229742*^9}, {
   3.867651466507391*^9, 3.867651467018255*^9}, {3.867651512809482*^9, 
   3.867651512978277*^9}, {3.867652247821245*^9, 3.867652248151519*^9}, 
   3.8676523385836277`*^9, {3.8780441602243385`*^9, 3.8780441911829147`*^9}, {
   3.87804424169128*^9, 3.8780442831614227`*^9}, {3.878044337558359*^9, 
   3.878044359244135*^9}, {3.8780443954208117`*^9, 3.878044406738465*^9}, {
   3.8780445260963545`*^9, 3.878044653132406*^9}, {3.8780447038944225`*^9, 
   3.878044796134097*^9}, {3.8780489463343124`*^9, 3.8780489598558364`*^9}, {
   3.878049041236029*^9, 3.8780490624742713`*^9}, {3.878049373965025*^9, 
   3.8780493853314934`*^9}, {3.8780494581131935`*^9, 3.878049496015504*^9}, 
   3.878049546757629*^9, 3.8805252151684656`*^9},
 CellLabel->
  "In[1248]:=",ExpressionUUID->"846a2ceb-6e3b-4c90-8ea1-9e1c31850cf6"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"ConvertCSV", "::", "file"}], " ", "=", " ", 
    "\"\<Selecting first of multiple files: ``\>\""}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"ConvertCSV", "[", 
     RowBox[{"file_String", ",", " ", 
      RowBox[{"path_", ":", "Automatic"}], ",", " ", 
      RowBox[{"d_", ":", "False"}]}], "]"}], " ", ":=", " ", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", "f", "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"f", " ", "=", " ", 
        RowBox[{"FindCSVFile", "[", 
         RowBox[{"file", ",", " ", "path"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"f", " ", "=!=", " ", 
          RowBox[{"{", "}"}]}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"Length", "@", "f"}], " ", ">", " ", "1"}], ",", " ", 
            RowBox[{
             RowBox[{"Message", "[", 
              RowBox[{
               RowBox[{"ConvertCSV", "::", "file"}], ",", " ", "f"}], "]"}], 
             ";"}]}], "]"}], ";", "\[IndentingNewLine]", 
          RowBox[{"f", " ", "=", " ", 
           RowBox[{"First", "@", "f"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"IntegerQ", "[", "d", "]"}], ",", " ", 
            RowBox[{
             RowBox[{"FileToControllerParameters", "[", 
              RowBox[{"f", ",", " ", "d"}], "]"}], ";"}]}], "]"}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"ConvertCSV", "[", 
           RowBox[{"Import", "[", "f", "]"}], "]"}]}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"(*", " ", "else", " ", "*)"}], "\[IndentingNewLine]", 
         RowBox[{"<|", "|>"}]}], "\[IndentingNewLine]", "]"}]}]}], 
     "\[IndentingNewLine]", "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ConvertCSV", "[", "csv_", "]"}], " ", ":=", " ", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", "f", "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"f", " ", "=", " ", 
      RowBox[{
       RowBox[{
        RowBox[{"#", "\[LeftDoubleBracket]", 
         RowBox[{"{", "1", "}"}], "\[RightDoubleBracket]"}], " ", "\[Rule]", 
        " ", 
        RowBox[{"<|", 
         RowBox[{"\"\<c\>\"", " ", "\[Rule]", " ", 
          RowBox[{"{", 
           RowBox[{"#", "\[LeftDoubleBracket]", 
            RowBox[{"2", ";;"}], "\[RightDoubleBracket]"}], "}"}]}], "|>"}]}],
        "&"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"Association", "[", 
      RowBox[{"f", " ", "/@", " ", "csv"}], "]"}]}]}], "\[IndentingNewLine]", 
   "]"}]}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.867563643961852*^9, 3.8675637029999247`*^9}, {
   3.867564050601613*^9, 3.867564079701597*^9}, {3.867564137534514*^9, 
   3.867564183797494*^9}, {3.877786481415452*^9, 3.8777865110536385`*^9}, {
   3.877786583772917*^9, 3.877786614420561*^9}, {3.877786761889433*^9, 
   3.877786762239535*^9}, {3.8780488592810855`*^9, 3.878048891611512*^9}, 
   3.8780492418398457`*^9, {3.8780495830494328`*^9, 3.8780495968761797`*^9}, 
   3.878049665870364*^9, {3.8780497912243633`*^9, 3.8780498577844505`*^9}, {
   3.8780498923258696`*^9, 3.8780499045351195`*^9}, {3.8780500513517947`*^9, 
   3.8780500627734575`*^9}, {3.878050094872449*^9, 3.8780501096901145`*^9}, {
   3.8780502644871254`*^9, 3.8780502674576387`*^9}, {3.8780504100009356`*^9, 
   3.878050410471902*^9}, {3.878050481651386*^9, 3.8780505077452736`*^9}, {
   3.878050610435688*^9, 3.8780506123736706`*^9}, {3.878051444981147*^9, 
   3.8780514662918043`*^9}, {3.8780517892678013`*^9, 3.878051860628428*^9}, {
   3.8792597724631066`*^9, 3.8792598029983473`*^9}, {3.88596222552973*^9, 
   3.885962228840461*^9}},ExpressionUUID->"153bfb7e-56b3-44d8-8a4b-\
b8e94bda4888"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"FileToControllerParameters", "::", "parse"}], " ", "=", " ", 
    "\"\<Invalid format.  Cannot parse file: ``.\>\""}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"FileToControllerParameters", "[", 
    RowBox[{"file_", ",", " ", 
     RowBox[{"d_", ":", "False"}]}], "]"}], " ", ":=", " ", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"f", ",", " ", "a", ",", " ", "e", ",", " ", "i"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
      "Here", " ", "we", " ", "assume", " ", "file", " ", "is", " ", "base", 
       " ", "name", " ", "with", " ", 
       RowBox[{"substring", ":", " ", "\"\<*a_e_i_*\>\""}]}], " ", "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"f", " ", "=", " ", 
       RowBox[{"FileBaseName", "[", "file", "]"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"(*", " ", "find", " ", "*)"}], "\[IndentingNewLine]", 
      RowBox[{"a", " ", "=", " ", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"\"\<F\>\"", "~~", "\"\<_\>\"", "~~", 
          RowBox[{"DigitCharacter", ".."}]}], ")"}], "|", 
        RowBox[{"(", 
         RowBox[{"\"\<B\>\"", "~~", "\"\<_\>\"", "~~", 
          RowBox[{"DigitCharacter", ".."}], "~~", "\"\<_\>\"", "~~", 
          RowBox[{"DigitCharacter", ".."}]}], ")"}], "|", "\"\<Z\>\"", "|", 
        "\"\<I\>\""}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"i", " ", "=", " ", 
       RowBox[{"StringPosition", "[", 
        RowBox[{"f", ",", " ", "a", ",", " ", "3"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Length", "@", "i"}], " ", "!=", " ", "3"}], ",", " ", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"Message", "[", 
          RowBox[{
           RowBox[{"FileToControllerParameters", "::", "parse"}], ",", " ", 
           "file"}], "]"}], ";", "\[IndentingNewLine]", 
         RowBox[{"Return", "[", 
          RowBox[{"<|", 
           RowBox[{
            RowBox[{"\"\<a\>\"", " ", "->", " ", 
             RowBox[{"{", "}"}]}], ",", " ", 
            RowBox[{"\"\<e\>\"", " ", "->", " ", 
             RowBox[{"{", "}"}]}], ",", " ", 
            RowBox[{"\"\<i\>\"", " ", "->", " ", "False"}]}], "|>"}], "]"}], 
         ";"}]}], "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", " ", "extract", " ", "*)"}], "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"a", ",", " ", "e", ",", " ", "i"}], "}"}], " ", "=", " ", 
       RowBox[{
        RowBox[{
         RowBox[{"StringSplit", "[", 
          RowBox[{
           RowBox[{"StringTake", "[", 
            RowBox[{"f", ",", " ", "#"}], "]"}], ",", " ", "\"\<_\>\""}], 
          "]"}], "&"}], " ", "/@", " ", "i"}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", " ", "convert", " ", "*)"}], "\[IndentingNewLine]", 
      RowBox[{"f", " ", "=", " ", 
       RowBox[{
        RowBox[{"x_", "/;", " ", 
         RowBox[{
          RowBox[{"StringQ", "[", "x", "]"}], " ", "&&", " ", 
          RowBox[{"StringMatchQ", "[", 
           RowBox[{"x", ",", " ", 
            RowBox[{"DigitCharacter", ".."}]}], "]"}]}]}], " ", ":>", " ", 
        RowBox[{"ToExpression", "[", "x", "]"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"a", ",", " ", "e"}], "}"}], " ", "=", " ", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"a", ",", " ", "e"}], "}"}], " ", "/.", " ", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"\"\<B\>\"", " ", "->", " ", "BSplineCurve"}], ",", " ", 
          RowBox[{"\"\<F\>\"", " ", "->", " ", "Fourier"}], ",", " ", 
          RowBox[{"\"\<Z\>\"", " ", "->", " ", 
           RowBox[{"Unevaluated", "@", 
            RowBox[{"Sequence", "[", "]"}]}]}], ",", " ", "f"}], "}"}]}]}], 
      ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"i", " ", "=", " ", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"i", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}],
           " ", "==", " ", "\"\<I\>\""}], ",", " ", "True", ",", " ", 
         "False"}], "]"}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", " ", "load", " ", "*)"}], "\[IndentingNewLine]", 
      RowBox[{"f", " ", "=", " ", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"\"\<a\>\"", " ", "->", " ", "a"}], ",", " ", 
         RowBox[{"\"\<e\>\"", " ", "->", " ", "e"}], ",", " ", 
         RowBox[{"\"\<i\>\"", " ", "->", " ", "i"}]}], "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"IntegerQ", "[", "d", "]"}], " ", "&&", " ", 
         RowBox[{"d", " ", ">=", " ", "0"}]}], ",", " ", 
        RowBox[{"CompassGait", "[", 
         RowBox[{"f", ",", " ", 
          RowBox[{"\"\<d\>\"", " ", "->", " ", "d"}]}], "]"}]}], "]"}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"(*", " ", "return", " ", "*)"}], "\[IndentingNewLine]", 
      RowBox[{"Association", "@", "f"}]}]}], "\[IndentingNewLine]", "]"}]}], 
  ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.867601247420919*^9, 3.8676012510799503`*^9}, {
   3.86764473783585*^9, 3.867644848893539*^9}, {3.867644901375568*^9, 
   3.867644918895782*^9}, {3.867646185064752*^9, 3.867646251229742*^9}, {
   3.867651466507391*^9, 3.867651467018255*^9}, {3.867651512809482*^9, 
   3.867651512978277*^9}, {3.867652247821245*^9, 3.867652248151519*^9}, 
   3.8676523385836277`*^9, {3.8747262134777775`*^9, 3.8747262194989843`*^9}, {
   3.876056379146764*^9, 3.8760564847458887`*^9}, {3.8760565485003276`*^9, 
   3.8760566371256237`*^9}, {3.876056716903151*^9, 3.8760568341412363`*^9}, 
   3.8760571528473806`*^9, {3.8780500749867015`*^9, 3.878050083280891*^9}, {
   3.8780502750776463`*^9, 3.878050299055586*^9}, {3.8780503308801775`*^9, 
   3.878050373997721*^9}, {3.8802100924118257`*^9, 3.8802101055411177`*^9}, {
   3.8802105919458494`*^9, 3.8802107060306234`*^9}, {3.8802113095084457`*^9, 
   3.8802113140461354`*^9}, {3.880211353309295*^9, 3.8802113577331133`*^9}, {
   3.88021139223997*^9, 3.88021150348978*^9}, {3.880211533908604*^9, 
   3.880211576636427*^9}, {3.880211631108852*^9, 3.880211647552345*^9}, {
   3.880211682809396*^9, 3.88021169444368*^9}, {3.880211851051032*^9, 
   3.880211855453024*^9}, {3.8802118972472305`*^9, 3.88021190711613*^9}, 
   3.880211945869422*^9, {3.8802120846698704`*^9, 3.8802120900001373`*^9}, 
   3.8802121309647307`*^9},
 CellLabel->
  "In[1252]:=",ExpressionUUID->"bbfc96a7-93ae-4d2f-8d4d-e207352d184a"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Post-processing Routines", "Subsection",
 CellChangeTimes->{{3.852300821539905*^9, 3.852300836657745*^9}, {
   3.8802079321837955`*^9, 3.88020793274927*^9}, 
   3.880212011494978*^9},ExpressionUUID->"7e735c6b-c71d-40d5-9fb0-\
dd6a372436ed"],

Cell["\<\
GetGaitParameters puts all results in a list of lists so that if file expands \
into several files, then we can still transpose with Association which is \
always a single tuple (as oppose to a list of tuples like file).\
\>", "Text",
 CellChangeTimes->{{3.877669292837967*^9, 
  3.877669349213458*^9}},ExpressionUUID->"4612356a-2d00-4e99-a741-\
ddedc60f8e74"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"nbls", " ", "=", " ", 
   RowBox[{"\[LeftAssociation]", 
    RowBox[{
     RowBox[{"\"\<x1\>\"", "\[Rule]", "1"}], ",", " ", 
     RowBox[{"\"\<x2\>\"", "\[Rule]", "2"}], ",", " ", 
     RowBox[{"\"\<x3\>\"", "\[Rule]", "3"}], ",", " ", 
     RowBox[{"\"\<x4\>\"", "\[Rule]", "4"}], ",", 
     RowBox[{"\"\<\[Sigma]\>\"", "\[Rule]", "5"}], ",", 
     RowBox[{"\"\<v\>\"", "\[Rule]", "6"}], ",", 
     RowBox[{"\"\<J\>\"", "\[Rule]", "7"}], ",", 
     RowBox[{"\"\<\[Tau]\>\"", "\[Rule]", 
      RowBox[{"-", "1"}]}]}], "\[RightAssociation]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"scale", " ", "=", " ", 
    RowBox[{"<|", 
     RowBox[{"Thread", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"1", ",", " ", "2", ",", " ", "5"}], "}"}], " ", "\[Rule]", 
       " ", 
       RowBox[{"1.0", "/", "Degree"}]}], "]"}], "|>"}]}], ";"}], " ", 
  RowBox[{"(*", " ", 
   RowBox[{
   "missing", " ", "values", " ", "are", " ", "assumed", " ", "to", " ", "be",
     " ", "1"}], " ", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"lbls", " ", "=", " ", 
    RowBox[{"<|", 
     RowBox[{
      RowBox[{"1", " ", "\[Rule]", " ", "\"\<x1 (left leg angle)\>\""}], ",", 
      " ", 
      RowBox[{"2", " ", "\[Rule]", " ", "\"\<x2 (right leg angle)\>\""}], ",",
       " ", 
      RowBox[{"3", " ", "\[Rule]", " ", "\"\<x3 (left leg velocity)\>\""}], 
      ",", " ", 
      RowBox[{"4", " ", "\[Rule]", " ", "\"\<x4 (right leg velocity)\>\""}], 
      ",", " ", 
      RowBox[{"5", " ", "\[Rule]", " ", "\"\<\[Sigma] (walking slope)\>\""}], 
      ",", " ", 
      RowBox[{"6", " ", "\[Rule]", " ", "\"\<v (avg. walking velocity)\>\""}],
       ",", " ", 
      RowBox[{"7", " ", "\[Rule]", " ", "\"\<J (cost)\>\""}], ",", " ", 
      RowBox[{
       RowBox[{"-", "1"}], " ", "\[Rule]", " ", 
       "\"\<\[Tau] (step duration)\>\""}]}], "|>"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"Options", "[", "GetGaitParameters", "]"}], " ", "=", " ", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"Path", " ", "->", " ", "Automatic"}], ",", " ", 
      RowBox[{"\"\<i\>\"", " ", "->", " ", 
       RowBox[{"{", 
        RowBox[{"\"\<\[Sigma]\>\"", ",", " ", "\"\<v\>\""}], "}"}]}], ",", 
      " ", 
      RowBox[{"\"\<a\>\"", " ", "->", " ", "Automatic"}]}], "}"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"GetGaitParameters", "[", 
    RowBox[{"file_String", ",", " ", 
     RowBox[{"opts", ":", 
      RowBox[{"OptionsPattern", "[", "]"}]}]}], "]"}], " ", ":=", " ", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"p", ",", " ", "f", ",", " ", "a"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"p", " ", "=", " ", 
       RowBox[{"OptionValue", "[", "Path", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"f", " ", "=", " ", 
       RowBox[{"FindCSVFile", "[", 
        RowBox[{"file", ",", " ", "p"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"a", " ", "=", " ", 
       RowBox[{
        RowBox[{
         RowBox[{"StringTake", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"FileNameSplit", "[", "#", "]"}], "\[LeftDoubleBracket]", 
            RowBox[{"-", "1"}], "\[RightDoubleBracket]"}], ",", " ", 
           RowBox[{"1", ";;", 
            RowBox[{"-", "5"}]}]}], "]"}], "&"}], " ", "/@", " ", "f"}]}], 
      ";", "\[IndentingNewLine]", 
      RowBox[{"MapThread", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"First", "@", 
          RowBox[{"GetGaitParameters", "[", 
           RowBox[{
            RowBox[{"ConvertCSV", "[", 
             RowBox[{"#1", ",", " ", "None"}], "]"}], ",", " ", "opts", ",", 
            " ", 
            RowBox[{"\"\<a\>\"", " ", "->", " ", "#2"}]}], "]"}]}], "&"}], 
        ",", " ", 
        RowBox[{"{", 
         RowBox[{"f", ",", " ", "a"}], "}"}]}], "]"}]}]}], 
    "\[IndentingNewLine]", "]"}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"GetGaitParameters", "[", 
     RowBox[{"A_Association", ",", " ", 
      RowBox[{"opts", ":", 
       RowBox[{"OptionsPattern", "[", "]"}]}]}], "]"}], " ", ":=", " ", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"f", ",", " ", "i", ",", " ", "a", ",", " ", "f0"}], "}"}], 
      ",", "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
        RowBox[{"expect", " ", "list", " ", "of", " ", 
         RowBox[{"<|", "|>"}], " ", "of", " ", "gaits"}], " ", "=", " ", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"<|", 
           RowBox[{"g1", ",", " ", "g2", ",", " ", "..."}], "|>"}], ",", " ", 
          RowBox[{"<|", "...", "|>"}]}], "}"}]}], " ", "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"i", " ", "=", " ", 
        RowBox[{"OptionValue", "[", "\"\<i\>\"", "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"i", " ", "===", " ", "All"}], ",", " ", 
         RowBox[{
          RowBox[{"i", " ", "=", " ", 
           RowBox[{"Range", "@", 
            RowBox[{"Length", "@", 
             RowBox[{"A", "\[LeftDoubleBracket]", 
              RowBox[{"1", ",", " ", "\"\<c\>\"", ",", " ", "1"}], 
              "\[RightDoubleBracket]"}]}]}]}], ";"}]}], "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"i", " ", "=", " ", 
        RowBox[{
         RowBox[{
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"NumericQ", "@", "#"}], ",", " ", "#", ",", " ", 
            RowBox[{"nbls", "[", "#", "]"}]}], "]"}], "&"}], " ", "/@", " ", 
         "i"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"f", " ", "=", " ", 
        RowBox[{"KeySort", "@", 
         RowBox[{"A", "\[LeftDoubleBracket]", 
          RowBox[{
          "All", ",", " ", "\"\<c\>\"", ",", " ", "1", ",", " ", "i"}], 
          "\[RightDoubleBracket]"}]}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"f", " ", "=", " ", 
        RowBox[{"Map", "[", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"Lookup", "[", 
             RowBox[{"scale", ",", " ", "i", ",", " ", "1"}], "]"}], " ", 
            "#"}], "&"}], ",", " ", "f"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"a", " ", "=", " ", 
        RowBox[{"0", " ", 
         RowBox[{
          RowBox[{"Keys", "[", "A", "]"}], "\[LeftDoubleBracket]", "1", 
          "\[RightDoubleBracket]"}]}]}], ";", " ", 
       RowBox[{"(*", " ", 
        RowBox[{
         RowBox[{"get", " ", "zero", " ", "key"}], ",", " ", 
         RowBox[{"assume", " ", 
          RowBox[{"const", ".", " ", "dim"}]}]}], " ", "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{"f0", " ", "=", " ", 
        RowBox[{"f", "[", "a", "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"a", " ", "=", " ", 
        RowBox[{"OptionValue", "[", "\"\<a\>\"", "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"a", " ", "===", " ", "Automatic"}], ",", " ", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"a", " ", "=", " ", 
           RowBox[{
            RowBox[{
             RowBox[{"ToString", "@", 
              RowBox[{"DecimalForm", "[", 
               RowBox[{"#", ",", " ", 
                RowBox[{"{", 
                 RowBox[{"\[Infinity]", ",", "2"}], "}"}]}], "]"}]}], "&"}], 
            " ", "/@", " ", "f0"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"a", " ", "=", " ", 
           RowBox[{"StringRiffle", "[", 
            RowBox[{"a", ",", " ", 
             RowBox[{"{", 
              RowBox[{
              "\"\<(\>\"", ",", " ", "\"\<,\>\"", ",", " ", "\"\<)\>\""}], 
              "}"}]}], "]"}]}], ";"}]}], "\[IndentingNewLine]", "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"Values", "@", "f"}], ",", " ", "f0", ",", " ", "a"}], 
         "}"}], "}"}]}]}], "\[IndentingNewLine]", "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"GetGaitParameters", "[", 
    RowBox[{
     RowBox[{"C_", "?", "VectorQ"}], ",", " ", 
     RowBox[{"opts", ":", 
      RowBox[{"OptionsPattern", "[", "]"}]}]}], "]"}], " ", ":=", " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      RowBox[{"GetGaitParameters", "[", 
       RowBox[{"#", ",", " ", "opts"}], "]"}], "&"}], " ", "/@", " ", "C"}], 
    ")"}]}], ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.852298583333617*^9, 3.852298610243247*^9}, {
   3.852298653012843*^9, 3.85229878646185*^9}, {3.852298832112137*^9, 
   3.8522988977003717`*^9}, {3.852298933864162*^9, 3.852299016479601*^9}, {
   3.852299058162047*^9, 3.852299060390464*^9}, {3.852299149990561*^9, 
   3.852299199626333*^9}, {3.852299252856226*^9, 3.852299317301502*^9}, {
   3.85229943083884*^9, 3.852299507427808*^9}, {3.85229956584317*^9, 
   3.852299569707017*^9}, {3.852299626522052*^9, 3.8522996632622423`*^9}, {
   3.852299749469885*^9, 3.852299770268764*^9}, {3.852299857214037*^9, 
   3.852299910415036*^9}, {3.852300053991177*^9, 3.852300208049074*^9}, 
   3.852300253181221*^9, {3.852300291677692*^9, 3.852300295996105*^9}, {
   3.852300350456399*^9, 3.852300372255616*^9}, {3.852300407660795*^9, 
   3.852300409820463*^9}, {3.852300464301675*^9, 3.852300538953744*^9}, 
   3.852300689539043*^9, {3.852300862975657*^9, 3.8523008835375233`*^9}, 
   3.852300918330297*^9, {3.852300978256299*^9, 3.852301079545656*^9}, {
   3.852301124991376*^9, 3.852301139664266*^9}, {3.852309119378031*^9, 
   3.852309122435807*^9}, {3.852309190328498*^9, 3.852309217560854*^9}, {
   3.85230924895829*^9, 3.85230926960623*^9}, {3.852309366567052*^9, 
   3.8523093869026613`*^9}, {3.85230942565423*^9, 3.852309429872156*^9}, {
   3.852309500565888*^9, 3.852309515846108*^9}, {3.8523095684458838`*^9, 
   3.852309607420705*^9}, {3.8523096635765457`*^9, 3.852309684365569*^9}, 
   3.852309801115803*^9, {3.852309856706702*^9, 3.852309866119317*^9}, {
   3.852311544668331*^9, 3.8523115515408154`*^9}, 3.852311694532016*^9, {
   3.8523117378246527`*^9, 3.852311800720509*^9}, {3.852311835391608*^9, 
   3.852311855911865*^9}, {3.852311901927535*^9, 3.852312034518058*^9}, {
   3.85231229138896*^9, 3.852312292956814*^9}, {3.852312388029723*^9, 
   3.852312422739868*^9}, {3.8523125015720043`*^9, 3.852312539499289*^9}, {
   3.852312613098345*^9, 3.852312617930637*^9}, {3.852312739227932*^9, 
   3.8523127599557056`*^9}, {3.852312796768839*^9, 3.8523128029767923`*^9}, {
   3.852313198365418*^9, 3.8523131996774673`*^9}, {3.852313339612234*^9, 
   3.852313348811687*^9}, {3.852313441531857*^9, 3.8523134536112127`*^9}, {
   3.8525822880331907`*^9, 3.8525823069574957`*^9}, {3.8525826461850157`*^9, 
   3.852582662015622*^9}, {3.852582695506452*^9, 3.852582744194252*^9}, {
   3.852605452135886*^9, 3.852605453959095*^9}, {3.8526118465428658`*^9, 
   3.852611849471459*^9}, {3.8526118964199877`*^9, 3.852611906833556*^9}, {
   3.8526121670165987`*^9, 3.852612172229535*^9}, 3.8526122685098143`*^9, {
   3.852612365761897*^9, 3.852612367034589*^9}, {3.852612455558868*^9, 
   3.8526124590298967`*^9}, {3.852613311525854*^9, 3.852613337567504*^9}, {
   3.852613376022217*^9, 3.852613405086052*^9}, {3.8526135982589684`*^9, 
   3.8526135987336884`*^9}, {3.852640384559593*^9, 3.852640390658396*^9}, {
   3.854938773908695*^9, 3.854938786360846*^9}, {3.8549388727201014`*^9, 
   3.854938879368577*^9}, 3.85493931521577*^9, {3.854939505579273*^9, 
   3.854939522315629*^9}, {3.854939593298707*^9, 3.8549396021127987`*^9}, {
   3.85516540859823*^9, 3.8551654332275753`*^9}, {3.855165480634115*^9, 
   3.8551654908533792`*^9}, {3.8551655255085697`*^9, 
   3.8551655255563927`*^9}, {3.855165606700148*^9, 3.855165712155981*^9}, {
   3.855165752769903*^9, 3.855165761767372*^9}, {3.855552605502788*^9, 
   3.855552609702321*^9}, {3.85555327294097*^9, 3.855553364566036*^9}, {
   3.8555534186271973`*^9, 3.855553426616503*^9}, {3.8555534579238873`*^9, 
   3.85555347649876*^9}, {3.8555740833233137`*^9, 3.85557409939077*^9}, {
   3.856097200276725*^9, 3.856097213164019*^9}, {3.856097270064888*^9, 
   3.856097310921644*^9}, {3.856099464483745*^9, 3.856099468877327*^9}, 
   3.8560995154659233`*^9, {3.856099561473411*^9, 3.856099570173924*^9}, {
   3.877495810406087*^9, 3.8774958120945163`*^9}, {3.8774959128048263`*^9, 
   3.8774959419069815`*^9}, 3.877496234368925*^9, {3.87751136841783*^9, 
   3.877511402367917*^9}, {3.877511442861677*^9, 3.8775114608085847`*^9}, {
   3.877511544049556*^9, 3.877511558097612*^9}, {3.8775117841105213`*^9, 
   3.8775118166786594`*^9}, {3.877511893226093*^9, 3.877511904622114*^9}, {
   3.877511982262479*^9, 3.8775119836325607`*^9}, {3.8775120256609507`*^9, 
   3.8775120759676466`*^9}, {3.8775121087871304`*^9, 3.87751211031831*^9}, {
   3.8775257396320724`*^9, 3.877525760032672*^9}, {3.8775257956353874`*^9, 
   3.877525892263658*^9}, {3.8775259262897673`*^9, 3.877525952801339*^9}, {
   3.8775260961362815`*^9, 3.87752609770791*^9}, {3.8775261752206416`*^9, 
   3.8775262083455906`*^9}, {3.8775263015455112`*^9, 
   3.8775263144198203`*^9}, {3.8775263521103888`*^9, 
   3.8775264558434362`*^9}, {3.877526487198698*^9, 3.877526505639492*^9}, {
   3.8775265600272017`*^9, 3.877526583996728*^9}, 3.877526654184307*^9, 
   3.8776247193827767`*^9, {3.877664220657501*^9, 3.877664393849448*^9}, {
   3.8776644286916428`*^9, 3.8776644328023105`*^9}, {3.877664482092246*^9, 
   3.8776644872704964`*^9}, {3.87766454412012*^9, 3.8776645593406415`*^9}, {
   3.877665052303112*^9, 3.877665052726675*^9}, {3.877665197581331*^9, 
   3.8776652020837965`*^9}, 3.8776652322106395`*^9, {3.877665272906599*^9, 
   3.8776652971597595`*^9}, {3.8776653473562975`*^9, 
   3.8776653951484537`*^9}, {3.877665463702331*^9, 3.8776656242466707`*^9}, {
   3.8776664614365516`*^9, 3.8776664932270823`*^9}, {3.87766655408671*^9, 
   3.877666567329855*^9}, {3.877666651957943*^9, 3.877666705131148*^9}, {
   3.8776670816500783`*^9, 3.8776670892766757`*^9}, {3.877667226348137*^9, 
   3.877667229831644*^9}, {3.8776672761970873`*^9, 3.877667290063265*^9}, {
   3.877667320345664*^9, 3.877667345378521*^9}, {3.8776673756673813`*^9, 
   3.8776673766706676`*^9}, {3.8776674327162013`*^9, 3.877667447878217*^9}, {
   3.87766747829178*^9, 3.8776675176457653`*^9}, {3.8776676136259913`*^9, 
   3.8776676417142167`*^9}, {3.8776677398767223`*^9, 
   3.8776677405511665`*^9}, {3.8776677765186653`*^9, 3.877667881623307*^9}, {
   3.8776679411124687`*^9, 3.877668003755312*^9}, {3.877668249852758*^9, 
   3.877668269701731*^9}, {3.877668319236982*^9, 3.8776683294098797`*^9}, {
   3.8776684394167957`*^9, 3.877668474480715*^9}, {3.877668505711732*^9, 
   3.877668506041554*^9}, {3.8776686550588765`*^9, 3.8776686602367325`*^9}, {
   3.87766879184499*^9, 3.877668801574337*^9}, 3.8776690696142664`*^9, {
   3.8776691336466527`*^9, 3.877669166287119*^9}, {3.8777612032452507`*^9, 
   3.8777612287824917`*^9}, {3.877940670950929*^9, 3.87794073215454*^9}, {
   3.877940868183241*^9, 3.87794087495303*^9}, {3.8779579871710453`*^9, 
   3.877958027764449*^9}, {3.877958211478696*^9, 3.877958308419908*^9}, {
   3.8779583396950974`*^9, 3.8779584289970217`*^9}, {3.878024177612484*^9, 
   3.878024192797103*^9}, {3.8780246755525885`*^9, 3.8780247077238626`*^9}, {
   3.878051188434451*^9, 3.878051227698518*^9}, {3.87805138247309*^9, 
   3.8780514088268194`*^9}, 3.878051894937787*^9, {3.8781522301873302`*^9, 
   3.8781522471208897`*^9}, {3.8781522788306613`*^9, 3.878152336131168*^9}, {
   3.878152412948713*^9, 3.87815244732123*^9}, {3.87815274459944*^9, 
   3.87815275202083*^9}, 3.8781550238937545`*^9, {3.880353326758762*^9, 
   3.880353337032874*^9}, {3.8803533783842955`*^9, 3.880353404047331*^9}, {
   3.880353440576271*^9, 3.880353441139865*^9}, {3.880353478005508*^9, 
   3.8803534787136445`*^9}, {3.8803535170115757`*^9, 3.880353517370962*^9}, {
   3.8803535726690345`*^9, 3.8803535752084427`*^9}, {3.8803536586040835`*^9, 
   3.880353699304181*^9}, {3.8803537473249784`*^9, 3.8803537751972313`*^9}, {
   3.880353844717298*^9, 3.880353845201935*^9}, {3.8804292327332764`*^9, 
   3.88042924053099*^9}, {3.8804292817886734`*^9, 3.880429297089147*^9}, {
   3.8804293349234123`*^9, 3.880429339645669*^9}, {3.880429380554146*^9, 
   3.8804294049459553`*^9}, {3.880429587626384*^9, 3.880429587973686*^9}, {
   3.881085757741298*^9, 3.881085796167767*^9}, {3.8810858321176176`*^9, 
   3.8810858639599295`*^9}, {3.8847698732980695`*^9, 3.884769952521117*^9}},
 CellLabel->
  "In[1254]:=",ExpressionUUID->"9c7c677a-9c04-46dc-bfe7-c9478582e369"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"size", " ", "=", " ", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"1920", ",", " ", "1080"}], "}"}], "/", "2"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ls", " ", "=", " ", "18"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"ts", " ", "=", " ", "12"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"size", " ", "=", " ", "Automatic"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ls", " ", "=", " ", 
   RowBox[{"Sequence", "[", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"ts", " ", "=", " ", "Automatic"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"PlotGaitParameters", "[", "Print", "]"}], " ", ":=", " ", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{"size", " ", "=", " ", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"1920", ",", " ", "1080"}], "}"}], "/", "2"}]}], ";", " ", 
    RowBox[{"ls", " ", "=", " ", "18"}], ";", " ", 
    RowBox[{"ts", " ", "=", " ", "12"}], ";"}], 
   ")"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"PlotGaitParameters", "[", "Automatic", "]"}], " ", ":=", " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"size", " ", "=", " ", "Automatic"}], ";", " ", 
     RowBox[{"ls", " ", "=", " ", 
      RowBox[{"Sequence", "[", "]"}]}], ";", " ", 
     RowBox[{"ts", " ", "=", " ", "Automatic"}], ";"}], ")"}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"PlotGaitParameters", "[", 
    RowBox[{"C_", ",", " ", 
     RowBox[{"opts", ":", 
      RowBox[{"OptionsPattern", "[", 
       RowBox[{"{", 
        RowBox[{
        "GetGaitParameters", ",", " ", "ListPlot", ",", " ", 
         "ListLinePlot3D"}], "}"}], "]"}]}]}], "]"}], " ", ":=", " ", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "Z", ",", " ", "Z0", ",", " ", "A", ",", " ", "i", ",", " ", "p", ",", 
       " ", "o"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"i", " ", "=", " ", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"!", 
          RowBox[{"VectorQ", "[", "C", "]"}]}], ",", " ", 
         RowBox[{"{", "C", "}"}], ",", " ", "C"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"Z", ",", " ", "Z0", ",", " ", "A"}], "}"}], " ", "=", " ", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"Join", "@@", 
          RowBox[{"GetGaitParameters", "[", 
           RowBox[{"i", ",", " ", 
            RowBox[{"FilterRules", "[", 
             RowBox[{
              RowBox[{"{", "opts", "}"}], ",", " ", 
              RowBox[{"Options", "[", "GetGaitParameters", "]"}]}], "]"}]}], 
           "]"}]}], ")"}], "\[Transpose]"}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"i", " ", "=", " ", 
       RowBox[{"lbls", " ", "/@", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"NumericQ", "@", "#"}], ",", " ", "#", ",", " ", 
             RowBox[{"nbls", "[", "#", "]"}]}], "]"}], "&"}], " ", "/@", " ", 
          RowBox[{"OptionValue", "[", "\"\<i\>\"", "]"}]}], ")"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"i", " ", "=", " ", 
       RowBox[{
        RowBox[{
         RowBox[{"Style", "[", 
          RowBox[{"#", ",", " ", "ls"}], "]"}], "&"}], " ", "/@", " ", 
        "i"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"p", " ", "=", " ", 
       RowBox[{"MapThread", "[", 
        RowBox[{"Tooltip", ",", " ", 
         RowBox[{"{", 
          RowBox[{"Z", ",", " ", "A"}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"o", " ", "=", " ", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"PlotRange", "\[Rule]", "All"}], ",", " ", 
         RowBox[{"PlotLegends", "\[Rule]", " ", "A"}], ",", " ", 
         RowBox[{"Joined", "\[Rule]", "True"}], ",", " ", 
         RowBox[{"Mesh", "\[Rule]", "All"}], ",", " ", 
         RowBox[{"MeshStyle", "\[Rule]", 
          RowBox[{"Directive", "[", 
           RowBox[{"Black", ",", " ", 
            RowBox[{"PointSize", "@", "Small"}]}], "]"}]}], ",", " ", 
         RowBox[{"ImageSize", " ", "->", " ", "size"}]}], "}"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Last", "@", 
          RowBox[{"Dimensions", "@", 
           RowBox[{
           "Z0", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}]}], 
         " ", "==", " ", "3"}], ",", " ", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"o", " ", "=", " ", 
          RowBox[{"Join", "[", 
           RowBox[{
            RowBox[{"FilterRules", "[", 
             RowBox[{
              RowBox[{"{", "opts", "}"}], ",", " ", 
              RowBox[{"Options", "[", "ListLinePlot3D", "]"}]}], "]"}], ",", 
            " ", "o", ",", " ", 
            RowBox[{"{", 
             RowBox[{"TicksStyle", "\[Rule]", "ts"}], "}"}]}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"ListLinePlot3D", "[", 
          RowBox[{"p", ",", " ", "o", ",", " ", 
           RowBox[{"AxesLabel", "\[Rule]", "i"}]}], "]"}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"(*", " ", "else", " ", "*)"}], "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"o", " ", "=", " ", 
          RowBox[{"Join", "[", 
           RowBox[{
            RowBox[{"FilterRules", "[", 
             RowBox[{
              RowBox[{"{", "opts", "}"}], ",", " ", 
              RowBox[{"Options", "[", "ListPlot", "]"}]}], "]"}], ",", " ", 
            "o", ",", " ", 
            RowBox[{"{", 
             RowBox[{"FrameTicksStyle", "\[Rule]", "ts"}], "}"}]}], "]"}]}], 
         ";", "\[IndentingNewLine]", 
         RowBox[{"ListPlot", "[", 
          RowBox[{"p", ",", " ", "o", ",", " ", 
           RowBox[{"Prolog", "\[Rule]", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"PointSize", "@", "Large"}], ",", " ", "Black", ",", 
              " ", 
              RowBox[{"Point", "@", "Z0"}]}], "}"}]}], ",", " ", 
           RowBox[{"Frame", " ", "->", " ", "True"}], ",", " ", 
           RowBox[{"FrameLabel", "\[Rule]", " ", "i"}]}], 
          "\[IndentingNewLine]", "]"}]}]}], "\[IndentingNewLine]", "]"}]}]}], 
    "\[IndentingNewLine]", "]"}]}], ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.852298583333617*^9, 3.852298610243247*^9}, {
   3.852298653012843*^9, 3.85229878646185*^9}, {3.852298832112137*^9, 
   3.8522988977003717`*^9}, {3.852298933864162*^9, 3.852299016479601*^9}, {
   3.852299058162047*^9, 3.852299060390464*^9}, {3.852299149990561*^9, 
   3.852299199626333*^9}, {3.852299252856226*^9, 3.852299317301502*^9}, {
   3.85229943083884*^9, 3.852299507427808*^9}, {3.85229956584317*^9, 
   3.852299569707017*^9}, {3.852299626522052*^9, 3.8522996632622423`*^9}, {
   3.852299749469885*^9, 3.852299770268764*^9}, {3.852299857214037*^9, 
   3.852299910415036*^9}, {3.852300053991177*^9, 3.852300208049074*^9}, 
   3.852300253181221*^9, {3.852300291677692*^9, 3.852300295996105*^9}, {
   3.852300350456399*^9, 3.852300372255616*^9}, {3.852300407660795*^9, 
   3.852300409820463*^9}, {3.852300464301675*^9, 3.852300538953744*^9}, 
   3.852300689539043*^9, {3.852300862975657*^9, 3.8523008835375233`*^9}, 
   3.852300918330297*^9, {3.852300978256299*^9, 3.852301079545656*^9}, {
   3.852301124991376*^9, 3.852301139664266*^9}, {3.852309119378031*^9, 
   3.852309122435807*^9}, {3.852309190328498*^9, 3.852309217560854*^9}, {
   3.85230924895829*^9, 3.85230926960623*^9}, {3.852309366567052*^9, 
   3.8523093869026613`*^9}, {3.85230942565423*^9, 3.852309429872156*^9}, {
   3.852309500565888*^9, 3.852309515846108*^9}, {3.8523095684458838`*^9, 
   3.852309607420705*^9}, {3.8523096635765457`*^9, 3.852309684365569*^9}, 
   3.852309801115803*^9, {3.852309856706702*^9, 3.852309866119317*^9}, {
   3.852311544668331*^9, 3.8523115515408154`*^9}, 3.852311694532016*^9, {
   3.8523117378246527`*^9, 3.852311800720509*^9}, {3.852311835391608*^9, 
   3.852311855911865*^9}, {3.852311901927535*^9, 3.852312034518058*^9}, {
   3.85231229138896*^9, 3.852312292956814*^9}, {3.852312388029723*^9, 
   3.852312422739868*^9}, {3.8523125015720043`*^9, 3.852312539499289*^9}, {
   3.852312613098345*^9, 3.852312617930637*^9}, {3.852312739227932*^9, 
   3.8523127599557056`*^9}, {3.852312796768839*^9, 3.8523128029767923`*^9}, {
   3.852313198365418*^9, 3.8523131996774673`*^9}, {3.852313339612234*^9, 
   3.852313348811687*^9}, {3.852313441531857*^9, 3.8523134536112127`*^9}, {
   3.8525822880331907`*^9, 3.8525823069574957`*^9}, {3.8525826461850157`*^9, 
   3.852582662015622*^9}, {3.852582695506452*^9, 3.852582744194252*^9}, {
   3.852605452135886*^9, 3.852605453959095*^9}, {3.8526118465428658`*^9, 
   3.852611849471459*^9}, {3.8526118964199877`*^9, 3.852611906833556*^9}, {
   3.8526121670165987`*^9, 3.852612172229535*^9}, 3.8526122685098143`*^9, {
   3.852612365761897*^9, 3.852612367034589*^9}, {3.852612455558868*^9, 
   3.8526124590298967`*^9}, {3.852613311525854*^9, 3.852613337567504*^9}, {
   3.852613376022217*^9, 3.852613405086052*^9}, {3.8526135982589684`*^9, 
   3.8526135987336884`*^9}, {3.852640384559593*^9, 3.852640390658396*^9}, {
   3.854938773908695*^9, 3.854938786360846*^9}, {3.8549388727201014`*^9, 
   3.854938879368577*^9}, 3.85493931521577*^9, {3.854939505579273*^9, 
   3.854939522315629*^9}, {3.854939593298707*^9, 3.8549396021127987`*^9}, {
   3.85516540859823*^9, 3.8551654332275753`*^9}, {3.855165480634115*^9, 
   3.8551654908533792`*^9}, {3.8551655255085697`*^9, 
   3.8551655255563927`*^9}, {3.855165606700148*^9, 3.855165712155981*^9}, {
   3.855165752769903*^9, 3.855165761767372*^9}, {3.855552605502788*^9, 
   3.855552609702321*^9}, {3.85555327294097*^9, 3.855553364566036*^9}, {
   3.8555534186271973`*^9, 3.855553426616503*^9}, {3.8555534579238873`*^9, 
   3.85555347649876*^9}, {3.8555740833233137`*^9, 3.85557409939077*^9}, {
   3.856097200276725*^9, 3.856097213164019*^9}, {3.856097270064888*^9, 
   3.856097310921644*^9}, {3.856099464483745*^9, 3.856099468877327*^9}, 
   3.8560995154659233`*^9, {3.856099561473411*^9, 3.856099570173924*^9}, {
   3.877495810406087*^9, 3.8774958120945163`*^9}, {3.8774959128048263`*^9, 
   3.8774959419069815`*^9}, 3.877496234368925*^9, {3.87751136841783*^9, 
   3.877511402367917*^9}, {3.877511442861677*^9, 3.8775114608085847`*^9}, {
   3.877511544049556*^9, 3.877511558097612*^9}, {3.8775117841105213`*^9, 
   3.8775118166786594`*^9}, {3.877511893226093*^9, 3.877511904622114*^9}, {
   3.877511982262479*^9, 3.8775119836325607`*^9}, {3.8775120256609507`*^9, 
   3.8775120759676466`*^9}, {3.8775121087871304`*^9, 3.87751211031831*^9}, {
   3.8775257396320724`*^9, 3.877525760032672*^9}, {3.8775257956353874`*^9, 
   3.877525892263658*^9}, {3.8775259262897673`*^9, 3.877525952801339*^9}, {
   3.8775260961362815`*^9, 3.87752609770791*^9}, {3.8775261752206416`*^9, 
   3.8775262083455906`*^9}, {3.8775263015455112`*^9, 
   3.8775263144198203`*^9}, {3.8775263521103888`*^9, 
   3.8775264558434362`*^9}, {3.877526487198698*^9, 3.877526505639492*^9}, {
   3.8775265600272017`*^9, 3.877526583996728*^9}, 3.877526654184307*^9, 
   3.8776247193827767`*^9, {3.877664220657501*^9, 3.877664393849448*^9}, {
   3.8776644286916428`*^9, 3.8776644328023105`*^9}, {3.877664482092246*^9, 
   3.8776644872704964`*^9}, {3.87766454412012*^9, 3.8776645593406415`*^9}, {
   3.877665052303112*^9, 3.877665052726675*^9}, {3.877665197581331*^9, 
   3.8776652020837965`*^9}, 3.8776652322106395`*^9, {3.877665272906599*^9, 
   3.8776652971597595`*^9}, {3.8776653473562975`*^9, 
   3.8776653951484537`*^9}, {3.877665463702331*^9, 3.8776656242466707`*^9}, {
   3.8776664614365516`*^9, 3.8776664932270823`*^9}, {3.87766655408671*^9, 
   3.877666567329855*^9}, {3.877666651957943*^9, 3.877666705131148*^9}, {
   3.8776670816500783`*^9, 3.8776670892766757`*^9}, {3.877667226348137*^9, 
   3.877667229831644*^9}, {3.8776672761970873`*^9, 3.877667290063265*^9}, {
   3.877667320345664*^9, 3.877667345378521*^9}, {3.8776673756673813`*^9, 
   3.8776673766706676`*^9}, {3.8776674327162013`*^9, 3.877667447878217*^9}, {
   3.87766747829178*^9, 3.8776675176457653`*^9}, {3.8776676136259913`*^9, 
   3.8776676417142167`*^9}, {3.8776677398767223`*^9, 
   3.8776677405511665`*^9}, {3.8776677765186653`*^9, 3.877667881623307*^9}, {
   3.8776679411124687`*^9, 3.877668003755312*^9}, {3.877668249852758*^9, 
   3.877668269701731*^9}, {3.877668319236982*^9, 3.8776683294098797`*^9}, {
   3.8776684394167957`*^9, 3.877668474480715*^9}, {3.877668505711732*^9, 
   3.877668506041554*^9}, {3.8776686550588765`*^9, 3.8776686602367325`*^9}, {
   3.87766879184499*^9, 3.877668801574337*^9}, 3.8776690696142664`*^9, {
   3.8776691336466527`*^9, 3.877669166287119*^9}, {3.8777612032452507`*^9, 
   3.8777612287824917`*^9}, {3.877940670950929*^9, 3.87794073215454*^9}, {
   3.877940868183241*^9, 3.87794087495303*^9}, {3.8779579871710453`*^9, 
   3.877958027764449*^9}, {3.877958211478696*^9, 3.877958308419908*^9}, {
   3.8779583396950974`*^9, 3.8779584289970217`*^9}, {3.878024177612484*^9, 
   3.878024192797103*^9}, {3.8780246755525885`*^9, 3.8780247077238626`*^9}, {
   3.878051188434451*^9, 3.878051227698518*^9}, {3.87805138247309*^9, 
   3.8780514088268194`*^9}, 3.878051894937787*^9, {3.8781522301873302`*^9, 
   3.8781522471208897`*^9}, {3.8781522788306613`*^9, 3.878152336131168*^9}, {
   3.878152412948713*^9, 3.87815244732123*^9}, {3.87815274459944*^9, 
   3.8781527666761923`*^9}, {3.8781528992413406`*^9, 
   3.8781529214375696`*^9}, {3.8781529581414127`*^9, 
   3.8781529825210853`*^9}, {3.878153065362715*^9, 3.878153078173356*^9}, {
   3.878153148697543*^9, 3.878153241101441*^9}, {3.8781532852861624`*^9, 
   3.8781532972534027`*^9}, 3.8781533762971635`*^9, {3.878155970304782*^9, 
   3.8781559727542334`*^9}, {3.881081288299633*^9, 3.8810813421033554`*^9}, 
   3.881081396885181*^9, {3.881081475504318*^9, 3.8810815323378077`*^9}, {
   3.881081649928563*^9, 3.8810816516470623`*^9}, {3.881081709918062*^9, 
   3.8810817106735306`*^9}},
 CellLabel->
  "In[1261]:=",ExpressionUUID->"2ea79c48-8fbd-4c25-981c-ef1e72d19956"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"tickmag", " ", "=", " ", 
    RowBox[{"0.85", " ", "2.5"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"SigFig", " ", "[", "data_", "]"}], " ", ":=", " ", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", "r", "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"r", " ", "=", " ", 
        RowBox[{"Subtract", "@@", 
         RowBox[{"Reverse", "@", 
          RowBox[{"TakeSmallest", "[", 
           RowBox[{
            RowBox[{"Select", "[", 
             RowBox[{
              RowBox[{"Flatten", "@", "data"}], ",", " ", "NumericQ"}], "]"}],
             ",", " ", "2"}], "]"}]}]}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"r", " ", "=", " ", 
        RowBox[{"Last", "@", 
         RowBox[{"RealDigits", "@", "r"}]}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"r", " ", ">", " ", "0"}], ",", " ", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"r", " ", "+", " ", "1"}], ",", " ", "0"}], "}"}], ",", 
         " ", 
         RowBox[{
          RowBox[{"Abs", "[", "r", "]"}], " ", "+", " ", 
          RowBox[{"{", 
           RowBox[{"2", ",", " ", "1"}], "}"}]}]}], "]"}]}]}], 
     "\[IndentingNewLine]", "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"Options", "[", "TeXLabel", "]"}], " ", "=", " ", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"\"\<s\>\"", " ", "->", " ", "Automatic"}], ",", " ", 
      RowBox[{"\"\<n\>\"", " ", "->", " ", "Automatic"}], ",", " ", 
      RowBox[{"\"\<m\>\"", " ", "->", " ", "Automatic"}], ",", " ", 
      RowBox[{"\"\<pre\>\"", " ", "->", " ", 
       RowBox[{"{", "}"}]}]}], "}"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"TeXLabel", "[", 
     RowBox[{"data_", ",", " ", 
      RowBox[{"OptionsPattern", "[", "]"}]}], "]"}], " ", ":=", "  ", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "d", ",", " ", "n", ",", " ", "f", ",", " ", "s", ",", " ", "u", ",", 
        " ", "i"}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
        RowBox[{"for", " ", "list", " ", "\"\<s\>\"", " ", 
         RowBox[{"{", 
          RowBox[{"...", ",", " ", "si", ",", " ", "..."}], "}"}], " ", "is", 
         " ", "applied", " ", "at", " ", "data"}], " ", "=", " ", 
        RowBox[{"{", 
         RowBox[{"...", ",", " ", "di", ",", " ", "..."}], "}"}]}], " ", 
       "*)"}], "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
       "di", " ", "can", " ", "be", " ", "any", " ", "order", " ", "tensor", 
        " ", "irrespective", " ", "of", " ", "the", " ", "other", " ", 
        RowBox[{"dj", "'"}], "s"}], " ", "*)"}], "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"s", " ", "=", " ", 
        RowBox[{"OptionValue", "[", "\"\<s\>\"", "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"s", " ", "=", " ", 
        RowBox[{"s", " ", "/.", " ", 
         RowBox[{"Automatic", " ", "->", " ", 
          RowBox[{"StringTemplate", "[", "\"\<\\\\num{``}\>\"", "]"}]}]}]}], 
       ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{"apply", " ", "string", " ", "format", 
         RowBox[{"(", "s", ")"}]}], " ", "*)"}], "\[IndentingNewLine]", 
       RowBox[{"n", " ", "=", " ", 
        RowBox[{"OptionValue", "@", "\"\<n\>\""}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{
        "NumberForm", " ", "returns", " ", "expression", " ", "if", " ", "it",
          " ", "is", " ", "not", " ", "a", " ", "number"}], " ", "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{"u", " ", "=", " ", 
        RowBox[{
         RowBox[{"Which", "[", 
          RowBox[{
           RowBox[{"!", 
            RowBox[{"NumericQ", "[", "#2", "]"}]}], ",", " ", "#2", ",", " ", 
           RowBox[{"#2", " ", "\[Equal]", " ", "0"}], ",", " ", 
           RowBox[{"#1", "@", "0"}], ",", " ", "True", ",", " ", 
           RowBox[{"#1", "@", 
            RowBox[{"NumberForm", "[", 
             RowBox[{"#2", ",", " ", "#3"}], "]"}]}]}], "]"}], "&"}]}], " ", 
       ";", "\[IndentingNewLine]", 
       RowBox[{"f", " ", "=", " ", 
        RowBox[{"Function", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"s", ",", " ", "n", ",", " ", "d"}], "}"}], ",", " ", 
          "\[IndentingNewLine]", 
          RowBox[{"With", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"m", " ", "=", " ", 
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{"n", " ", "===", " ", "Automatic"}], ",", " ", 
                RowBox[{"SigFig", "[", "d", "]"}], ",", " ", "n"}], "]"}]}], 
             "}"}], ",", " ", "\[IndentingNewLine]", 
            RowBox[{"Map", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"u", "[", 
                RowBox[{"s", ",", " ", "#", ",", " ", "m"}], "]"}], "&"}], 
              ",", " ", 
              RowBox[{"N", "@", "d"}], ",", " ", 
              RowBox[{"{", 
               RowBox[{"-", "1"}], "}"}]}], "]"}]}], "\[IndentingNewLine]", 
           "]"}]}], "\[IndentingNewLine]", "]"}]}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"d", " ", "=", " ", 
        RowBox[{"Flatten", "@", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"ListQ", "[", "s", "]"}], ",", " ", 
           RowBox[{"MapThread", "[", 
            RowBox[{"f", ",", " ", 
             RowBox[{"{", 
              RowBox[{"s", ",", " ", "n", ",", " ", "data"}], "}"}]}], "]"}], 
           ",", " ", 
           RowBox[{"f", "[", 
            RowBox[{"s", ",", " ", "n", ",", " ", "data"}], "]"}]}], 
          "]"}]}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"(*", " ", "texify", " ", "*)"}], "\[IndentingNewLine]", 
       RowBox[{"n", " ", "=", " ", 
        RowBox[{"OptionValue", "@", "\"\<m\>\""}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"d", " ", "=", " ", 
        RowBox[{"BLTeX", "[", 
         RowBox[{"d", ",", " ", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"n", " ", "===", " ", "Automatic"}], ",", " ", "tickmag", 
            ",", " ", "n"}], "]"}], ",", " ", 
          RowBox[{"OptionValue", "@", "\"\<pre\>\""}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{"restore", " ", "structure"}], " ", "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{"n", " ", "=", " ", 
        RowBox[{"Dimensions", " ", "/@", " ", "data"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"d", " ", "=", " ", 
        RowBox[{"TakeList", "[", 
         RowBox[{"d", ",", " ", 
          RowBox[{"Map", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"Times", "@@", "#"}], "&"}], ",", " ", "n"}], "]"}]}], 
         "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"MapThread", "[", 
        RowBox[{"ArrayReshape", ",", " ", 
         RowBox[{"{", 
          RowBox[{"d", ",", " ", "n"}], "}"}]}], "]"}]}]}], 
     "\[IndentingNewLine]", "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"ExpandTicks", "[", 
     RowBox[{"g_", ",", " ", 
      RowBox[{"d_", ":", "4"}]}], "]"}], " ", ":=", " ", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"t", ",", " ", "f", ",", " ", "h"}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"t", " ", "=", " ", 
        RowBox[{
         RowBox[{"Transpose", "@", 
          RowBox[{"{", 
           RowBox[{"#", ",", " ", "#"}], "}"}]}], "&"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"h", " ", "=", " ", 
        RowBox[{
         RowBox[{"FindDivisions", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"Floor", "@", 
              RowBox[{
              "#", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], 
             ",", " ", 
             RowBox[{"Ceiling", "@", 
              RowBox[{
              "#", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}]}]}],
             "}"}], ",", " ", "d"}], "]"}], "&"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"f", " ", "=", " ", 
        RowBox[{
         RowBox[{"Which", "[", 
          RowBox[{
           RowBox[{"#1", " ", "===", " ", "Automatic"}], ",", "  ", 
           RowBox[{"t", "@", 
            RowBox[{"h", "[", "#2", "]"}]}], ",", " ", 
           RowBox[{"VectorQ", "[", "#1", "]"}], ",", " ", 
           RowBox[{"t", "@", "#1"}], ",", " ", "True", ",", " ", "#1"}], 
          "]"}], "&"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"MapThread", "[", 
        RowBox[{"f", ",", " ", 
         RowBox[{"Values", "@", 
          RowBox[{"AbsoluteOptions", "[", 
           RowBox[{"g", ",", " ", 
            RowBox[{"{", 
             RowBox[{"Ticks", ",", " ", "PlotRange"}], "}"}]}], "]"}]}]}], 
        "]"}]}]}], "\[IndentingNewLine]", "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Options", "[", "LabelTicks", "]"}], " ", "=", " ", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"Min", " ", "->", " ", "True"}], ",", " ", 
     RowBox[{"TeXLabel", " ", "->", " ", 
      RowBox[{"{", "}"}]}], ",", " ", 
     RowBox[{"Div", " ", "->", " ", "4"}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"LabelTicks", "[", " ", 
     RowBox[{"g_", ",", " ", 
      RowBox[{"OptionsPattern", "[", "]"}]}], "]"}], " ", ":=", " ", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"o", ",", " ", "r", ",", " ", "t"}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"t", " ", "=", " ", 
        RowBox[{"ExpandTicks", "[", 
         RowBox[{"g", ",", " ", 
          RowBox[{"OptionValue", "@", "Div"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{"remove", " ", "minor", " ", "ticks"}], " ", "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"!", 
          RowBox[{"OptionValue", "[", "Min", "]"}]}], ",", " ", 
         RowBox[{
          RowBox[{"t", " ", "=", " ", 
           RowBox[{
            RowBox[{
             RowBox[{"Select", "[", 
              RowBox[{"#", ",", " ", 
               RowBox[{
                RowBox[{"NumericQ", "[", 
                 RowBox[{
                 "#", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], 
                 "]"}], "&"}]}], "]"}], "&"}], " ", "/@", " ", "t"}]}], 
          ";"}]}], "]"}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{
         RowBox[{
         "treat", " ", "rows", " ", "of", " ", "t", " ", "as", " ", "their", 
          " ", "own", " ", "dataset"}], ",", " ", 
         RowBox[{
         "which", " ", "might", " ", "require", " ", "padding", " ", "of", 
          " ", "s", " ", "and", " ", "n"}]}], " ", "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{"r", " ", "=", " ", 
        RowBox[{"OptionValue", "@", "TeXLabel"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"o", " ", "=", " ", 
        RowBox[{"OptionValue", "[", 
         RowBox[{"TeXLabel", ",", " ", 
          RowBox[{"{", "r", "}"}], ",", "  ", 
          RowBox[{"{", 
           RowBox[{"\"\<s\>\"", ",", " ", "\"\<n\>\""}], "}"}]}], "]"}]}], 
       ";", "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"!", 
          RowBox[{"ListQ", "[", 
           RowBox[{
           "o", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
           "]"}]}], ",", " ", 
         RowBox[{
          RowBox[{"o", " ", "=", " ", 
           RowBox[{"Transpose", "@", 
            RowBox[{"ConstantArray", "[", 
             RowBox[{"o", ",", " ", 
              RowBox[{"Length", "@", "t"}]}], "]"}]}]}], ";"}]}], "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"t", "\[LeftDoubleBracket]", 
         RowBox[{"All", ",", " ", "All", ",", " ", "2"}], 
         "\[RightDoubleBracket]"}], " ", "=", " ", 
        RowBox[{"TeXLabel", "[", 
         RowBox[{
          RowBox[{"t", "\[LeftDoubleBracket]", 
           RowBox[{"All", ",", " ", "All", ",", " ", "2"}], 
           "\[RightDoubleBracket]"}], ",", " ", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"\"\<s\>\"", " ", "->", " ", 
             RowBox[{
             "o", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], 
            ",", " ", 
            RowBox[{"\"\<n\>\"", " ", "->", " ", 
             RowBox[{
             "o", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}]}], 
            ",", " ", "r"}], "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"Show", "[", 
        RowBox[{"g", ",", " ", 
         RowBox[{"Ticks", " ", "->", " ", "t"}]}], "]"}]}]}], 
     "\[IndentingNewLine]", "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"LabelFrameTicks", "[", 
    RowBox[{"g_", ",", " ", 
     RowBox[{"opts", ":", 
      RowBox[{"OptionsPattern", "[", "LabelTicks", "]"}]}]}], "]"}], " ", ":=",
    " ", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "o", ",", " ", "f", ",", " ", "l", ",", " ", "r", ",", " ", "t", ",", 
       " ", "b"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"l", ",", " ", "r"}], "}"}], ",", " ", 
         RowBox[{"{", 
          RowBox[{"b", ",", " ", "t"}], "}"}]}], "}"}], " ", "=", " ", 
       RowBox[{"FrameTicks", " ", "/.", " ", 
        RowBox[{"Options", "[", 
         RowBox[{"g", ",", " ", "FrameTicks"}], "]"}]}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
       "get", " ", "l", " ", "and", " ", "b", " ", "data", " ", "from", " ", 
        "Ticks"}], " ", "*)"}], "\[IndentingNewLine]", 
      RowBox[{"o", " ", "=", " ", 
       RowBox[{
        RowBox[{
         RowBox[{"MemberQ", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"Automatic", ",", " ", "True"}], "}"}], ",", " ", "#"}], 
          "]"}], "&"}], " ", "/@", " ", 
        RowBox[{"{", 
         RowBox[{"b", ",", " ", "l"}], "}"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"o", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
         " ", "||", " ", 
         RowBox[{
         "o", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"f", " ", "=", " ", 
          RowBox[{"ExpandTicks", "[", 
           RowBox[{
            RowBox[{"Show", "[", 
             RowBox[{"g", ",", " ", 
              RowBox[{"Frame", " ", "->", " ", "False"}]}], "]"}], ",", " ", 
            RowBox[{"OptionValue", "@", "Div"}]}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
           "o", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], ",", 
           " ", 
           RowBox[{
            RowBox[{"b", " ", "=", " ", 
             RowBox[{
             "f", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], 
            ";"}]}], "]"}], ";", "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
           "o", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], ",", 
           " ", 
           RowBox[{
            RowBox[{"l", " ", "=", " ", 
             RowBox[{
             "f", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}]}], 
            ";"}]}], "]"}], ";"}]}], "\[IndentingNewLine]", "]"}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{"expand", " ", "any", " ", "vectors", " ", "into", " ", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"val", ",", " ", "label"}], "}"}], ",", " ", ".."}], 
         "}"}]}], " ", "*)"}], "\[IndentingNewLine]", 
      RowBox[{"f", " ", "=", " ", 
       RowBox[{
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"VectorQ", "[", "#", "]"}], ",", " ", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"#", ",", " ", "#"}], "}"}], "\[Transpose]"}], ",", " ", 
          "#"}], "]"}], "&"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"f", " ", "=", " ", 
       RowBox[{"f", " ", "/@", " ", 
        RowBox[{"<|", 
         RowBox[{
          RowBox[{"\"\<l\>\"", " ", "->", " ", "l"}], ",", " ", 
          RowBox[{"\"\<b\>\"", " ", "->", " ", "b"}], ",", " ", 
          RowBox[{"\"\<r\>\"", " ", "->", " ", "r"}], ",", " ", 
          RowBox[{"\"\<t\>\"", " ", "->", " ", "t"}]}], "|>"}]}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{"scale", " ", "right", " ", "axis", " ", 
        RowBox[{"w", ".", "r", ".", "t", ".", " ", "left"}], " ", "axis"}], 
       " ", "*)"}], "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"r", " ", "===", " ", "True"}], " ", "&&", " ", 
         RowBox[{"l", " ", "=!=", " ", "None"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"o", " ", "=", " ", 
          RowBox[{"Abs", "@", 
           RowBox[{"Min", "@", 
            RowBox[{"Cases", "[", 
             RowBox[{
              RowBox[{
              "g", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
              ",", " ", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"x_", "?", "NumericQ"}], ",", " ", 
                 RowBox[{"y_", "?", "NumericQ"}]}], "}"}], " ", ":>", " ", 
               "y"}], ",", " ", "Infinity"}], "]"}]}]}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"o", " ", "=", " ", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"PossibleZeroQ", "[", "o", "]"}], ",", " ", "1", ",", " ",
             "o"}], "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"r", " ", "=", " ", 
          RowBox[{"f", "[", "\"\<l\>\"", "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"r", "\[LeftDoubleBracket]", 
           RowBox[{"All", ",", " ", "2"}], "\[RightDoubleBracket]"}], " ", 
          "=", " ", 
          RowBox[{
           RowBox[{
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{"NumericQ", "@", "#"}], ",", " ", 
              RowBox[{"#", "/", " ", "o"}], ",", " ", "#"}], "]"}], "&"}], 
           " ", "/@", " ", 
           RowBox[{"r", "\[LeftDoubleBracket]", 
            RowBox[{"All", ",", " ", "2"}], "\[RightDoubleBracket]"}]}]}], 
         ";", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"f", "[", "\"\<r\>\"", "]"}], " ", "=", " ", "r"}], ";"}]}],
        "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"o", " ", "=", " ", 
       RowBox[{"Select", "[", 
        RowBox[{"f", ",", " ", "ListQ"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{"remove", " ", "minor", " ", "ticks"}], " ", "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"!", 
         RowBox[{"OptionValue", "[", "Min", "]"}]}], ",", " ", 
        RowBox[{
         RowBox[{"o", " ", "=", " ", 
          RowBox[{
           RowBox[{
            RowBox[{"Select", "[", 
             RowBox[{"#", ",", " ", 
              RowBox[{
               RowBox[{"NumericQ", "[", 
                RowBox[{
                "#", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], 
                "]"}], "&"}]}], "]"}], "&"}], " ", "/@", " ", "o"}]}], 
         ";"}]}], "]"}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Length", "@", "o"}], " ", ">", " ", "0"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{
          RowBox[{
          "treat", " ", "rows", " ", "as", " ", "their", " ", "own", " ", 
           "dataset"}], ",", " ", 
          RowBox[{
          "which", " ", "might", " ", "require", " ", "padding", " ", "of", 
           " ", "s", " ", "and", " ", "n"}]}], " ", "*)"}], 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"r", " ", "=", " ", 
          RowBox[{"OptionValue", "@", "TeXLabel"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"b", " ", "=", " ", 
          RowBox[{"OptionValue", "[", 
           RowBox[{"TeXLabel", ",", " ", 
            RowBox[{"{", "r", "}"}], ",", "  ", 
            RowBox[{"{", 
             RowBox[{"\"\<s\>\"", ",", " ", "\"\<n\>\""}], "}"}]}], "]"}]}], 
         ";", "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"!", 
            RowBox[{"ListQ", "[", 
             RowBox[{
             "b", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
             "]"}]}], ",", " ", 
           RowBox[{
            RowBox[{"b", " ", "=", " ", 
             RowBox[{"Transpose", "@", 
              RowBox[{"ConstantArray", "[", 
               RowBox[{"b", ",", " ", 
                RowBox[{"Length", "@", "o"}]}], "]"}]}]}], ";"}]}], "]"}], 
         ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{"(*", " ", "texify", " ", "*)"}], "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"o", "\[LeftDoubleBracket]", 
           RowBox[{"All", ",", " ", "All", ",", " ", "2"}], 
           "\[RightDoubleBracket]"}], " ", "=", " ", 
          RowBox[{"TeXLabel", "[", 
           RowBox[{
            RowBox[{"Values", "@", 
             RowBox[{"o", "\[LeftDoubleBracket]", 
              RowBox[{"All", ",", " ", "All", ",", " ", "2"}], 
              "\[RightDoubleBracket]"}]}], ",", " ", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"\"\<s\>\"", " ", "->", " ", 
               RowBox[{
               "b", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], 
              ",", " ", 
              RowBox[{"\"\<n\>\"", " ", "->", " ", 
               RowBox[{
               "b", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}]}], 
              ",", " ", "r"}], "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"f", " ", "=", " ", 
          RowBox[{"Join", "[", 
           RowBox[{"f", ",", " ", "o"}], "]"}]}], ";"}]}], 
       "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"f", " ", "=", " ", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"f", "[", "\"\<l\>\"", "]"}], ",", " ", 
           RowBox[{"f", "[", "\"\<r\>\"", "]"}]}], "}"}], ",", " ", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"f", "[", "\"\<b\>\"", "]"}], ",", " ", 
           RowBox[{"f", "[", "\"\<t\>\"", "]"}]}], "}"}]}], "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Show", "[", 
       RowBox[{"g", ",", " ", 
        RowBox[{"Frame", " ", "->", " ", "True"}], ",", " ", 
        RowBox[{"FrameTicks", " ", "->", " ", "f"}]}], "]"}]}]}], 
    "\[IndentingNewLine]", "]"}]}], ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.8850492949102874`*^9, 3.885049350995677*^9}, {
   3.885051977456559*^9, 3.885052146748494*^9}, {3.8850521926427298`*^9, 
   3.8850522124249725`*^9}, {3.8850522433601933`*^9, 
   3.8850522970451293`*^9}, {3.88505233039942*^9, 3.885052383416583*^9}, {
   3.8850524530900383`*^9, 3.885052490019311*^9}, {3.885052767509959*^9, 
   3.885052877549101*^9}, {3.8850533713970757`*^9, 3.885053371966563*^9}, {
   3.8850534036143475`*^9, 3.8850534175505185`*^9}, {3.8850534667475986`*^9, 
   3.8850535543222623`*^9}, {3.8850538239090843`*^9, 
   3.8850538240980177`*^9}, {3.8850538555581207`*^9, 3.885054006716485*^9}, {
   3.885054393176672*^9, 3.885054409250244*^9}, {3.8850546137762156`*^9, 
   3.885054614028391*^9}, {3.885054701596278*^9, 3.885054776324197*^9}, {
   3.885054881574647*^9, 3.8850549460936656`*^9}, {3.8850550139420447`*^9, 
   3.885055017959087*^9}, 3.8850550503248177`*^9, {3.8850552516793766`*^9, 
   3.885055253783043*^9}, {3.885055377101391*^9, 3.8850554538284903`*^9}, {
   3.8850555458721304`*^9, 3.885055548004018*^9}, {3.8850555862445917`*^9, 
   3.885055750111452*^9}, {3.8850558378918505`*^9, 3.8850559046575956`*^9}, {
   3.885055936282101*^9, 3.885055943204384*^9}, {3.8850559993775096`*^9, 
   3.8850560499285774`*^9}, {3.8850560858001947`*^9, 3.885056142530492*^9}, {
   3.8850562161153383`*^9, 3.885056219720435*^9}, {3.885056351625145*^9, 
   3.885056442340068*^9}, {3.8850565293838387`*^9, 3.885056532698899*^9}, {
   3.8850566412995243`*^9, 3.885056647142435*^9}, {3.8850566971790357`*^9, 
   3.8850569451066113`*^9}, {3.885057002205954*^9, 3.8850570124666243`*^9}, {
   3.8850570568123407`*^9, 3.885057095412342*^9}, {3.8850571432203145`*^9, 
   3.885057293133823*^9}, {3.885058184782342*^9, 3.8850582025752892`*^9}, {
   3.885058451101615*^9, 3.8850585159629536`*^9}, {3.885058566409313*^9, 
   3.8850585892201977`*^9}, {3.885059722981583*^9, 3.8850597234683332`*^9}, {
   3.8850601146508284`*^9, 3.8850601179393578`*^9}, {3.8850601607518616`*^9, 
   3.885060191787364*^9}, {3.88506023217725*^9, 3.8850602451561627`*^9}, {
   3.885060386262491*^9, 3.8850603992820463`*^9}, 3.885060442575448*^9, {
   3.8850605083188953`*^9, 3.885060508523093*^9}, {3.885061894880062*^9, 
   3.885061901207304*^9}, {3.885062704991233*^9, 3.8850628014805946`*^9}, {
   3.8850629613425827`*^9, 3.885062966905087*^9}, {3.8850630738317766`*^9, 
   3.88506309535804*^9}, 3.885063129044399*^9, {3.8850634181160593`*^9, 
   3.8850634185104856`*^9}, {3.8850634785523305`*^9, 
   3.8850634834868813`*^9}, {3.885063538044227*^9, 3.8850635784718533`*^9}, {
   3.885103030078682*^9, 3.885103030345722*^9}, {3.8851030625616446`*^9, 
   3.885103080557865*^9}, {3.885103167714922*^9, 3.8851032001233497`*^9}, {
   3.8851039264440107`*^9, 3.8851039698457456`*^9}, {3.8851040787785797`*^9, 
   3.8851040979516582`*^9}, {3.8851041531322527`*^9, 3.885104200948023*^9}, {
   3.8851042344437475`*^9, 3.885104240502823*^9}, {3.885104308662719*^9, 
   3.885104329373088*^9}, {3.885104413792397*^9, 3.8851044386367874`*^9}, {
   3.8851044863313723`*^9, 3.8851045743205657`*^9}, {3.8851046313432426`*^9, 
   3.885104682337838*^9}, {3.8851047219566636`*^9, 3.8851047658033447`*^9}, {
   3.8851048038215632`*^9, 3.8851048732276196`*^9}, {3.8851049041206903`*^9, 
   3.885104907118227*^9}, {3.885105026109722*^9, 3.885105184510142*^9}, {
   3.8851052295630255`*^9, 3.8851052325728836`*^9}, {3.8851053192482705`*^9, 
   3.885105396311555*^9}, {3.8851054335298576`*^9, 3.8851054585598774`*^9}, {
   3.885105882732298*^9, 3.8851059064311047`*^9}, {3.8851059959559736`*^9, 
   3.885106090379311*^9}, {3.885106338250906*^9, 3.8851064083729715`*^9}, {
   3.885107001750389*^9, 3.8851071137597446`*^9}, {3.885107178988615*^9, 
   3.8851072240173674`*^9}, {3.8851072762224655`*^9, 3.885107286887624*^9}, {
   3.885107330443967*^9, 3.8851073308989806`*^9}, {3.885107373409337*^9, 
   3.8851073925363655`*^9}, {3.885107533584263*^9, 3.885107533924574*^9}, {
   3.8851080132853017`*^9, 3.885108057239654*^9}, {3.885108092146951*^9, 
   3.8851081157017307`*^9}, 3.885108189456344*^9, {3.885108419349586*^9, 
   3.885108442329702*^9}, {3.885108618371935*^9, 3.8851087120364337`*^9}, {
   3.885108745080927*^9, 3.8851087811486006`*^9}, {3.8851088320258803`*^9, 
   3.8851088764642177`*^9}, {3.8851092407585897`*^9, 
   3.8851092686419625`*^9}, {3.885109303172761*^9, 3.8851093124116297`*^9}, {
   3.8851093583417063`*^9, 3.8851093623379393`*^9}, {3.8851093928305597`*^9, 
   3.8851093929888344`*^9}, {3.8851094804498253`*^9, 3.88510948060841*^9}, {
   3.885109566257435*^9, 3.8851097441759305`*^9}, {3.8851097876986527`*^9, 
   3.8851098313506737`*^9}, {3.8851099130715075`*^9, 
   3.8851099272293997`*^9}, {3.88510996232405*^9, 3.8851099657162123`*^9}, {
   3.885110035208751*^9, 3.8851100496678286`*^9}, {3.8851102160648556`*^9, 
   3.885110283519005*^9}, {3.8851103306248956`*^9, 3.8851103417791567`*^9}, {
   3.885110408444132*^9, 3.8851104119470053`*^9}, {3.8851104681307926`*^9, 
   3.8851104940178137`*^9}, {3.8851105281399665`*^9, 3.885110628505012*^9}, {
   3.8851106885286074`*^9, 3.8851107233632727`*^9}, {3.8851107676938453`*^9, 
   3.885110789278494*^9}, {3.885110881456936*^9, 3.8851108844743385`*^9}, {
   3.885110966197705*^9, 3.8851109970027266`*^9}, {3.885111115820857*^9, 
   3.885111129625726*^9}, {3.8851111608531966`*^9, 3.8851111754339476`*^9}, {
   3.8851112246604557`*^9, 3.885111226088112*^9}, {3.8851112605986333`*^9, 
   3.8851112614042797`*^9}, {3.8851113379212794`*^9, 3.88511139364467*^9}, {
   3.8851114332783456`*^9, 3.88511143567843*^9}, {3.885111530779621*^9, 
   3.885111632378628*^9}, {3.885111689063446*^9, 3.885111703175029*^9}, {
   3.8851117555864573`*^9, 3.8851117584760056`*^9}, {3.88511192821576*^9, 
   3.8851119497107706`*^9}, {3.8851119987039104`*^9, 
   3.8851120038483458`*^9}, {3.8851171138947687`*^9, 
   3.8851171821256237`*^9}, {3.8851172405007963`*^9, 3.885117244052896*^9}, {
   3.8851176360984592`*^9, 3.885117642710963*^9}, {3.885117778798394*^9, 
   3.885117787001359*^9}, {3.8851178437800536`*^9, 3.885117869179911*^9}, {
   3.885131610908749*^9, 3.8851316661641073`*^9}, {3.8851318036633577`*^9, 
   3.885131821249264*^9}, {3.885131874683385*^9, 3.8851318802354507`*^9}, {
   3.8851320386055183`*^9, 3.8851320602309427`*^9}, {3.8851321431923122`*^9, 
   3.8851321487887015`*^9}, {3.8851322372567725`*^9, 
   3.8851322436439257`*^9}, {3.8851323687417264`*^9, 
   3.8851323787830625`*^9}, {3.8851324487977877`*^9, 
   3.8851324636405582`*^9}, {3.8851325608042135`*^9, 
   3.8851325686264086`*^9}, {3.8851330006437063`*^9, 
   3.8851330066882443`*^9}, {3.8851331305026617`*^9, 3.885133160558794*^9}, {
   3.8851332006520944`*^9, 3.885133208701339*^9}, {3.8851332555027933`*^9, 
   3.8851332565708284`*^9}, 3.8851332920484614`*^9, {3.885133432284172*^9, 
   3.8851334511563845`*^9}, {3.8851346699171133`*^9, 
   3.8851346841687613`*^9}, {3.885134792488755*^9, 3.885134792623768*^9}, {
   3.885134976621099*^9, 3.8851350220725408`*^9}, {3.885135207015758*^9, 
   3.8851352279479713`*^9}, {3.885135264234991*^9, 3.8851353831809144`*^9}, {
   3.8851354147062306`*^9, 3.885135449699194*^9}, {3.885135494999262*^9, 
   3.8851354967440853`*^9}, {3.8851355474917517`*^9, 3.885135575761128*^9}, 
   3.8851358857087336`*^9, {3.8851359334772296`*^9, 3.8851360309962006`*^9}, {
   3.8851360751273336`*^9, 3.8851361743049173`*^9}, {3.88513915165851*^9, 
   3.8851391518322344`*^9}, {3.885139443290275*^9, 3.8851395447474785`*^9}, {
   3.885139603996862*^9, 3.88513960454639*^9}, {3.8851396385494585`*^9, 
   3.885139649810437*^9}, 3.8851397043484077`*^9, {3.8851397378643923`*^9, 
   3.885139738022869*^9}, 3.8851398714280596`*^9, {3.8851414731614456`*^9, 
   3.885141480754526*^9}, {3.8851418936897135`*^9, 3.885141949584346*^9}, {
   3.8851419948028564`*^9, 3.885142001897169*^9}, {3.8851420646083603`*^9, 
   3.8851420695858383`*^9}, {3.8851421369728603`*^9, 
   3.8851421716383815`*^9}, {3.8851422786656485`*^9, 3.885142280599577*^9}, {
   3.885142348146731*^9, 3.8851423500173855`*^9}, {3.885142408124349*^9, 
   3.8851424085562453`*^9}, {3.885143286208206*^9, 3.8851432923794637`*^9}, {
   3.885143487388129*^9, 3.8851435156324596`*^9}, {3.885143569992431*^9, 
   3.8851435705884743`*^9}, {3.885143769715749*^9, 3.8851437698724804`*^9}, {
   3.8851840056240644`*^9, 3.8851840392524796`*^9}, {3.8851840908061495`*^9, 
   3.8851841266459837`*^9}, {3.885188963189841*^9, 3.885189013496627*^9}, 
   3.885189047406284*^9, 
   3.8851891266078234`*^9},ExpressionUUID->"c160949f-feac-4016-a2cb-\
34fe03beeac3"],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{
   RowBox[{
    RowBox[{"LabelTicks", "[", 
     RowBox[{"NumberForm", ",", " ", "data_"}], "]"}], " ", ":=", " ", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", "f", "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"f", " ", "=", " ", 
        RowBox[{
         RowBox[{
          RowBox[{"Abs", "[", 
           RowBox[{"Last", "@", 
            RowBox[{"RealDigits", "[", 
             RowBox[{"Subtract", "@@", 
              RowBox[{"Reverse", "@", 
               RowBox[{"TakeSmallest", "[", 
                RowBox[{"#", ",", " ", "2"}], "]"}]}]}], "]"}]}], "]"}], " ", 
          "+", " ", "1"}], "&"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"Map", "[", 
        RowBox[{"f", ",", " ", "data", ",", " ", 
         RowBox[{"{", 
          RowBox[{"-", "2"}], "}"}]}], "]"}]}]}], "\[IndentingNewLine]", 
     "]"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"LabelTicks", "[", 
     RowBox[{"\"\<\[Sigma]\>\"", ",", " ", 
      RowBox[{"d_", ":", "Automatic"}]}], "]"}], " ", ":=", " ", 
    RowBox[{
     RowBox[{
      RowBox[{"ToString", "@", 
       RowBox[{"Round", "[", 
        RowBox[{"#", ",", " ", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"d", " ", "===", " ", "Automatic"}], ",", " ", "1", ",", 
           " ", "d"}], "]"}]}], "]"}]}], " ", "<>", " ", 
      "\"\<^\\\\circ\>\""}], "&"}]}], " ", ";", "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"LabelTicks", "[", 
     RowBox[{"\"\<\[Tau]\>\"", ",", " ", 
      RowBox[{"d_", ":", "Automatic"}]}], "]"}], " ", ":=", " ", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"unit", ",", " ", "fmt"}], "}"}], ",", " ", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"fmt", " ", "=", " ", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"d", " ", "===", " ", "Automatic"}], ",", " ", 
          RowBox[{"{", 
           RowBox[{"3", ",", "1"}], "}"}], ",", " ", "d"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{
       "unit", " ", "=", " ", 
        "\"\<\\\\frac{s \\\\sqrt{g}}{\\\\sqrt{L}}\>\""}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"unit", " ", "=", " ", 
        RowBox[{"StringTemplate", "[", 
         RowBox[{
         "\"\<\\\\SI{``}{\>\"", "<>", " ", "unit", " ", "<>", " ", 
          "\"\<}\>\""}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"#", " ", "\[Equal]", " ", "0"}], ",", " ", 
          RowBox[{"unit", "[", "0", "]"}], ",", " ", 
          RowBox[{"unit", "[", 
           RowBox[{"(*", 
            RowBox[{"ToString", "@"}], "*)"}], 
           RowBox[{"NumberForm", "[", 
            RowBox[{
             RowBox[{"N", "@", "#"}], ",", " ", "fmt"}], "]"}], "]"}]}], 
         "]"}], "&"}]}]}], " ", "\[IndentingNewLine]", "]"}]}], ";", 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"LabelTicks", "[", 
     RowBox[{"\"\<v\>\"", ",", " ", 
      RowBox[{"d_", ":", "Automatic"}]}], "]"}], " ", ":=", " ", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"unit", ",", " ", "fmt"}], "}"}], ",", " ", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"fmt", " ", "=", " ", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"d", " ", "===", " ", "Automatic"}], ",", " ", 
          RowBox[{"{", 
           RowBox[{"3", ",", "2"}], "}"}], ",", " ", "d"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{
       "unit", " ", "=", " ", 
        "\"\<\\\\frac{m \\\\sqrt{L}}{s L \\\\sqrt{g}}\>\""}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"unit", " ", "=", " ", 
        RowBox[{"StringTemplate", "[", 
         RowBox[{
         "\"\<\\\\SI{``}{\>\"", "<>", " ", "unit", " ", "<>", " ", 
          "\"\<}\>\""}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"#", " ", "\[Equal]", " ", "0"}], ",", " ", 
          RowBox[{"unit", "[", "0", "]"}], ",", " ", 
          RowBox[{"unit", "[", 
           RowBox[{"(*", 
            RowBox[{"ToString", "@"}], "*)"}], 
           RowBox[{"NumberForm", "[", 
            RowBox[{
             RowBox[{"N", "@", "#"}], ",", " ", "fmt"}], "]"}], "]"}]}], 
         "]"}], "&"}]}]}], " ", "\[IndentingNewLine]", "]"}]}], ";", 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"LabelTicks", "[", 
     RowBox[{"\"\<n\>\"", ",", " ", 
      RowBox[{"d_", ":", 
       RowBox[{"{", 
        RowBox[{"3", ",", "1"}], "}"}]}]}], "]"}], " ", ":=", " ", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"unit", ",", " ", "fmt"}], "}"}], ",", " ", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"fmt", " ", "=", " ", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"d", " ", "===", " ", "Automatic"}], ",", " ", 
          RowBox[{"{", 
           RowBox[{"3", ",", "1"}], "}"}], ",", " ", "d"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"unit", " ", "=", " ", 
        RowBox[{"StringTemplate", "[", "\"\<\\\\num{``}\>\"", "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"#", " ", "\[Equal]", " ", "0"}], ",", " ", 
          RowBox[{"unit", "[", "0", "]"}], ",", " ", 
          RowBox[{"unit", "[", 
           RowBox[{"NumberForm", "[", 
            RowBox[{
             RowBox[{"N", "@", "#"}], ",", " ", "fmt"}], "]"}], "]"}]}], 
         "]"}], "&"}]}]}], " ", "\[IndentingNewLine]", "]"}]}], ";", 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"LabelTicks", "[", 
     RowBox[{"Ticks", ",", " ", "t_", ",", " ", 
      RowBox[{"s_", ":", "\"\<n\>\""}], ",", " ", 
      RowBox[{"d_", ":", "Automatic"}]}], "]"}], " ", ":=", " ", 
    RowBox[{"BLTeX", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"StringQ", "[", "s", "]"}], ",", " ", 
         RowBox[{"LabelTicks", "[", 
          RowBox[{"s", ",", " ", "d"}], "]"}], ",", " ", "s"}], "]"}], " ", "/@",
        " ", "t"}], ",", " ", "tickmag"}], "]"}]}], ";", 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"LabelTicks", "[", 
     RowBox[{"g_", ",", " ", 
      RowBox[{"OptionsPattern", "[", "GetGaitParameters", "]"}]}], "]"}], " ",
     ":=", " ", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"x", ",", " ", "y", ",", " ", "ft", ",", " ", "i"}], "}"}], 
      ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"i", " ", "=", " ", 
        RowBox[{"OptionValue", "[", "\"\<i\>\"", "]"}]}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Length", "@", "i"}], " ", "==", " ", "3"}], ",", " ", 
         RowBox[{
          RowBox[{"Print", "[", "\"\<3 axes not implemented.\>\"", "]"}], ";",
           " ", 
          RowBox[{"Return", "[", "g", "]"}]}]}], "]"}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"x", ",", " ", "y"}], "}"}], " ", "=", " ", 
        RowBox[{"Ticks", " ", "/.", " ", 
         RowBox[{"First", "@", 
          RowBox[{"AbsoluteOptions", "[", 
           RowBox[{
            RowBox[{"Show", "[", 
             RowBox[{"g", ",", " ", 
              RowBox[{"Frame", " ", "->", " ", "False"}]}], "]"}], ",", " ", 
            "Ticks"}], "]"}]}]}]}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"x", " ", "=", " ", 
        RowBox[{"Select", "[", 
         RowBox[{"x", ",", " ", 
          RowBox[{
           RowBox[{"NumericQ", "[", 
            RowBox[{
            "#", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], 
            "]"}], "&"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"y", " ", "=", " ", 
        RowBox[{"Select", "[", 
         RowBox[{"y", ",", " ", 
          RowBox[{
           RowBox[{"NumericQ", "[", 
            RowBox[{
            "#", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], 
            "]"}], "&"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"x", "\[LeftDoubleBracket]", 
         RowBox[{"All", ",", " ", "2"}], "\[RightDoubleBracket]"}], " ", "=", 
        " ", 
        RowBox[{
         RowBox[{"StringTemplate", "[", "\"\<\\\\num{``}\>\"", "]"}], " ", "/@",
          " ", 
         RowBox[{"x", "\[LeftDoubleBracket]", 
          RowBox[{"All", ",", " ", "2"}], "\[RightDoubleBracket]"}]}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"x", "\[LeftDoubleBracket]", 
         RowBox[{"All", ",", " ", "2"}], "\[RightDoubleBracket]"}], " ", "=", 
        " ", 
        RowBox[{"BLTeX", "[", 
         RowBox[{
          RowBox[{"x", "\[LeftDoubleBracket]", 
           RowBox[{"All", ",", " ", "2"}], "\[RightDoubleBracket]"}], ",", 
          " ", "tickmag"}], "]"}]}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"y", "\[LeftDoubleBracket]", 
         RowBox[{"All", ",", " ", "2"}], "\[RightDoubleBracket]"}], " ", "=", 
        " ", 
        RowBox[{
         RowBox[{"StringTemplate", "[", "\"\<\\\\num{``}\>\"", "]"}], " ", "/@",
          " ", 
         RowBox[{"y", "\[LeftDoubleBracket]", 
          RowBox[{"All", ",", " ", "2"}], "\[RightDoubleBracket]"}]}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"y", "\[LeftDoubleBracket]", 
         RowBox[{"All", ",", " ", "2"}], "\[RightDoubleBracket]"}], " ", "=", 
        " ", 
        RowBox[{"BLTeX", "[", 
         RowBox[{
          RowBox[{"y", "\[LeftDoubleBracket]", 
           RowBox[{"All", ",", " ", "2"}], "\[RightDoubleBracket]"}], ",", 
          " ", "tickmag"}], "]"}]}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"ft", " ", "=", " ", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"y", ",", " ", "None"}], "}"}], ",", " ", 
          RowBox[{"{", 
           RowBox[{"x", ",", " ", "None"}], "}"}]}], "}"}]}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"Show", "[", 
        RowBox[{"g", ",", " ", 
         RowBox[{"Frame", " ", "->", " ", "True"}], ",", " ", 
         RowBox[{"FrameTicks", " ", "->", " ", "ft"}]}], "]"}]}]}], 
     "\[IndentingNewLine]", "]"}]}], ";"}], "*)"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.8829465235980425`*^9, 3.8829465560322227`*^9}, {
   3.8829465936340714`*^9, 3.8829466987560987`*^9}, {3.8829469520482254`*^9, 
   3.8829469743769436`*^9}, {3.8829472275635004`*^9, 
   3.8829472549641294`*^9}, {3.8842229220848246`*^9, 3.884222934516777*^9}, {
   3.884222964840537*^9, 3.8842229673513308`*^9}, {3.884223034782138*^9, 
   3.8842230887937603`*^9}, {3.884223121492022*^9, 3.8842232064259334`*^9}, {
   3.884223642735254*^9, 3.8842237146786594`*^9}, {3.8842238017314053`*^9, 
   3.8842238133003993`*^9}, 3.8842238489133925`*^9, {3.8844005087035055`*^9, 
   3.88440052354961*^9}, {3.8844005834511023`*^9, 3.8844007081249275`*^9}, {
   3.885042827082409*^9, 3.8850428909997225`*^9}, {3.885042933164389*^9, 
   3.8850429374085083`*^9}, {3.8850429752684164`*^9, 3.885042987092125*^9}, {
   3.8850430417914667`*^9, 3.8850430491845922`*^9}, {3.8850432574409657`*^9, 
   3.885043296249442*^9}, {3.8850433452206707`*^9, 3.8850433770332727`*^9}, {
   3.885046483064111*^9, 3.885046485666641*^9}, {3.88504685912179*^9, 
   3.885047020529525*^9}, {3.885047128504292*^9, 3.8850471511246543`*^9}, {
   3.8850474465742044`*^9, 3.88504744674885*^9}, {3.8850487393053236`*^9, 
   3.885048745814456*^9}, {3.8850488377810364`*^9, 3.8850488381595507`*^9}, {
   3.885048868204756*^9, 3.8850488895881224`*^9}, {3.8850490299143047`*^9, 
   3.885049061045603*^9}, 3.8850491851381207`*^9, {3.8850492298942595`*^9, 
   3.885049231757485*^9}, {3.885049279442227*^9, 3.885049280711378*^9}, {
   3.8851119435716953`*^9, 3.8851119603607655`*^9}},
 CellLabel->
  "In[1278]:=",ExpressionUUID->"f82b5aaa-8b6c-4d1f-8bc0-6301e28d411f"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"SummarizeGaitParameters", "[", 
    RowBox[{"C_", ",", " ", 
     RowBox[{"opts", ":", 
      RowBox[{"OptionsPattern", "[", "GetGaitParameters", "]"}]}]}], "]"}], 
   " ", ":=", " ", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "Z", ",", " ", "Z0", ",", " ", "A", ",", " ", "i", ",", " ", "f"}], 
      "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"i", " ", "=", " ", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"!", 
          RowBox[{"VectorQ", "[", "C", "]"}]}], ",", " ", 
         RowBox[{"{", "C", "}"}], ",", " ", "C"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"Z", ",", " ", "Z0", ",", " ", "A"}], "}"}], " ", "=", " ", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"Join", "@@", 
          RowBox[{"GetGaitParameters", "[", 
           RowBox[{"i", ",", " ", "opts", ",", " ", 
            RowBox[{"\"\<i\>\"", " ", "->", " ", "All"}]}], "]"}]}], ")"}], 
        "\[Transpose]"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"f", " ", "=", " ", 
       RowBox[{
        RowBox[{"Map", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Interval", "@", 
            RowBox[{"MinMax", "[", "#", "]"}]}], "&"}], ",", " ", 
          RowBox[{"#1", "\[Transpose]"}]}], "]"}], "&"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"MapThread", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"{", 
          RowBox[{"#2", ",", " ", 
           RowBox[{"Sequence", "@@", 
            RowBox[{"f", "[", "#1", "]"}]}]}], "}"}], "&"}], ",", " ", 
        RowBox[{"{", 
         RowBox[{"Z", ",", " ", "A"}], "}"}]}], "]"}]}]}], 
    "\[IndentingNewLine]", "]"}]}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.852298583333617*^9, 3.852298610243247*^9}, {
   3.852298653012843*^9, 3.85229878646185*^9}, {3.852298832112137*^9, 
   3.8522988977003717`*^9}, {3.852298933864162*^9, 3.852299016479601*^9}, {
   3.852299058162047*^9, 3.852299060390464*^9}, {3.852299149990561*^9, 
   3.852299199626333*^9}, {3.852299252856226*^9, 3.852299317301502*^9}, {
   3.85229943083884*^9, 3.852299507427808*^9}, {3.85229956584317*^9, 
   3.852299569707017*^9}, {3.852299626522052*^9, 3.8522996632622423`*^9}, {
   3.852299749469885*^9, 3.852299770268764*^9}, {3.852299857214037*^9, 
   3.852299910415036*^9}, {3.852300053991177*^9, 3.852300208049074*^9}, 
   3.852300253181221*^9, {3.852300291677692*^9, 3.852300295996105*^9}, {
   3.852300350456399*^9, 3.852300372255616*^9}, {3.852300407660795*^9, 
   3.852300409820463*^9}, {3.852300464301675*^9, 3.852300538953744*^9}, 
   3.852300689539043*^9, {3.852300862975657*^9, 3.8523008835375233`*^9}, 
   3.852300918330297*^9, {3.852300978256299*^9, 3.852301079545656*^9}, {
   3.852301124991376*^9, 3.852301139664266*^9}, {3.852309119378031*^9, 
   3.852309122435807*^9}, {3.852309190328498*^9, 3.852309217560854*^9}, {
   3.85230924895829*^9, 3.85230926960623*^9}, {3.852309366567052*^9, 
   3.8523093869026613`*^9}, {3.85230942565423*^9, 3.852309429872156*^9}, {
   3.852309500565888*^9, 3.852309515846108*^9}, {3.8523095684458838`*^9, 
   3.852309607420705*^9}, {3.8523096635765457`*^9, 3.852309684365569*^9}, 
   3.852309801115803*^9, {3.852309856706702*^9, 3.852309866119317*^9}, {
   3.852311544668331*^9, 3.8523115515408154`*^9}, 3.852311694532016*^9, {
   3.8523117378246527`*^9, 3.852311800720509*^9}, {3.852311835391608*^9, 
   3.852311855911865*^9}, {3.852311901927535*^9, 3.852312034518058*^9}, {
   3.85231229138896*^9, 3.852312292956814*^9}, {3.852312388029723*^9, 
   3.852312422739868*^9}, {3.8523125015720043`*^9, 3.852312539499289*^9}, {
   3.852312613098345*^9, 3.852312617930637*^9}, {3.852312739227932*^9, 
   3.8523127599557056`*^9}, {3.852312796768839*^9, 3.8523128029767923`*^9}, {
   3.852313198365418*^9, 3.8523131996774673`*^9}, {3.852313339612234*^9, 
   3.852313348811687*^9}, {3.852313441531857*^9, 3.8523134536112127`*^9}, {
   3.8525822880331907`*^9, 3.8525823069574957`*^9}, {3.8525826461850157`*^9, 
   3.852582662015622*^9}, {3.852582695506452*^9, 3.852582744194252*^9}, {
   3.852605452135886*^9, 3.852605453959095*^9}, {3.8526118465428658`*^9, 
   3.852611849471459*^9}, {3.8526118964199877`*^9, 3.852611906833556*^9}, {
   3.8526121670165987`*^9, 3.852612172229535*^9}, 3.8526122685098143`*^9, {
   3.852612365761897*^9, 3.852612367034589*^9}, {3.852612455558868*^9, 
   3.8526124590298967`*^9}, {3.852613311525854*^9, 3.852613337567504*^9}, {
   3.852613376022217*^9, 3.852613405086052*^9}, {3.8526135982589684`*^9, 
   3.8526135987336884`*^9}, {3.852640384559593*^9, 3.852640390658396*^9}, {
   3.854938773908695*^9, 3.854938786360846*^9}, {3.8549388727201014`*^9, 
   3.854938879368577*^9}, 3.85493931521577*^9, {3.854939505579273*^9, 
   3.854939522315629*^9}, {3.854939593298707*^9, 3.8549396021127987`*^9}, {
   3.85516540859823*^9, 3.8551654332275753`*^9}, {3.855165480634115*^9, 
   3.8551654908533792`*^9}, {3.8551655255085697`*^9, 
   3.8551655255563927`*^9}, {3.855165606700148*^9, 3.855165712155981*^9}, {
   3.855165752769903*^9, 3.855165761767372*^9}, {3.855552605502788*^9, 
   3.855552609702321*^9}, {3.85555327294097*^9, 3.855553364566036*^9}, {
   3.8555534186271973`*^9, 3.855553426616503*^9}, {3.8555534579238873`*^9, 
   3.85555347649876*^9}, {3.8555740833233137`*^9, 3.85557409939077*^9}, {
   3.856097200276725*^9, 3.856097213164019*^9}, {3.856097270064888*^9, 
   3.856097310921644*^9}, {3.856099464483745*^9, 3.856099468877327*^9}, 
   3.8560995154659233`*^9, {3.856099561473411*^9, 3.856099570173924*^9}, {
   3.877495810406087*^9, 3.8774958120945163`*^9}, {3.8774959128048263`*^9, 
   3.8774959419069815`*^9}, 3.877496234368925*^9, {3.87751136841783*^9, 
   3.877511402367917*^9}, {3.877511442861677*^9, 3.8775114608085847`*^9}, {
   3.877511544049556*^9, 3.877511558097612*^9}, {3.8775117841105213`*^9, 
   3.8775118166786594`*^9}, {3.877511893226093*^9, 3.877511904622114*^9}, {
   3.877511982262479*^9, 3.8775119836325607`*^9}, {3.8775120256609507`*^9, 
   3.8775120759676466`*^9}, {3.8775121087871304`*^9, 3.87751211031831*^9}, {
   3.8775257396320724`*^9, 3.877525760032672*^9}, {3.8775257956353874`*^9, 
   3.877525892263658*^9}, {3.8775259262897673`*^9, 3.877525952801339*^9}, {
   3.8775260961362815`*^9, 3.87752609770791*^9}, {3.8775261752206416`*^9, 
   3.8775262083455906`*^9}, {3.8775263015455112`*^9, 
   3.8775263144198203`*^9}, {3.8775263521103888`*^9, 
   3.8775264558434362`*^9}, {3.877526487198698*^9, 3.877526505639492*^9}, {
   3.8775265600272017`*^9, 3.877526583996728*^9}, 3.877526654184307*^9, 
   3.8776247193827767`*^9, {3.877664220657501*^9, 3.877664393849448*^9}, {
   3.8776644286916428`*^9, 3.8776644328023105`*^9}, {3.877664482092246*^9, 
   3.8776644872704964`*^9}, {3.87766454412012*^9, 3.8776645593406415`*^9}, {
   3.877665052303112*^9, 3.877665052726675*^9}, {3.877665197581331*^9, 
   3.8776652020837965`*^9}, 3.8776652322106395`*^9, {3.877665272906599*^9, 
   3.8776652971597595`*^9}, {3.8776653473562975`*^9, 
   3.8776653951484537`*^9}, {3.877665463702331*^9, 3.8776656242466707`*^9}, {
   3.8776664614365516`*^9, 3.8776664932270823`*^9}, {3.87766655408671*^9, 
   3.877666567329855*^9}, {3.877666651957943*^9, 3.877666705131148*^9}, {
   3.8776670816500783`*^9, 3.8776670892766757`*^9}, {3.877667226348137*^9, 
   3.877667229831644*^9}, {3.8776672761970873`*^9, 3.877667290063265*^9}, {
   3.877667320345664*^9, 3.877667345378521*^9}, {3.8776673756673813`*^9, 
   3.8776673766706676`*^9}, {3.8776674327162013`*^9, 3.877667447878217*^9}, {
   3.87766747829178*^9, 3.8776675176457653`*^9}, {3.8776676136259913`*^9, 
   3.8776676417142167`*^9}, {3.8776677398767223`*^9, 
   3.8776677405511665`*^9}, {3.8776677765186653`*^9, 3.877667881623307*^9}, {
   3.8776679411124687`*^9, 3.877668003755312*^9}, {3.877668249852758*^9, 
   3.877668269701731*^9}, {3.877668319236982*^9, 3.8776683294098797`*^9}, {
   3.8776684394167957`*^9, 3.877668474480715*^9}, {3.877668505711732*^9, 
   3.877668506041554*^9}, {3.8776686550588765`*^9, 3.8776686602367325`*^9}, {
   3.87766879184499*^9, 3.877668801574337*^9}, 3.8776690696142664`*^9, {
   3.8776691336466527`*^9, 3.877669166287119*^9}, {3.8777612032452507`*^9, 
   3.8777612287824917`*^9}, {3.877940670950929*^9, 3.87794073215454*^9}, {
   3.877940868183241*^9, 3.87794087495303*^9}, {3.8779579871710453`*^9, 
   3.877958027764449*^9}, {3.877958211478696*^9, 3.877958308419908*^9}, {
   3.8779583396950974`*^9, 3.8779584289970217`*^9}, {3.878024177612484*^9, 
   3.8780243108394165`*^9}, {3.8780243448122854`*^9, 3.878024413192128*^9}, {
   3.878024444018181*^9, 3.878024458360289*^9}, {3.8780247835010567`*^9, 
   3.8780247838936844`*^9}, {3.8780248440534124`*^9, 3.878024846268014*^9}},
 CellLabel->
  "In[1279]:=",ExpressionUUID->"e12de8eb-0da3-4c1a-81c7-93e216e4d848"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"CompassGaitWalk", "[", "x__", "]"}], " ", ":=", " ", 
   RowBox[{"BLWalk", "[", 
    RowBox[{"x", ",", " ", 
     RowBox[{"BLAnimateBiped", " ", "\[Rule]", " ", 
      RowBox[{"{", 
       RowBox[{"\"\<Sim\>\"", " ", "\[Rule]", " ", "CompassGaitSim"}], 
       "}"}]}]}], "]"}]}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.8802150894267178`*^9, 3.88021511667912*^9}},
 CellLabel->
  "In[1280]:=",ExpressionUUID->"07f55560-62c0-4000-a4fc-8d1661f661ea"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Compute Eigenvalues", "Section",ExpressionUUID->"841205bc-bd4c-4ab1-a9b6-40ad4da3db48"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"Options", "[", "GaitEigenvalues", "]"}], " ", "=", " ", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"\"\<e\>\"", " ", "\[Rule]", " ", "Max"}], ",", " ", 
      RowBox[{"\"\<\[Sigma]\>\"", " ", "\[Rule]", " ", "Automatic"}]}], 
     "}"}]}], ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"GaitEigenvalues", "[", 
     RowBox[{
      RowBox[{"c_", "?", "VectorQ"}], ",", " ", 
      RowBox[{"opts", ":", 
       RowBox[{"OptionsPattern", "[", "]"}]}]}], "]"}], " ", ":=", " ", 
    RowBox[{"GaitEigenvalues", "[", 
     RowBox[{
      RowBox[{"P", "[", 
       RowBox[{
        RowBox[{"BLbiped", "[", "\"\<m[0]\>\"", "]"}], ",", " ", "c"}], "]"}],
       ",", " ", "opts"}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"GaitEigenvalues", "[", 
    RowBox[{"M_Association", ",", " ", 
     RowBox[{"OptionsPattern", "[", "]"}]}], "]"}], " ", ":=", " ", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "i", ",", " ", "m", ",", " ", "\[Sigma]T", ",", " ", "\[Sigma]0", ",", 
       " ", "x", ",", " ", "c", ",", " ", "\[Sigma]", ",", " ", "dSdT", ",", 
       " ", "dSdc", ",", " ", "dTdc", ",", " ", "f", ",", " ", "A", ",", " ", 
       "j", ",", " ", "Je", ",", " ", "Jt", ",", " ", "eigs", ",", " ", "k"}],
       "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"m", " ", "=", " ", 
       RowBox[{"M", "\[LeftDoubleBracket]", 
        RowBox[{"\"\<m\>\"", ",", " ", "1"}], "\[RightDoubleBracket]"}]}], 
      ";", "\[IndentingNewLine]", 
      RowBox[{"i", " ", "=", " ", 
       RowBox[{"BLbiped", "[", 
        RowBox[{"\"\<c\>\"", ",", " ", "m", ",", " ", "\"\<x\>\""}], "]"}]}], 
      ";", "\[IndentingNewLine]", 
      RowBox[{"j", " ", "=", " ", 
       RowBox[{"BLbiped", "[", 
        RowBox[{"\"\<p\>\"", ",", " ", "m", ",", " ", "\"\<x\>\""}], "]"}]}], 
      ";", "\[IndentingNewLine]", 
      RowBox[{"k", " ", "=", " ", 
       RowBox[{"OptionValue", "[", "\"\<\[Sigma]\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"k", " ", "===", " ", "Automatic"}], ",", " ", 
        "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{"get", " ", "slope", " ", "axis", " ", 
          RowBox[{"(", "axes", ")"}], " ", "for", " ", "2", "D", " ", 
          RowBox[{"(", 
           RowBox[{"3", "D"}], ")"}], " ", "robot"}], " ", "*)"}], 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"k", " ", "=", " ", 
          RowBox[{"BLbiped", "[", 
           RowBox[{"\"\<draw\>\"", ",", " ", "\"\<axes\>\""}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"k", " ", "=", " ", 
          RowBox[{
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"Length", "[", "k", "]"}], " ", "\[Equal]", " ", "2"}], 
             ",", " ", 
             RowBox[{"Complement", "[", 
              RowBox[{
               RowBox[{"Range", "[", 
                RowBox[{"1", ",", " ", "mm"}], "]"}], ",", " ", "k"}], "]"}], 
             ",", 
             RowBox[{"k", "\[LeftDoubleBracket]", 
              RowBox[{"1", ";;", "2"}], "\[RightDoubleBracket]"}]}], "]"}], 
           "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], ";"}]}], 
       "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{"compute", " ", "slopes", " ", 
        RowBox[{"(", 
         RowBox[{"Poincare", " ", "section"}], ")"}]}], " ", "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{"m", " ", "=", " ", 
       RowBox[{"M", "\[LeftDoubleBracket]", 
        RowBox[{"\"\<m\>\"", ",", " ", 
         RowBox[{"-", "1"}]}], "\[RightDoubleBracket]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"c", " ", "=", " ", 
       RowBox[{"Normal", "@", 
        RowBox[{"M", "\[LeftDoubleBracket]", 
         RowBox[{"\"\<c\>\"", ",", " ", 
          RowBox[{"-", "1"}]}], "\[RightDoubleBracket]"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{"t", " ", "=", " ", "0"}], " ", "*)"}], "\[IndentingNewLine]", 
      RowBox[{"x", " ", "=", " ", 
       RowBox[{"Normal", "@", 
        RowBox[{"M", "\[LeftDoubleBracket]", 
         RowBox[{"\"\<x+\>\"", ",", " ", "2"}], "\[RightDoubleBracket]"}]}]}],
       ";", "\[IndentingNewLine]", 
      RowBox[{"\[Sigma]0", " ", "=", " ", 
       RowBox[{
        RowBox[{"devec", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"BLbiped", "[", 
            RowBox[{"\"\<\[Sigma]\>\"", ",", " ", "m"}], "]"}], "[", 
           RowBox[{"x", ",", " ", "c"}], "]"}], ",", " ", "mm"}], "]"}], 
        "\[LeftDoubleBracket]", 
        RowBox[{"All", ",", " ", "k"}], "\[RightDoubleBracket]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{"t", " ", "=", " ", "T"}], " ", "*)"}], "\[IndentingNewLine]", 
      RowBox[{"x", " ", "=", " ", 
       RowBox[{"Normal", "@", 
        RowBox[{"M", "\[LeftDoubleBracket]", 
         RowBox[{"\"\<x-\>\"", ",", " ", 
          RowBox[{"-", "1"}]}], "\[RightDoubleBracket]"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"\[Sigma]T", " ", "=", " ", 
       RowBox[{
        RowBox[{"devec", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"BLbiped", "[", 
            RowBox[{"\"\<\[Sigma]\>\"", ",", " ", "m"}], "]"}], "[", 
           RowBox[{"x", ",", " ", "c"}], "]"}], ",", " ", "mm"}], "]"}], 
        "\[LeftDoubleBracket]", 
        RowBox[{"All", ",", " ", "k"}], "\[RightDoubleBracket]"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{"compute", " ", "Jacobians"}], " ", "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{"A", " ", "=", " ", 
       RowBox[{"Lookup", "[", 
        RowBox[{"BLbiped", ",", " ", "\"\<A\>\"", ",", " ", 
         RowBox[{"BLA", "[", "]"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"A", " ", "=", " ", 
       RowBox[{"A", "\[LeftDoubleBracket]", 
        RowBox[{"i", ",", " ", "i"}], "\[RightDoubleBracket]"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{"time", "-", 
        RowBox[{"based", " ", "switching"}]}], " ", "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{"Jt", " ", "=", " ", 
       RowBox[{"A", ".", 
        RowBox[{"x", "\[LeftDoubleBracket]", 
         RowBox[{"2", ",", " ", "i", ",", " ", "j"}], 
         "\[RightDoubleBracket]"}]}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{"state", "-", 
        RowBox[{"based", " ", "switching"}]}], " ", "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{"\[Sigma]", " ", "=", " ", 
       RowBox[{"\[Sigma]T", "-", "\[Sigma]0"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"dSdT", " ", "=", " ", 
       RowBox[{"\[Sigma]", "\[LeftDoubleBracket]", 
        RowBox[{"2", ",", " ", 
         RowBox[{"-", "1"}]}], "\[RightDoubleBracket]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"PossibleZeroQ", "[", "dSdT", "]"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"Je", " ", "=", " ", "Indeterminate"}], ";"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"(*", " ", "else", " ", "*)"}], "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{"finish", " ", "computing", " ", "dTdc"}], " ", "*)"}], 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"dSdc", " ", "=", " ", 
          RowBox[{
          "\[Sigma]", "\[LeftDoubleBracket]", "2", 
           "\[RightDoubleBracket]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"dTdc", " ", "=", " ", 
          RowBox[{
           RowBox[{"-", "dSdc"}], "/", "dSdT"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"(*", " ", 
          RowBox[{
           RowBox[{"get", " ", "state"}], "-", 
           RowBox[{"based", " ", "derivative"}]}], " ", "*)"}], 
         "\[IndentingNewLine]", 
         RowBox[{"f", " ", "=", " ", 
          RowBox[{"x", "\[LeftDoubleBracket]", 
           RowBox[{"2", ",", " ", "All", ",", " ", 
            RowBox[{"-", "1"}]}], "\[RightDoubleBracket]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"f", "=", " ", 
          RowBox[{"KroneckerProduct", "[", 
           RowBox[{"f", ",", " ", "dTdc"}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"Je", " ", "=", " ", 
          RowBox[{"A", ".", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"x", "\[LeftDoubleBracket]", 
              RowBox[{"2", ",", " ", "i", ",", " ", "j"}], 
              "\[RightDoubleBracket]"}], " ", "+", " ", 
             RowBox[{"f", "\[LeftDoubleBracket]", 
              RowBox[{"i", ",", " ", "j"}], "\[RightDoubleBracket]"}]}], 
            ")"}]}]}], ";"}]}], "\[IndentingNewLine]", "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"eigs", " ", "=", " ", 
       RowBox[{"Map", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"#", " ", "=!=", " ", "Indeterminate"}], ",", " ", 
            RowBox[{"Eigenvalues", "@", "#"}], ",", " ", "#"}], "]"}], "&"}], 
         ",", " ", 
         RowBox[{"{", 
          RowBox[{"Je", ",", " ", "Jt"}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"Switch", "[", 
       RowBox[{
        RowBox[{"OptionValue", "[", "\"\<e\>\"", "]"}], ",", 
        "\[IndentingNewLine]", "Max", ",", " ", 
        RowBox[{"Map", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Max", "@", 
            RowBox[{"Abs", "@", "#"}]}], "&"}], ",", " ", "eigs"}], "]"}], 
        ",", "\[IndentingNewLine]", "All", ",", " ", "eigs", ",", 
        "\[IndentingNewLine]", "\"\<J\>\"", ",", " ", 
        RowBox[{"{", 
         RowBox[{"Je", ",", " ", "Jt"}], "}"}]}], "\[IndentingNewLine]", 
       "]"}]}]}], "\[IndentingNewLine]", "]"}]}], ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.85609500285847*^9, 3.856095025763233*^9}, {
   3.856095144165687*^9, 3.856095228625387*^9}, {3.856095348385867*^9, 
   3.856095386023417*^9}, {3.856095497511677*^9, 3.8560955021683197`*^9}, {
   3.856095539138462*^9, 3.856095541847431*^9}, {3.856095620754245*^9, 
   3.856095766029916*^9}, {3.856096112813748*^9, 3.856096115573887*^9}, {
   3.856096181023514*^9, 3.856096234403102*^9}, {3.856096268808084*^9, 
   3.8560962714932537`*^9}, {3.856096400128194*^9, 3.856096413391214*^9}, {
   3.8560964895598783`*^9, 3.856096603346807*^9}, {3.856096637425585*^9, 
   3.856096666160739*^9}, {3.856096721972127*^9, 3.856096748101873*^9}, {
   3.856096786596134*^9, 3.856096847758301*^9}, {3.8560968803043528`*^9, 
   3.856096958880925*^9}, {3.8560970983324337`*^9, 3.856097108167601*^9}, {
   3.856097888599764*^9, 3.856097938410899*^9}, {3.8560979852947206`*^9, 
   3.856098407923976*^9}, {3.856098443322401*^9, 3.856098476740983*^9}, {
   3.856098511680262*^9, 3.8560985741691303`*^9}, {3.856098624371936*^9, 
   3.856098635540062*^9}, {3.856098667196188*^9, 3.85609869929595*^9}, {
   3.8560987687508087`*^9, 3.8560989732647257`*^9}, {3.856099012027525*^9, 
   3.8560990195374107`*^9}, {3.8560990558822813`*^9, 3.856099142954397*^9}, {
   3.85609920431684*^9, 3.856099248628282*^9}, 3.8560993842333517`*^9, {
   3.8560994832791357`*^9, 3.856099501899987*^9}, 3.856099601577779*^9, {
   3.8561486300526237`*^9, 3.856148760495685*^9}, {3.856148794656774*^9, 
   3.856148797363247*^9}, 3.856801738007601*^9, {3.8774967215367002`*^9, 
   3.8774967399652596`*^9}, {3.8774980657948265`*^9, 3.8774981362114534`*^9}, 
   3.8774981673074703`*^9, {3.877498197874149*^9, 3.8774982004180493`*^9}},
 CellLabel->
  "In[1281]:=",ExpressionUUID->"2c044381-35da-45f9-a9aa-57cd76ce607b"]
}, Open  ]],

Cell[CellGroupData[{

Cell["State-Based Switching", "Section",
 CellChangeTimes->{{3.856148583712235*^9, 
  3.8561485885664062`*^9}},ExpressionUUID->"06fdf6cf-f2fd-48e1-b516-\
2f06e0445cbb"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"\[Sigma]", "[", "q_", "]"}], " ", ":=", 
    RowBox[{
     RowBox[{"q", "\[LeftDoubleBracket]", "4", "\[RightDoubleBracket]"}], "+", 
     RowBox[{"0.5", 
      RowBox[{
      "q", "\[LeftDoubleBracket]", "5", "\[RightDoubleBracket]"}]}]}]}], 
   ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"be", "[", 
     RowBox[{
      RowBox[{"x_", "?", "VectorQ"}], ",", " ", 
      RowBox[{"c_", "?", "VectorQ"}]}], "]"}], " ", ":=", " ", 
    RowBox[{"Sin", "[", 
     RowBox[{
      RowBox[{"\[Sigma]", "[", "x", "]"}], "-", 
      RowBox[{"\[Sigma]", "[", "c", "]"}]}], "]"}]}], ";"}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{"for", " ", "simulation"}], " ", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"StateBasedSim", "[", 
    RowBox[{"p_", ",", " ", 
     RowBox[{"n_Integer", ":", "1"}]}], "]"}], " ", ":=", " ", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "Tc", ",", " ", "m", ",", " ", "x", ",", " ", "c", ",", " ", "DTsw", 
       ",", " ", "Tsw", ",", " ", "esw", ",", " ", "r"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"Print", "[", "\"\<This needs to be updated.\>\"", "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Throw", "@", "$Failed"}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"Tc", " ", "=", " ", 
       RowBox[{"p", "\[LeftDoubleBracket]", 
        RowBox[{"-", "1"}], "\[RightDoubleBracket]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"m", " ", "=", " ", 
       RowBox[{"BLbiped", "[", "\"\<m[0]\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"m", ",", " ", "x", ",", " ", "c"}], "}"}], " ", "=", " ", 
       RowBox[{"BLmxcp", "[", 
        RowBox[{"m", ",", " ", "p"}], "]"}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"esw", " ", "=", " ", 
       RowBox[{"{", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"WhenEvent", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"\[DoubleStruckT]", "-", "0"}], "\[Equal]", "0"}], ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{
              RowBox[{"\[DoubleStruckX]", "[", "\[DoubleStruckT]", "]"}], 
              "\[Rule]", 
              RowBox[{"HybridDynamics`Private`TF", "[", 
               RowBox[{
                RowBox[{"\[DoubleStruckM]", "[", "\[DoubleStruckT]", "]"}], 
                ",", 
                RowBox[{"\[DoubleStruckX]", "[", "\[DoubleStruckT]", "]"}], 
                ",", 
                RowBox[{"\[DoubleStruckC]", "[", "\[DoubleStruckT]", "]"}], 
                ",", "0"}], "]"}]}], ",", 
             RowBox[{
              RowBox[{"\[DoubleStruckM]", "[", "\[DoubleStruckT]", "]"}], 
              "\[Rule]", 
              RowBox[{"HybridDynamics`Private`m", "[", 
               RowBox[{
                RowBox[{"\[DoubleStruckM]", "[", "\[DoubleStruckT]", "]"}], 
                ",", 
                RowBox[{"\[DoubleStruckX]", "[", "\[DoubleStruckT]", "]"}], 
                ",", 
                RowBox[{"\[DoubleStruckC]", "[", "\[DoubleStruckT]", "]"}]}], 
               "]"}]}], ",", 
             RowBox[{
              RowBox[{"\[DoubleStruckX]", "[", "\[DoubleStruckT]", "]"}], 
              "\[Rule]", 
              RowBox[{"HybridDynamics`Private`h", "[", 
               RowBox[{
                RowBox[{"\[DoubleStruckM]", "[", "\[DoubleStruckT]", "]"}], 
                ",", 
                RowBox[{"\[DoubleStruckX]", "[", "\[DoubleStruckT]", "]"}], 
                ",", 
                RowBox[{"\[DoubleStruckC]", "[", "\[DoubleStruckT]", "]"}]}], 
               "]"}]}], ",", 
             RowBox[{
              RowBox[{"\[DoubleStruckC]", "[", "\[DoubleStruckT]", "]"}], 
              "\[Rule]", 
              RowBox[{"HybridDynamics`Private`d", "[", 
               RowBox[{
                RowBox[{"\[DoubleStruckM]", "[", "\[DoubleStruckT]", "]"}], 
                ",", 
                RowBox[{"\[DoubleStruckX]", "[", "\[DoubleStruckT]", "]"}], 
                ",", 
                RowBox[{"\[DoubleStruckC]", "[", "\[DoubleStruckT]", "]"}]}], 
               "]"}]}], ",", 
             RowBox[{
              RowBox[{"\[DoubleStruckX]", "[", "\[DoubleStruckT]", "]"}], 
              "\[Rule]", 
              RowBox[{"HybridDynamics`Private`T0", "[", 
               RowBox[{
                RowBox[{"\[DoubleStruckM]", "[", "\[DoubleStruckT]", "]"}], 
                ",", 
                RowBox[{"\[DoubleStruckX]", "[", "\[DoubleStruckT]", "]"}], 
                ",", 
                RowBox[{"\[DoubleStruckC]", "[", "\[DoubleStruckT]", "]"}], 
                ",", "0"}], "]"}]}], ",", "\"\<RemoveEvent\>\""}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"\"\<Priority\>\"", "\[Rule]", "1"}], "}"}]}], "]"}], ",",
          "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{"WhenEvent", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"be", "[", 
             RowBox[{
              RowBox[{"\[DoubleStruckX]", "[", "\[DoubleStruckT]", "]"}], ",",
               " ", 
              RowBox[{"\[DoubleStruckC]", "[", "\[DoubleStruckT]", "]"}]}], 
             "]"}], " ", ">", " ", "0"}], ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{
              RowBox[{"\[DoubleStruckX]", "[", "\[DoubleStruckT]", "]"}], 
              "\[Rule]", 
              RowBox[{"HybridDynamics`Private`TF", "[", 
               RowBox[{
                RowBox[{"\[DoubleStruckM]", "[", "\[DoubleStruckT]", "]"}], 
                ",", 
                RowBox[{"\[DoubleStruckX]", "[", "\[DoubleStruckT]", "]"}], 
                ",", 
                RowBox[{"\[DoubleStruckC]", "[", "\[DoubleStruckT]", "]"}], 
                ",", "0"}], "]"}]}], ",", 
             RowBox[{
              RowBox[{"\[DoubleStruckM]", "[", "\[DoubleStruckT]", "]"}], 
              "\[Rule]", 
              RowBox[{"HybridDynamics`Private`m", "[", 
               RowBox[{
                RowBox[{"\[DoubleStruckM]", "[", "\[DoubleStruckT]", "]"}], 
                ",", 
                RowBox[{"\[DoubleStruckX]", "[", "\[DoubleStruckT]", "]"}], 
                ",", 
                RowBox[{"\[DoubleStruckC]", "[", "\[DoubleStruckT]", "]"}]}], 
               "]"}]}], ",", 
             RowBox[{
              RowBox[{"\[DoubleStruckX]", "[", "\[DoubleStruckT]", "]"}], 
              "\[Rule]", 
              RowBox[{"HybridDynamics`Private`h", "[", 
               RowBox[{
                RowBox[{"\[DoubleStruckM]", "[", "\[DoubleStruckT]", "]"}], 
                ",", 
                RowBox[{"\[DoubleStruckX]", "[", "\[DoubleStruckT]", "]"}], 
                ",", 
                RowBox[{"\[DoubleStruckC]", "[", "\[DoubleStruckT]", "]"}]}], 
               "]"}]}], ",", 
             RowBox[{
              RowBox[{"\[DoubleStruckC]", "[", "\[DoubleStruckT]", "]"}], 
              "\[Rule]", 
              RowBox[{"HybridDynamics`Private`d", "[", 
               RowBox[{
                RowBox[{"\[DoubleStruckM]", "[", "\[DoubleStruckT]", "]"}], 
                ",", 
                RowBox[{"\[DoubleStruckX]", "[", "\[DoubleStruckT]", "]"}], 
                ",", 
                RowBox[{"\[DoubleStruckC]", "[", "\[DoubleStruckT]", "]"}]}], 
               "]"}]}], ",", 
             RowBox[{
              RowBox[{"\[DoubleStruckX]", "[", "\[DoubleStruckT]", "]"}], 
              "\[Rule]", 
              RowBox[{"HybridDynamics`Private`T0", "[", 
               RowBox[{
                RowBox[{"\[DoubleStruckM]", "[", "\[DoubleStruckT]", "]"}], 
                ",", 
                RowBox[{"\[DoubleStruckX]", "[", "\[DoubleStruckT]", "]"}], 
                ",", 
                RowBox[{"\[DoubleStruckC]", "[", "\[DoubleStruckT]", "]"}], 
                ",", "0"}], "]"}]}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"\"\<Priority\>\"", "\[Rule]", "2"}], "}"}]}], "]"}]}], 
        "\[IndentingNewLine]", "}"}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"\[CurlyPhi]", "[", 
       RowBox[{"m", ",", " ", "x", ",", " ", "c", ",", " ", 
        RowBox[{"{", 
         RowBox[{"0", ",", " ", 
          RowBox[{"n", " ", "Tc"}]}], "}"}], ",", " ", 
        RowBox[{"\"\<e\>\"", " ", "\[Rule]", " ", "esw"}]}], "]"}]}]}], 
    "\[IndentingNewLine]", "]"}]}], ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.85614882612796*^9, 3.8561488276236486`*^9}, 
   3.856148991603285*^9, {3.8802123039933777`*^9, 3.880212305079043*^9}},
 CellLabel->
  "In[1284]:=",ExpressionUUID->"cf168992-7212-4af1-9c73-c43781e391e8"]
}, Open  ]],

Cell[CellGroupData[{

Cell["End Package", "Section",
 InitializationCell->
  True,ExpressionUUID->"564581cb-f377-4c25-859c-a6fe1c88ee71"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"End", "[", "]"}], ";"}], "\n", 
 RowBox[{
  RowBox[{"EndPackage", "[", "]"}], ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{
  3.856621473315785*^9, 3.856632313486257*^9, {3.883584182224682*^9, 
   3.88358418249187*^9}},
 CellLabel->
  "In[1287]:=",ExpressionUUID->"60f58b77-9ae8-4a12-b3f6-c6cd30658ef0"]
}, Open  ]]
},
AutoGeneratedPackage->Automatic,
WindowSize->{766.8, 789.5999999999999},
WindowMargins->{{-4.8, Automatic}, {Automatic, 0}},
FrontEndVersion->"12.3 for Microsoft Windows (64-bit) (July 9, 2021)",
StyleDefinitions->"Default.nb",
ExpressionUUID->"8153625d-cf5f-45be-a8c7-de6fa97ea162"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 87, 0, 67, "Section",ExpressionUUID->"40d0816a-fa7f-4008-9d73-00e95e0ac4d3"],
Cell[670, 24, 6797, 149, 558, "Input",ExpressionUUID->"a3a7bad5-8560-44ad-8ff6-1f133d402706",
 InitializationCell->True],
Cell[CellGroupData[{
Cell[7492, 177, 170, 3, 54, "Subsection",ExpressionUUID->"0fc0648f-236c-473b-ba09-67dbd8378466"],
Cell[7665, 182, 2308, 50, 273, "Input",ExpressionUUID->"ed2ed2d1-2eab-46b4-a7fb-a1e5b4baa8ce",
 InitializationCell->True],
Cell[9976, 234, 1135, 32, 121, "Input",ExpressionUUID->"2fb20699-9b60-44eb-a329-8b1a8093b973",
 InitializationCell->True]
}, Open  ]],
Cell[CellGroupData[{
Cell[11148, 271, 165, 3, 54, "Subsection",ExpressionUUID->"b8f7fd57-fdb1-4608-88ad-96a9dbd57358"],
Cell[11316, 276, 5251, 122, 463, "Input",ExpressionUUID->"4149b298-a09d-49d7-9527-455e6527afa0",
 InitializationCell->True],
Cell[16570, 400, 3539, 87, 292, "Input",ExpressionUUID->"f517c87a-0035-49e4-928e-1068c7bcf286",
 InitializationCell->True],
Cell[20112, 489, 11329, 252, 863, "Input",ExpressionUUID->"4f5010dd-2c29-457d-bb81-73f412955b33",
 InitializationCell->True]
}, Open  ]],
Cell[CellGroupData[{
Cell[31478, 746, 225, 4, 54, "Subsection",ExpressionUUID->"a3135dd4-19de-478e-8c76-8d257af77188"],
Cell[31706, 752, 2570, 60, 178, "Input",ExpressionUUID->"e217c29e-fa28-4204-acf9-013e59f6123f",
 InitializationCell->True],
Cell[CellGroupData[{
Cell[34301, 816, 276, 4, 45, "Subsubsection",ExpressionUUID->"26c93218-f94e-491c-a984-d86e5ef6845c"],
Cell[34580, 822, 12116, 236, 616, "Input",ExpressionUUID->"b5d4582d-9c23-40d4-a4ce-c6341dcb8097",
 InitializationCell->True]
}, Open  ]],
Cell[CellGroupData[{
Cell[46733, 1063, 272, 4, 45, "Subsubsection",ExpressionUUID->"15499ed9-73ff-47c2-9a4b-dccbb90e892c"],
Cell[47008, 1069, 223, 5, 35, "Text",ExpressionUUID->"dd5959e9-8e4e-4024-9909-499216d8530e"],
Cell[47234, 1076, 1999, 48, 159, "Input",ExpressionUUID->"a66a4221-b087-486d-8743-e21226610c93",
 InitializationCell->True],
Cell[49236, 1126, 14964, 291, 806, "Input",ExpressionUUID->"62c8c578-abea-4d3c-8fcd-9793ff0d6020",
 InitializationCell->True],
Cell[64203, 1419, 9074, 199, 768, "Input",ExpressionUUID->"79daf6ca-e795-4ca2-888d-931c211b5630",
 InitializationCell->True],
Cell[73280, 1620, 191, 3, 35, "Text",ExpressionUUID->"e14340ba-8d25-46ab-873e-d757be768829"],
Cell[73474, 1625, 12912, 253, 673, "Input",ExpressionUUID->"1740d1b1-b4a6-45aa-a2a1-60258f70a1a0",
 InitializationCell->True],
Cell[86389, 1880, 10670, 213, 521, "Input",ExpressionUUID->"35035a4e-bc5a-4fe6-a56d-ff9fb67102c5",
 InitializationCell->True]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[97108, 2099, 265, 4, 54, "Subsection",ExpressionUUID->"ab68d62e-a30f-4a4d-a6ee-eac1cb7d9996"],
Cell[97376, 2105, 459, 11, 44, "Input",ExpressionUUID->"5794ce50-8ae5-475c-a4e8-c2cdafe10ad0",
 InitializationCell->True],
Cell[97838, 2118, 3182, 70, 273, "Input",ExpressionUUID->"846a2ceb-6e3b-4c90-8ea1-9e1c31850cf6",
 InitializationCell->True],
Cell[101023, 2190, 3981, 89, 368, "Input",ExpressionUUID->"153bfb7e-56b3-44d8-8a4b-b8e94bda4888",
 InitializationCell->True],
Cell[105007, 2281, 6867, 148, 655, "Input",ExpressionUUID->"bbfc96a7-93ae-4d2f-8d4d-e207352d184a",
 InitializationCell->True]
}, Open  ]],
Cell[CellGroupData[{
Cell[111911, 2434, 246, 4, 54, "Subsection",ExpressionUUID->"7e735c6b-c71d-40d5-9fb0-dd6a372436ed"],
Cell[112160, 2440, 370, 7, 58, "Text",ExpressionUUID->"4612356a-2d00-4e99-a741-ddedc60f8e74"],
Cell[112533, 2449, 16775, 336, 692, "Input",ExpressionUUID->"9c7c677a-9c04-46dc-bfe7-c9478582e369",
 InitializationCell->True],
Cell[129311, 2787, 14296, 274, 711, "Input",ExpressionUUID->"2ea79c48-8fbd-4c25-981c-ef1e72d19956",
 InitializationCell->True],
Cell[143610, 3063, 32323, 711, 1985, "Input",ExpressionUUID->"c160949f-feac-4016-a2cb-34fe03beeac3",
 InitializationCell->True],
Cell[175936, 3776, 12332, 295, 996, "Input",ExpressionUUID->"f82b5aaa-8b6c-4d1f-8bc0-6301e28d411f",
 InitializationCell->True],
Cell[188271, 4073, 8899, 148, 178, "Input",ExpressionUUID->"e12de8eb-0da3-4c1a-81c7-93e216e4d848",
 InitializationCell->True],
Cell[197173, 4223, 522, 13, 44, "Input",ExpressionUUID->"07f55560-62c0-4000-a4fc-8d1661f661ea",
 InitializationCell->True]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[197744, 4242, 93, 0, 67, "Section",ExpressionUUID->"841205bc-bd4c-4ab1-a9b6-40ad4da3db48"],
Cell[197840, 4244, 12001, 267, 1091, "Input",ExpressionUUID->"2c044381-35da-45f9-a9aa-57cd76ce607b",
 InitializationCell->True]
}, Open  ]],
Cell[CellGroupData[{
Cell[209878, 4516, 168, 3, 67, "Section",ExpressionUUID->"06fdf6cf-f2fd-48e1-b516-2f06e0445cbb"],
Cell[210049, 4521, 8854, 203, 616, "Input",ExpressionUUID->"cf168992-7212-4af1-9c73-c43781e391e8",
 InitializationCell->True]
}, Open  ]],
Cell[CellGroupData[{
Cell[218940, 4729, 115, 2, 67, "Section",ExpressionUUID->"564581cb-f377-4c25-859c-a6fe1c88ee71",
 InitializationCell->True],
Cell[219058, 4733, 358, 10, 64, "Input",ExpressionUUID->"60f58b77-9ae8-4a12-b3f6-c6cd30658ef0",
 InitializationCell->True]
}, Open  ]]
}
]
*)

