(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 11.3' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     51590,       1036]
NotebookOptionsPosition[     48819,        973]
NotebookOutlinePosition[     49264,        990]
CellTagsIndexPosition[     49221,        987]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData[
 RowBox[{"(*", "\n", 
  RowBox[{
   RowBox[{"Armijo", ".", 
    RowBox[{"nb", ":", " ", 
     RowBox[{
     "An", " ", "implementation", " ", "of", " ", "various", " ", "line", " ",
       "search", " ", 
      RowBox[{"methods", ".", "\n", "Copyright"}], " ", 
      RowBox[{"(", "C", ")"}], " ", "2021", " ", "Nelson", " ", "Rosa", " ", 
      RowBox[{"Jr", ".", "\n", "\n", "This"}], " ", "program", " ", "is", " ",
       "free", " ", "software"}], ":", " ", 
     RowBox[{"you", " ", "can", " ", "redistribute", " ", "it", " ", 
      RowBox[{"and", "/", "or"}], " ", "modify", "\n", "it", " ", "under", 
      " ", "the", " ", "terms", " ", "of", " ", "the", " ", "GNU", " ", 
      "General", " ", "Public", " ", "License", " ", "as", " ", "published", 
      " ", "by", "\n", 
      RowBox[{"the", " ", "Free", " ", "Software", " ", "Foundation"}]}]}]}], 
   ",", " ", 
   RowBox[{
   "either", " ", "version", " ", "3", " ", "of", " ", "the", " ", 
    "License"}], ",", " ", 
   RowBox[{"or", "\n", 
    RowBox[{"(", 
     RowBox[{"at", " ", "your", " ", "option"}], ")"}], " ", "any", " ", 
    "later", " ", 
    RowBox[{"version", ".", " ", "This"}], " ", "program", " ", "is", " ", 
    "distributed", " ", "in", " ", "the", " ", "\n", "hope", " ", "that", " ",
     "it", " ", "will", " ", "be", " ", "useful"}], ",", " ", 
   RowBox[{
    RowBox[{"but", " ", "WITHOUT", " ", "ANY", " ", "WARRANTY"}], ";", " ", 
    RowBox[{
    "without", " ", "even", " ", "the", " ", "\n", "implied", " ", "warranty",
      " ", "of", " ", "MERCHANTABILITY", " ", "or", " ", "FITNESS", " ", 
     "FOR", " ", "A", " ", "PARTICULAR", " ", 
     RowBox[{"PURPOSE", ".", "\n", "See"}], " ", "the", " ", "GNU", " ", 
     "General", " ", "Public", " ", "License", " ", "for", " ", "more", " ", 
     RowBox[{"details", ".", " ", "You"}], " ", "should", " ", "have", " ", 
     "\n", "received", " ", "a", " ", "copy", " ", "of", " ", "the", " ", 
     "GNU", " ", "General", " ", "Public", " ", "License", " ", "along", " ", 
     "with", " ", "this", " ", 
     RowBox[{"program", ".", "\n", "If"}], " ", "not"}]}], ",", " ", 
   RowBox[{
    RowBox[{"see", " ", "<", 
     RowBox[{"http", ":"}]}], "//", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"www", ".", "gnu", ".", "org"}], "/", "licenses"}], "/"}], ">",
      "."}]}]}], "\n", "*)"}]], "Code",
 InitializationCell->True,
 CellChangeTimes->{{3.849880715957052*^9, 3.849880733557252*^9}, 
   3.849886471370816*^9, 3.849886514639223*^9, 
   3.8498978183641253`*^9},ExpressionUUID->"1d6d73e4-c217-48bc-a17f-\
2dfb09dcda35"],

Cell["\<\
[1] Iterative Methods for Optimization
https://archive.siam.org/books/textbooks/fr18_book.pdf\
\>", "Text",
 CellChangeTimes->{{3.84988059325391*^9, 3.849880685177847*^9}, {
  3.849880751928732*^9, 3.849880756857348*^9}, {3.849883937780849*^9, 
  3.849883941222303*^9}, {3.849897826944785*^9, 3.849897833609356*^9}, {
  3.849900049724928*^9, 
  3.849900062717986*^9}},ExpressionUUID->"5c35d829-3669-43fe-bb18-\
c6fb2216ddc1"],

Cell[CellGroupData[{

Cell["Begin Package", "Section",
 InitializationCell->
  True,ExpressionUUID->"fc54ff8f-4e73-4132-9730-f91f80506212"],

Cell[BoxData[{
 RowBox[{"BeginPackage", "[", "\"\<ContinuationMethods`\>\"", 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"Begin", "[", "\"\<`Private`\>\"", "]"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{
  3.849883758539238*^9, {3.849883907606049*^9, 3.8498839077671432`*^9}, 
   3.849886588958394*^9, 3.849887205106814*^9, 3.849887235322166*^9, {
   3.849887303568693*^9, 3.849887305077107*^9}, 3.849887458983571*^9, 
   3.84988750292159*^9},
 CellLabel->"In[6]:=",ExpressionUUID->"cb6c0dbe-4431-4f14-9f39-fe2a620f6c37"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Armijo Line Search Method", "Section",
 InitializationCell->True,
 CellChangeTimes->{{3.849883779678125*^9, 3.8498837959905777`*^9}, 
   3.849883862441671*^9, 
   3.849900070103587*^9},ExpressionUUID->"c85da61e-5377-4f27-b2d3-\
a8be43386bc2"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"Options", "[", "Armijo", "]"}], " ", "=", " ", 
   RowBox[{"{", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"\"\<\[Alpha]\>\"", " ", "\[Rule]", " ", 
      RowBox[{"10.0", "^", 
       RowBox[{"-", "4"}]}]}], ",", " ", "\[IndentingNewLine]", 
     RowBox[{"\"\<stp\>\"", " ", "\[Rule]", " ", "0.5"}], ",", " ", 
     RowBox[{"(*", " ", "\[Beta]", " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{"\"\<m0\>\"", " ", "\[Rule]", " ", "0"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"\"\<mf\>\"", " ", "\[Rule]", " ", "30"}]}], 
    "\[IndentingNewLine]", "}"}]}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.849883883686223*^9, 3.849883903991733*^9}, {
   3.849883990310281*^9, 3.849884029429226*^9}, {3.84988512938907*^9, 
   3.849885236228321*^9}, {3.8498852891303453`*^9, 3.849885475415247*^9}, {
   3.8498855104261017`*^9, 3.8498856064501953`*^9}, 3.849885703814837*^9, {
   3.849886210698452*^9, 3.849886215788946*^9}, 3.849886356601389*^9, 
   3.84988647137223*^9, 3.849897818366514*^9, 3.849897853391323*^9, {
   3.849898865715095*^9, 3.84989889067216*^9}, {3.8498989237028923`*^9, 
   3.8498989577740993`*^9}, {3.8499011071422977`*^9, 3.849901107269682*^9}, 
   3.849901145166109*^9, 3.849901308732706*^9, {3.850190594608142*^9, 
   3.85019063699409*^9}, {3.850244124883247*^9, 3.850244125395914*^9}, {
   3.850254530888443*^9, 3.850254535103972*^9}, {3.8777952445257177`*^9, 
   3.8777952446708636`*^9}},ExpressionUUID->"3e35e74f-9e43-420a-966b-\
1de9c2f4a3f8"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"Armijo", "::", "args"}], " ", "=", " ", 
   "\"\<Improper input parameters: ``\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Armijo", "::", "ls"}], " ", "=", " ", 
   "\"\<Cannot find sufficient decrease for m \[Element] [``, ``].\>\""}], 
  ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.849883883686223*^9, 3.849883903991733*^9}, {
   3.849883990310281*^9, 3.849884029429226*^9}, {3.84988512938907*^9, 
   3.849885236228321*^9}, {3.8498852891303453`*^9, 3.849885475415247*^9}, {
   3.8498855104261017`*^9, 3.8498856064501953`*^9}, {3.849885703814837*^9, 
   3.84988570700117*^9}, {3.849885942877324*^9, 3.849885944949101*^9}, {
   3.849886471373432*^9, 3.849886471380275*^9}, {3.849897818368424*^9, 
   3.849897818371798*^9}, {3.849898738531403*^9, 3.8498987959224863`*^9}, {
   3.849900674625224*^9, 3.8499006825792503`*^9}, 3.850220346324873*^9, {
   3.850220458995984*^9, 3.8502204595942*^9}, {3.8502205335295343`*^9, 
   3.850220534656258*^9}},ExpressionUUID->"b4b6046b-f382-4c77-abc0-\
a96d564f6dab"],

Cell[CellGroupData[{

Cell["Initialization Step", "Subsection",
 InitializationCell->True,
 CellChangeTimes->{{3.849883779678125*^9, 3.8498837959905777`*^9}, 
   3.849883862441671*^9, 3.849900070103587*^9, {3.850220544920982*^9, 
   3.850220549974633*^9}},ExpressionUUID->"5b093abc-2e2c-4e76-a397-\
46e49cd4a0fd"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"Armijo", "[", 
    RowBox[{"fg0_", ",", " ", "s0_", ",", " ", 
     RowBox[{"{", "}"}], ",", " ", 
     RowBox[{"OptionsPattern", "[", "]"}]}], "]"}], " ", ":=", " ", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "\[Alpha]", ",", " ", "\[Beta]", ",", " ", "m0", ",", " ", "mf", ",", 
       " ", "g0", ",", " ", "info", ",", " ", "d", ",", " ", "stp"}], "}"}], 
     ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"\[Alpha]", " ", "=", " ", 
       RowBox[{"OptionValue", "[", "\"\<\[Alpha]\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"\[Beta]", " ", "=", " ", 
       RowBox[{"OptionValue", "[", "\"\<stp\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"m0", " ", "=", " ", 
       RowBox[{"OptionValue", "[", "\"\<m0\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"mf", " ", "=", " ", 
       RowBox[{"OptionValue", "[", "\"\<mf\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"\[Alpha]", " ", "<", " ", "0"}], " ", "||", " ", 
         RowBox[{"\[Alpha]", " ", ">", " ", "1"}], " ", "||", " ", 
         RowBox[{"\[Beta]", " ", "<", " ", "0"}], " ", "||", " ", 
         RowBox[{"\[Beta]", " ", ">", " ", "1"}], " ", "||", " ", 
         RowBox[{"mf", " ", "<", " ", "m0"}]}], ",", " ", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"Message", "[", 
          RowBox[{
           RowBox[{"Armijo", "::", "args"}], ",", " ", 
           "\"\<\[Alpha], stp, m0, or mf is invalid.\>\""}], "]"}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"Throw", "@", "$Failed"}], ";"}]}], "\[IndentingNewLine]", 
       "]"}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"g0", " ", "=", " ", 
       RowBox[{
       "fg0", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"g0", ".", "s0"}], " ", "\[GreaterEqual]", " ", "0"}], ",", 
        " ", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"Message", "[", 
          RowBox[{
           RowBox[{"Armijo", "::", "args"}], ",", " ", 
           "\"\<Not a descent direction.\>\""}], "]"}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"Throw", "@", "$Failed"}], ";"}]}], "\[IndentingNewLine]", 
       "]"}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"info", " ", "=", " ", "0"}], ";", "\[IndentingNewLine]", 
      RowBox[{"stp", " ", "=", " ", 
       RowBox[{"\[Beta]", "^", "m0"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"d", " ", "=", " ", 
       RowBox[{"stp", " ", "s0"}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{
       "d", ",", " ", "info", ",", " ", "stp", ",", " ", "m0", ",", " ", 
        RowBox[{"fg0", "\[LeftDoubleBracket]", 
         RowBox[{"1", ";;", "2"}], "\[RightDoubleBracket]"}], ",", " ", 
        "\[Alpha]", ",", " ", "\[Beta]", ",", " ", "m0", ",", " ", "mf"}], 
       "}"}]}]}], "\[IndentingNewLine]", "]"}]}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.849883883686223*^9, 3.849883903991733*^9}, {
   3.849883990310281*^9, 3.849884029429226*^9}, {3.84988512938907*^9, 
   3.849885236228321*^9}, {3.8498852891303453`*^9, 3.849885475415247*^9}, {
   3.8498855104261017`*^9, 3.8498856064501953`*^9}, {3.849885703814837*^9, 
   3.84988570700117*^9}, {3.8498859152593107`*^9, 3.849885975818481*^9}, {
   3.849886083404541*^9, 3.849886094886197*^9}, {3.8498862265779953`*^9, 
   3.849886257749495*^9}, {3.849886288252227*^9, 3.849886339605171*^9}, {
   3.849886471386203*^9, 3.849886471416864*^9}, {3.8498865020425386`*^9, 
   3.849886502046814*^9}, {3.849888115369492*^9, 3.8498881212463837`*^9}, {
   3.8498881854888983`*^9, 3.8498881933041697`*^9}, {3.849889773207582*^9, 
   3.849889783157937*^9}, {3.849890009657136*^9, 3.849890071073757*^9}, {
   3.849890148170649*^9, 3.849890162698823*^9}, {3.8498902115768137`*^9, 
   3.849890249513049*^9}, {3.849890290386085*^9, 3.849890290728149*^9}, {
   3.849890332153256*^9, 3.849890338905616*^9}, {3.8498918470369177`*^9, 
   3.8498918777336197`*^9}, {3.849893003500836*^9, 3.8498930037974777`*^9}, {
   3.84989651186967*^9, 3.849896549670246*^9}, {3.849896615406604*^9, 
   3.849896627096457*^9}, {3.8498969055451527`*^9, 3.849896918706279*^9}, {
   3.849897656313829*^9, 3.849897657043894*^9}, {3.8498978183775263`*^9, 
   3.8498978184055433`*^9}, 3.849897967403721*^9, {3.849898000899973*^9, 
   3.849898020772238*^9}, 3.849898070674271*^9, {3.84989813275097*^9, 
   3.849898257994688*^9}, {3.849898319397675*^9, 3.849898523843079*^9}, {
   3.849898593860539*^9, 3.849898652780731*^9}, {3.849898695538267*^9, 
   3.8498987534900637`*^9}, {3.8498988227140408`*^9, 
   3.8498988228731327`*^9}, {3.849898964585394*^9, 3.84989899680295*^9}, {
   3.84989909734743*^9, 3.849899102610282*^9}, {3.849900223407037*^9, 
   3.8499002355611467`*^9}, {3.849900285077807*^9, 3.8499002853984213`*^9}, {
   3.849900658534374*^9, 3.849900663203487*^9}, {3.849900693343431*^9, 
   3.849900867341629*^9}, {3.849901008745695*^9, 3.849901010833774*^9}, {
   3.849901226387755*^9, 3.8499012848565407`*^9}, {3.8501877611447897`*^9, 
   3.8501877626783533`*^9}, {3.850187794310369*^9, 3.850187797058967*^9}, {
   3.850187971532555*^9, 3.850187971778294*^9}, {3.850188105993477*^9, 
   3.850188106310652*^9}, 3.850188723848126*^9, {3.8501901490570517`*^9, 
   3.850190266886951*^9}, {3.850190312370481*^9, 3.850190312742819*^9}, {
   3.8501903455768967`*^9, 3.850190367929468*^9}, {3.850190447399701*^9, 
   3.85019044772609*^9}, {3.850190514645327*^9, 3.850190524560926*^9}, {
   3.850190621099559*^9, 3.8501906288271217`*^9}, {3.850190678903104*^9, 
   3.850190732118621*^9}, {3.85019083752456*^9, 3.850190859371907*^9}, {
   3.8502018974968576`*^9, 3.8502019090683527`*^9}, 3.8502022846552067`*^9, {
   3.850203282875722*^9, 3.8502032955364027`*^9}, {3.850203326975368*^9, 
   3.850203448220153*^9}, {3.850203478863791*^9, 3.850203553998301*^9}, {
   3.850203585832535*^9, 3.850203601151716*^9}, {3.8502036588889847`*^9, 
   3.850203775522278*^9}, {3.850210776343657*^9, 3.850210917935104*^9}, {
   3.850211011807682*^9, 3.850211071599354*^9}, {3.8502111183118553`*^9, 
   3.8502111474833317`*^9}, {3.8502111822793694`*^9, 3.850211248898653*^9}, {
   3.850211282970985*^9, 3.850211362935656*^9}, {3.850211404707819*^9, 
   3.8502115128029623`*^9}, {3.8502115875396137`*^9, 3.850211652009069*^9}, {
   3.850211764537643*^9, 3.850211790084629*^9}, {3.850211856103869*^9, 
   3.850211889222829*^9}, {3.8502119647145042`*^9, 3.850212044960536*^9}, {
   3.8502121206839314`*^9, 3.850212170559271*^9}, {3.850212252852206*^9, 
   3.85021226098065*^9}, {3.8502123285490017`*^9, 3.850212353139617*^9}, {
   3.850212553563616*^9, 3.8502129840625668`*^9}, {3.850213053984758*^9, 
   3.8502130707479773`*^9}, {3.850213115017226*^9, 3.850213134544263*^9}, 
   3.850213170740856*^9, {3.8502132103839407`*^9, 3.8502132652898893`*^9}, {
   3.850213327360141*^9, 3.850213533064781*^9}, {3.850213855377468*^9, 
   3.85021385725352*^9}, {3.850213925177062*^9, 3.850213926774436*^9}, {
   3.8502140127738647`*^9, 3.8502140435476*^9}, {3.850214076406708*^9, 
   3.8502140806631804`*^9}, 3.850214219177698*^9, {3.850214276715335*^9, 
   3.850214305982933*^9}, {3.850214452679237*^9, 3.850214472520512*^9}, {
   3.850214669803694*^9, 3.8502146750504017`*^9}, 3.8502147282179337`*^9, {
   3.850214786856104*^9, 3.85021480654996*^9}, {3.8502148501351147`*^9, 
   3.8502148854881907`*^9}, {3.850215087004587*^9, 3.8502151090669813`*^9}, {
   3.850215183403537*^9, 3.8502151844407253`*^9}, {3.850215244541395*^9, 
   3.8502153331119432`*^9}, {3.8502154276682377`*^9, 
   3.8502154797337837`*^9}, {3.8502156487034388`*^9, 3.850215692041066*^9}, {
   3.8502157357170067`*^9, 3.8502157938134937`*^9}, {3.850215846529169*^9, 
   3.850215856786344*^9}, {3.850216034541939*^9, 3.850216049119419*^9}, {
   3.8502161120634527`*^9, 3.85021613226826*^9}, {3.850216278770792*^9, 
   3.8502162792130823`*^9}, {3.8502163385247097`*^9, 3.850216354605132*^9}, {
   3.850216423212851*^9, 3.8502164257582827`*^9}, {3.8502164948247766`*^9, 
   3.8502164970782948`*^9}, {3.8502187056889677`*^9, 3.85021880656487*^9}, {
   3.850218880979349*^9, 3.850218881312354*^9}, {3.850219334462803*^9, 
   3.850219376583309*^9}, {3.850219417255205*^9, 3.850219417846622*^9}, {
   3.85021946016733*^9, 3.850219463511969*^9}, {3.850219522160203*^9, 
   3.850219572290457*^9}, {3.850219607082685*^9, 3.850219633967608*^9}, {
   3.850219729487042*^9, 3.850219732249528*^9}, {3.8502198986121683`*^9, 
   3.850219978947701*^9}, {3.850220105597341*^9, 3.850220133826077*^9}, {
   3.8502202901190367`*^9, 3.850220292491796*^9}, {3.850220356214766*^9, 
   3.850220373406554*^9}, 3.8502204138723497`*^9, 3.850220445616905*^9, {
   3.850220515188547*^9, 3.8502205184700413`*^9}, {3.850220787393147*^9, 
   3.850220808319207*^9}, 
   3.850225292961883*^9},ExpressionUUID->"fa07d37d-66e0-49bc-8b09-\
34820865c60d"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Next Step", "Subsection",
 InitializationCell->True,
 CellChangeTimes->{{3.849883779678125*^9, 3.8498837959905777`*^9}, 
   3.849883862441671*^9, 3.849900070103587*^9, {3.850220544920982*^9, 
   3.850220571681183*^9}},ExpressionUUID->"f41536ae-645d-452a-b5d5-\
0a9ab63e8f51"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"Armijo", "[", 
    RowBox[{"fg_", ",", " ", "s0_", ",", " ", "data_", ",", " ", 
     RowBox[{"OptionsPattern", "[", "]"}]}], "]"}], " ", ":=", " ", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "m", ",", " ", "\[Alpha]", ",", " ", "\[Beta]", ",", " ", "d", ",", " ",
        "m0", ",", " ", "mf", ",", " ", "f", ",", " ", "f0", ",", " ", "g0", 
       ",", " ", "a", ",", " ", "stp", ",", " ", "info"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"info", " ", "=", " ", "0"}], ";", "\[IndentingNewLine]", 
      RowBox[{"f", " ", "=", " ", 
       RowBox[{"fg", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}],
       ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "d", ",", " ", "info", ",", " ", "stp", ",", " ", "m", ",", " ", 
         RowBox[{"{", 
          RowBox[{"f0", ",", " ", "g0"}], "}"}], ",", " ", "\[Alpha]", ",", 
         " ", "\[Beta]", ",", " ", "m0", ",", " ", "mf"}], "}"}], " ", "=", 
       " ", "data"}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"m", " ", "\[GreaterEqual]", " ", "mf"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{"max", " ", "iterations"}], " ", "*)"}], 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"info", " ", "=", " ", "3"}], ";", "\[IndentingNewLine]", 
         RowBox[{"Message", "[", 
          RowBox[{
           RowBox[{"Armijo", "::", "ls"}], ",", " ", "m0", ",", " ", "mf"}], 
          "]"}], ";"}]}], " ", "\[IndentingNewLine]", "]"}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"f", " ", "-", " ", "f0"}], " ", "\[LessEqual]", " ", 
         RowBox[{"\[Alpha]", " ", 
          RowBox[{"g0", ".", "d"}]}]}], ",", " ", "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{"sufficient", " ", "decrease", " ", "found"}], " ", "*)"}], 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"info", " ", "=", " ", "1"}], ";"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{"else", " ", 
          RowBox[{"(", 
           RowBox[{"try", " ", "new", " ", "x"}], ")"}]}], " ", "*)"}], 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"m", " ", "=", " ", 
          RowBox[{"m", " ", "+", " ", "1"}]}], ";"}]}], "\[IndentingNewLine]",
        "]"}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"stp", " ", "=", " ", 
       RowBox[{"\[Beta]", "^", "m"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"d", " ", "=", " ", 
       RowBox[{"stp", " ", "s0"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{
       "d", ",", " ", "info", ",", " ", "stp", ",", " ", "m", ",", " ", 
        RowBox[{"{", 
         RowBox[{"f0", ",", " ", "g0"}], "}"}], ",", " ", "\[Alpha]", ",", 
        " ", "\[Beta]", ",", " ", "m0", ",", " ", "mf"}], "}"}]}]}], 
    "\[IndentingNewLine]", "]"}]}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.849883883686223*^9, 3.849883903991733*^9}, {
   3.849883990310281*^9, 3.849884029429226*^9}, {3.84988512938907*^9, 
   3.849885236228321*^9}, {3.8498852891303453`*^9, 3.849885475415247*^9}, {
   3.8498855104261017`*^9, 3.8498856064501953`*^9}, {3.849885703814837*^9, 
   3.84988570700117*^9}, {3.8498859152593107`*^9, 3.849885975818481*^9}, {
   3.849886083404541*^9, 3.849886094886197*^9}, {3.8498862265779953`*^9, 
   3.849886257749495*^9}, {3.849886288252227*^9, 3.849886339605171*^9}, {
   3.849886471386203*^9, 3.849886471416864*^9}, {3.8498865020425386`*^9, 
   3.849886502046814*^9}, {3.849888115369492*^9, 3.8498881212463837`*^9}, {
   3.8498881854888983`*^9, 3.8498881933041697`*^9}, {3.849889773207582*^9, 
   3.849889783157937*^9}, {3.849890009657136*^9, 3.849890071073757*^9}, {
   3.849890148170649*^9, 3.849890162698823*^9}, {3.8498902115768137`*^9, 
   3.849890249513049*^9}, {3.849890290386085*^9, 3.849890290728149*^9}, {
   3.849890332153256*^9, 3.849890338905616*^9}, {3.8498918470369177`*^9, 
   3.8498918777336197`*^9}, {3.849893003500836*^9, 3.8498930037974777`*^9}, {
   3.84989651186967*^9, 3.849896549670246*^9}, {3.849896615406604*^9, 
   3.849896627096457*^9}, {3.8498969055451527`*^9, 3.849896918706279*^9}, {
   3.849897656313829*^9, 3.849897657043894*^9}, {3.8498978183775263`*^9, 
   3.8498978184055433`*^9}, 3.849897967403721*^9, {3.849898000899973*^9, 
   3.849898020772238*^9}, 3.849898070674271*^9, {3.84989813275097*^9, 
   3.849898257994688*^9}, {3.849898319397675*^9, 3.849898523843079*^9}, {
   3.849898593860539*^9, 3.849898652780731*^9}, {3.849898695538267*^9, 
   3.8498987534900637`*^9}, {3.8498988227140408`*^9, 
   3.8498988228731327`*^9}, {3.849898964585394*^9, 3.84989899680295*^9}, {
   3.84989909734743*^9, 3.849899102610282*^9}, {3.849900223407037*^9, 
   3.8499002355611467`*^9}, {3.849900285077807*^9, 3.8499002853984213`*^9}, {
   3.849900658534374*^9, 3.849900663203487*^9}, {3.849900693343431*^9, 
   3.849900867341629*^9}, {3.849901008745695*^9, 3.849901010833774*^9}, {
   3.849901226387755*^9, 3.8499012848565407`*^9}, {3.8501877611447897`*^9, 
   3.8501877626783533`*^9}, {3.850187794310369*^9, 3.850187797058967*^9}, {
   3.850187971532555*^9, 3.850187971778294*^9}, {3.850188105993477*^9, 
   3.850188106310652*^9}, 3.850188723848126*^9, {3.8501901490570517`*^9, 
   3.850190266886951*^9}, {3.850190312370481*^9, 3.850190312742819*^9}, {
   3.8501903455768967`*^9, 3.850190367929468*^9}, {3.850190447399701*^9, 
   3.85019044772609*^9}, {3.850190514645327*^9, 3.850190524560926*^9}, {
   3.850190621099559*^9, 3.8501906288271217`*^9}, {3.850190678903104*^9, 
   3.850190732118621*^9}, {3.85019083752456*^9, 3.850190859371907*^9}, {
   3.8502018974968576`*^9, 3.8502019090683527`*^9}, 3.8502022846552067`*^9, {
   3.850203282875722*^9, 3.8502032955364027`*^9}, {3.850203326975368*^9, 
   3.850203448220153*^9}, {3.850203478863791*^9, 3.850203553998301*^9}, {
   3.850203585832535*^9, 3.850203601151716*^9}, {3.8502036588889847`*^9, 
   3.850203775522278*^9}, {3.850210776343657*^9, 3.850210917935104*^9}, {
   3.850211011807682*^9, 3.850211071599354*^9}, {3.8502111183118553`*^9, 
   3.8502111474833317`*^9}, {3.8502111822793694`*^9, 3.850211248898653*^9}, {
   3.850211282970985*^9, 3.850211362935656*^9}, {3.850211404707819*^9, 
   3.8502115128029623`*^9}, {3.8502115875396137`*^9, 3.850211652009069*^9}, {
   3.850211764537643*^9, 3.850211790084629*^9}, {3.850211856103869*^9, 
   3.850211889222829*^9}, {3.8502119647145042`*^9, 3.850212044960536*^9}, {
   3.8502121206839314`*^9, 3.850212170559271*^9}, {3.850212252852206*^9, 
   3.85021226098065*^9}, {3.8502123285490017`*^9, 3.850212353139617*^9}, {
   3.850212553563616*^9, 3.8502129840625668`*^9}, {3.850213053984758*^9, 
   3.8502130707479773`*^9}, {3.850213115017226*^9, 3.850213134544263*^9}, 
   3.850213170740856*^9, {3.8502132103839407`*^9, 3.8502132652898893`*^9}, {
   3.850213327360141*^9, 3.850213533064781*^9}, {3.850213855377468*^9, 
   3.85021385725352*^9}, {3.850213925177062*^9, 3.850213926774436*^9}, {
   3.8502140127738647`*^9, 3.8502140435476*^9}, {3.850214076406708*^9, 
   3.8502140806631804`*^9}, 3.850214219177698*^9, {3.850214276715335*^9, 
   3.850214305982933*^9}, {3.850214452679237*^9, 3.850214472520512*^9}, {
   3.850214669803694*^9, 3.8502146750504017`*^9}, 3.8502147282179337`*^9, {
   3.850214786856104*^9, 3.85021480654996*^9}, {3.8502148501351147`*^9, 
   3.8502148854881907`*^9}, {3.850215087004587*^9, 3.8502151090669813`*^9}, {
   3.850215183403537*^9, 3.8502151844407253`*^9}, {3.850215244541395*^9, 
   3.8502153331119432`*^9}, {3.8502154276682377`*^9, 
   3.8502154797337837`*^9}, {3.8502156487034388`*^9, 3.850215692041066*^9}, {
   3.8502157357170067`*^9, 3.8502157938134937`*^9}, {3.850215846529169*^9, 
   3.850215856786344*^9}, {3.850216034541939*^9, 3.850216049119419*^9}, {
   3.8502161120634527`*^9, 3.85021613226826*^9}, {3.850216278770792*^9, 
   3.8502162792130823`*^9}, {3.8502163385247097`*^9, 3.850216354605132*^9}, {
   3.850216423212851*^9, 3.8502164257582827`*^9}, {3.8502164948247766`*^9, 
   3.8502164970782948`*^9}, {3.8502187056889677`*^9, 3.85021880656487*^9}, {
   3.850218880979349*^9, 3.850218881312354*^9}, {3.850219334462803*^9, 
   3.850219376583309*^9}, {3.850219417255205*^9, 3.850219417846622*^9}, {
   3.85021946016733*^9, 3.850219463511969*^9}, {3.850219522160203*^9, 
   3.850219572290457*^9}, {3.850219607082685*^9, 3.850219633967608*^9}, {
   3.850219729487042*^9, 3.850219732249528*^9}, {3.8502198986121683`*^9, 
   3.850219978947701*^9}, {3.850220105597341*^9, 3.850220133826077*^9}, {
   3.8502202901190367`*^9, 3.850220292491796*^9}, {3.850220356214766*^9, 
   3.850220373406554*^9}, 3.8502204138723497`*^9, 3.850220445616905*^9, 
   3.850220515188547*^9, 3.850220740531149*^9, {3.850225202088904*^9, 
   3.850225214051486*^9}, 3.8502252669282217`*^9, {3.850244486330001*^9, 
   3.850244523055963*^9}, {3.850247206577208*^9, 3.850247208784093*^9}, {
   3.850249876282971*^9, 3.850249876794753*^9}, {3.850249911515575*^9, 
   3.850249921490973*^9}, {3.8502502543250647`*^9, 
   3.850250254894425*^9}},ExpressionUUID->"097ae072-31e3-4586-8ba2-\
ff1ae9ff03e6"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Driver", "Subsection",
 InitializationCell->True,
 CellChangeTimes->{{3.849883779678125*^9, 3.8498837959905777`*^9}, 
   3.849883862441671*^9, 3.849900070103587*^9, {3.850220544920982*^9, 
   3.850220583167783*^9}},ExpressionUUID->"087f367a-c755-4eae-bc84-\
ad3b3fa08c25"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"ArmijoDriver", "[", 
    RowBox[{
    "fcn_", ",", " ", "x0_", ",", " ", "fg0_", ",", " ", "s0_", ",", " ", 
     RowBox[{"opts", ":", 
      RowBox[{"OptionsPattern", "[", "Armijo", "]"}]}]}], "]"}], " ", ":=", 
   " ", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "d", ",", " ", "info", ",", " ", "stp", ",", " ", "data", ",", " ", 
       "fg", ",", " ", "nfev"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"info", " ", "=", " ", "0"}], ";", "\[IndentingNewLine]", 
      RowBox[{"nfev", " ", "=", " ", "0"}], ";", "\[IndentingNewLine]", 
      RowBox[{"data", " ", "=", " ", 
       RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"fg", " ", "=", " ", "fg0"}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"While", "[", 
       RowBox[{"True", ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"data", " ", "=", " ", 
          RowBox[{"Armijo", "[", 
           RowBox[{"fg", ",", " ", "s0", ",", " ", "data", ",", " ", "opts"}],
            "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"d", ",", " ", "info", ",", " ", "stp"}], "}"}], " ", "=", 
          " ", 
          RowBox[{"data", "\[LeftDoubleBracket]", 
           RowBox[{"1", ";;", "3"}], "\[RightDoubleBracket]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"info", " ", "\[NotEqual]", " ", "0"}], ",", " ", 
           RowBox[{"Break", "[", "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
         RowBox[{"fg", " ", "=", " ", 
          RowBox[{
           RowBox[{"fcn", "[", 
            RowBox[{"x0", " ", "+", " ", "d"}], "]"}], "\[LeftDoubleBracket]", 
           RowBox[{"1", ";;", "2"}], "\[RightDoubleBracket]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"nfev", "++"}], ";"}]}], "\[IndentingNewLine]", "]"}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"x0", " ", "+", " ", "d"}], ",", "fg", ",", "stp", ",", 
        "info", ",", "nfev"}], "}"}]}]}], "\[IndentingNewLine]", "]"}]}], 
  ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.849883883686223*^9, 3.849883903991733*^9}, {
   3.849883990310281*^9, 3.849884029429226*^9}, {3.84988512938907*^9, 
   3.849885236228321*^9}, {3.8498852891303453`*^9, 3.849885475415247*^9}, {
   3.8498855104261017`*^9, 3.8498856064501953`*^9}, {3.849885703814837*^9, 
   3.84988570700117*^9}, {3.8498859152593107`*^9, 3.849885975818481*^9}, {
   3.849886083404541*^9, 3.849886094886197*^9}, {3.8498862265779953`*^9, 
   3.849886257749495*^9}, {3.849886288252227*^9, 3.849886339605171*^9}, {
   3.849886471386203*^9, 3.849886471416864*^9}, {3.8498865020425386`*^9, 
   3.849886502046814*^9}, {3.849888115369492*^9, 3.8498881212463837`*^9}, {
   3.8498881854888983`*^9, 3.8498881933041697`*^9}, {3.849889773207582*^9, 
   3.849889783157937*^9}, {3.849890009657136*^9, 3.849890071073757*^9}, {
   3.849890148170649*^9, 3.849890162698823*^9}, {3.8498902115768137`*^9, 
   3.849890249513049*^9}, {3.849890290386085*^9, 3.849890290728149*^9}, {
   3.849890332153256*^9, 3.849890338905616*^9}, {3.8498918470369177`*^9, 
   3.8498918777336197`*^9}, {3.849893003500836*^9, 3.8498930037974777`*^9}, {
   3.84989651186967*^9, 3.849896549670246*^9}, {3.849896615406604*^9, 
   3.849896627096457*^9}, {3.8498969055451527`*^9, 3.849896918706279*^9}, {
   3.849897656313829*^9, 3.849897657043894*^9}, {3.8498978183775263`*^9, 
   3.8498978184055433`*^9}, 3.849897967403721*^9, {3.849898000899973*^9, 
   3.849898020772238*^9}, 3.849898070674271*^9, {3.84989813275097*^9, 
   3.849898257994688*^9}, {3.849898319397675*^9, 3.849898523843079*^9}, {
   3.849898593860539*^9, 3.849898652780731*^9}, {3.849898695538267*^9, 
   3.8498987534900637`*^9}, {3.8498988227140408`*^9, 
   3.8498988228731327`*^9}, {3.849898964585394*^9, 3.84989899680295*^9}, {
   3.84989909734743*^9, 3.849899102610282*^9}, {3.849900223407037*^9, 
   3.8499002355611467`*^9}, {3.849900285077807*^9, 3.8499002853984213`*^9}, {
   3.849900658534374*^9, 3.849900663203487*^9}, {3.849900693343431*^9, 
   3.849900867341629*^9}, {3.849901008745695*^9, 3.849901010833774*^9}, {
   3.849901226387755*^9, 3.8499012848565407`*^9}, {3.8501877611447897`*^9, 
   3.8501877626783533`*^9}, {3.850187794310369*^9, 3.850187797058967*^9}, {
   3.850187971532555*^9, 3.850187971778294*^9}, {3.850188105993477*^9, 
   3.850188106310652*^9}, 3.850188723848126*^9, {3.8501901490570517`*^9, 
   3.850190266886951*^9}, {3.850190312370481*^9, 3.850190312742819*^9}, {
   3.8501903455768967`*^9, 3.850190367929468*^9}, {3.850190447399701*^9, 
   3.85019044772609*^9}, {3.850190514645327*^9, 3.850190524560926*^9}, {
   3.850190621099559*^9, 3.8501906288271217`*^9}, {3.850190678903104*^9, 
   3.850190732118621*^9}, {3.85019083752456*^9, 3.850190859371907*^9}, {
   3.8502018974968576`*^9, 3.8502019090683527`*^9}, 3.8502022846552067`*^9, {
   3.850203282875722*^9, 3.8502032955364027`*^9}, {3.850203326975368*^9, 
   3.850203448220153*^9}, {3.850203478863791*^9, 3.850203553998301*^9}, {
   3.850203585832535*^9, 3.850203601151716*^9}, {3.8502036588889847`*^9, 
   3.850203775522278*^9}, {3.850210776343657*^9, 3.850210917935104*^9}, {
   3.850211011807682*^9, 3.850211071599354*^9}, {3.8502111183118553`*^9, 
   3.8502111474833317`*^9}, {3.8502111822793694`*^9, 3.850211248898653*^9}, {
   3.850211282970985*^9, 3.850211362935656*^9}, {3.850211404707819*^9, 
   3.8502115128029623`*^9}, {3.8502115875396137`*^9, 3.850211652009069*^9}, {
   3.850211764537643*^9, 3.850211790084629*^9}, {3.850211856103869*^9, 
   3.850211889222829*^9}, {3.8502119647145042`*^9, 3.850212044960536*^9}, {
   3.8502121206839314`*^9, 3.850212170559271*^9}, {3.850212252852206*^9, 
   3.85021226098065*^9}, {3.8502123285490017`*^9, 3.850212353139617*^9}, {
   3.850212553563616*^9, 3.8502129840625668`*^9}, {3.850213053984758*^9, 
   3.8502130707479773`*^9}, {3.850213115017226*^9, 3.850213134544263*^9}, 
   3.850213170740856*^9, {3.8502132103839407`*^9, 3.8502132652898893`*^9}, {
   3.850213327360141*^9, 3.850213533064781*^9}, {3.850213855377468*^9, 
   3.85021385725352*^9}, {3.850213925177062*^9, 3.850213926774436*^9}, {
   3.8502140127738647`*^9, 3.8502140435476*^9}, {3.850214076406708*^9, 
   3.8502140806631804`*^9}, 3.850214219177698*^9, {3.850214276715335*^9, 
   3.850214305982933*^9}, {3.850214452679237*^9, 3.850214472520512*^9}, {
   3.850214669803694*^9, 3.8502146750504017`*^9}, 3.8502147282179337`*^9, {
   3.850214786856104*^9, 3.85021480654996*^9}, {3.8502148501351147`*^9, 
   3.8502148854881907`*^9}, {3.850215087004587*^9, 3.8502151090669813`*^9}, {
   3.850215183403537*^9, 3.8502151844407253`*^9}, {3.850215244541395*^9, 
   3.8502153331119432`*^9}, {3.8502154276682377`*^9, 
   3.8502154797337837`*^9}, {3.8502156487034388`*^9, 3.850215692041066*^9}, {
   3.8502157357170067`*^9, 3.8502157938134937`*^9}, {3.850215846529169*^9, 
   3.850215856786344*^9}, {3.850216034541939*^9, 3.850216049119419*^9}, {
   3.8502161120634527`*^9, 3.85021613226826*^9}, {3.850216278770792*^9, 
   3.8502162792130823`*^9}, {3.8502163385247097`*^9, 3.850216354605132*^9}, {
   3.850216423212851*^9, 3.8502164257582827`*^9}, {3.8502164948247766`*^9, 
   3.8502164970782948`*^9}, {3.8502187056889677`*^9, 3.85021880656487*^9}, {
   3.850218880979349*^9, 3.850218881312354*^9}, {3.850219334462803*^9, 
   3.850219376583309*^9}, {3.850219417255205*^9, 3.850219417846622*^9}, {
   3.85021946016733*^9, 3.850219463511969*^9}, {3.850219522160203*^9, 
   3.850219572290457*^9}, {3.850219607082685*^9, 3.850219633967608*^9}, {
   3.850219729487042*^9, 3.850219732249528*^9}, {3.8502198986121683`*^9, 
   3.850219978947701*^9}, {3.850220105597341*^9, 3.850220133826077*^9}, {
   3.8502202901190367`*^9, 3.850220292491796*^9}, {3.850220356214766*^9, 
   3.850220373406554*^9}, 3.8502204138723497`*^9, 3.850220445616905*^9, {
   3.850220515188547*^9, 3.85022052907513*^9}, {3.850220602379991*^9, 
   3.85022064279382*^9}, 3.8502252772971573`*^9, 
   3.8502253189852037`*^9},ExpressionUUID->"ec2b7adf-b751-40d3-b5ea-\
1554794315b9"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["End Package", "Section",
 InitializationCell->
  True,ExpressionUUID->"1bf2bd9b-80c7-4503-adde-d938e8435fb8"],

Cell[BoxData[{
 RowBox[{"End", "[", "]"}], "\n", 
 RowBox[{"EndPackage", "[", "]"}]}], "Input",
 InitializationCell->True,
 CellLabel->"In[26]:=",ExpressionUUID->"ef66720e-06d7-4a2f-a9a6-da5a338dd6a1"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Example", "Section",ExpressionUUID->"4e553687-a34f-418c-a0e5-13173470ad74"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"f", "[", "x_", "]"}], " ", ":=", " ", 
   RowBox[{
    RowBox[{"100", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"x", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], 
        "\[Minus]", 
        RowBox[{
         RowBox[{"x", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
         "^", "2"}]}], ")"}], "^", "2"}]}], "+", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"1", "\[Minus]", 
       RowBox[{"x", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], 
      ")"}], "^", "2"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"g", "[", "x_", "]"}], " ", ":=", " ", 
   RowBox[{"Evaluate", "@", 
    RowBox[{"Quiet", "@", 
     RowBox[{"D", "[", 
      RowBox[{
       RowBox[{"f", "[", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"x", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}],
           ",", 
          RowBox[{
          "x", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}]}], 
         "}"}], "]"}], ",", " ", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{
           "x", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], ",", 
           " ", 
           RowBox[{
           "x", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}]}], 
          "}"}], ",", " ", "1"}], "}"}]}], "]"}]}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"H", "[", "x_", "]"}], " ", ":=", " ", 
   RowBox[{"Evaluate", "@", 
    RowBox[{"Quiet", "@", 
     RowBox[{"D", "[", 
      RowBox[{
       RowBox[{"f", "[", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"x", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}],
           ",", 
          RowBox[{
          "x", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}]}], 
         "}"}], "]"}], ",", " ", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{
           "x", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], ",", 
           " ", 
           RowBox[{
           "x", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}]}], 
          "}"}], ",", " ", "2"}], "}"}]}], "]"}]}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"F", "[", "x_", "]"}], " ", ":=", " ", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"f", "[", "x", "]"}], ",", " ", 
      RowBox[{"g", "[", "x", "]"}], ",", " ", 
      RowBox[{"H", "[", "x", "]"}]}], "}"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"x0", " ", "=", " ", 
   RowBox[{"{", 
    RowBox[{"0.1", ",", " ", "1.7"}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"{", 
    RowBox[{"f0", ",", " ", "g0", ",", " ", "H0"}], "}"}], " ", "=", " ", 
   RowBox[{"F", "[", "x0", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"s0", " ", "=", " ", 
   RowBox[{"-", 
    RowBox[{"H0", ".", "g0"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"If", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"s0", ".", "g0"}], " ", ">", " ", "0"}], ",", " ", 
    RowBox[{"s0", " ", "=", " ", 
     RowBox[{"-", "s0"}]}]}], "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"ContinuationMethods`Private`ArmijoDriver", "[", 
  RowBox[{"F", ",", " ", "x0", ",", " ", 
   RowBox[{"{", 
    RowBox[{"f0", ",", " ", "g0"}], "}"}], ",", " ", "s0"}], "]"}]}], "Input",
 CellChangeTimes->{
  3.849886471419166*^9, 3.849887365550106*^9, {3.8498899669839363`*^9, 
   3.849889979776383*^9}, 3.8498978184072523`*^9, {3.8499009516644707`*^9, 
   3.849900957840909*^9}, 3.849901025526967*^9, 3.849901941347795*^9, {
   3.850190738571178*^9, 3.850190753263549*^9}, {3.8502136655337563`*^9, 
   3.850213682673238*^9}, 3.850213735728952*^9, {3.850213802711082*^9, 
   3.850213806683022*^9}, 3.850214223631915*^9, 3.8502145808804293`*^9, 
   3.850214933429751*^9, {3.850215126293906*^9, 3.850215132552681*^9}, {
   3.850215216411159*^9, 3.850215217038041*^9}, 3.850215343796906*^9, {
   3.8502155207931356`*^9, 3.850215529365403*^9}, {3.850220659038951*^9, 
   3.8502206622419863`*^9}, {3.850220710001583*^9, 3.8502207260304623`*^9}, 
   3.850220762148004*^9, {3.850229754692471*^9, 3.8502297674491787`*^9}, 
   3.850229802781879*^9},
 CellLabel->
  "In[125]:=",ExpressionUUID->"a549a7e8-e5fc-4f55-84dd-ebad66fede1d"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Old Version", "Section",
 CellChangeTimes->{{3.850220480320651*^9, 
  3.8502204824396563`*^9}},ExpressionUUID->"145fb849-443d-4be1-98fd-\
71a5621eaa4d"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
     RowBox[{"Armijo", "::", "ls"}], " ", "=", " ", 
     "\"\<Could not satisfy sufficient decrease condition with m = ``.\>\""}],
     ";"}], "*)"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
     RowBox[{"Armijo", "[", 
      RowBox[{
      "fcn_", ",", " ", "x0_", ",", " ", "fg0_", ",", " ", "s0_", ",", " ", 
       RowBox[{"OptionsPattern", "[", "]"}]}], "]"}], " ", ":=", " ", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "ret", ",", " ", "\[Alpha]", ",", " ", "\[Beta]", ",", " ", "d", ",", 
         " ", "m0", ",", " ", "mf", ",", " ", "x", ",", " ", "f", ",", " ", 
         "g", ",", " ", "f0", ",", " ", "g0", ",", " ", "a", ",", " ", "stp", 
         ",", " ", "nfev", ",", " ", "info"}], "}"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"\[Alpha]", " ", "=", " ", 
         RowBox[{"OptionValue", "[", "\"\<\[Alpha]\>\"", "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"\[Beta]", " ", "=", " ", 
         RowBox[{"OptionValue", "[", "\"\<stp\>\"", "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"m0", " ", "=", " ", 
         RowBox[{"OptionValue", "[", "\"\<m0\>\"", "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"mf", " ", "=", " ", 
         RowBox[{"OptionValue", "[", "\"\<mf\>\"", "]"}]}], ";", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"nfev", " ", "=", " ", "0"}], ";", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"f0", ",", " ", "g0"}], "}"}], " ", "=", " ", 
         RowBox[{"fg0", "\[LeftDoubleBracket]", 
          RowBox[{"1", ";;", "2"}], "\[RightDoubleBracket]"}]}], ";", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"\[Alpha]", " ", "<", " ", "0"}], " ", "||", " ", 
           RowBox[{"\[Alpha]", " ", ">", " ", "1"}], " ", "||", " ", 
           RowBox[{"\[Beta]", " ", "<", " ", "0"}], " ", "||", " ", 
           RowBox[{"\[Beta]", " ", ">", " ", "1"}]}], ",", " ", 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"Message", "[", 
            RowBox[{
             RowBox[{"Armijo", "::", "args"}], ",", " ", 
             "\"\<\[Alpha] or stp is invalid.\>\""}], "]"}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"Throw", "@", "$Failed"}], ";"}]}], "\[IndentingNewLine]", 
         "]"}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"g0", ".", "s0"}], " ", "\[GreaterEqual]", " ", "0"}], ",",
           " ", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"Message", "[", 
            RowBox[{
             RowBox[{"Armijo", "::", "args"}], ",", " ", 
             "\"\<Not a descent direction.\>\""}], "]"}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"Throw", "@", "$Failed"}], ";"}]}], "\[IndentingNewLine]", 
         "]"}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"Do", "[", "\[IndentingNewLine]", 
         RowBox[{"(*", " ", 
          RowBox[{"line", " ", "search"}], " ", "*)"}], "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{"stp", " ", "=", " ", 
            RowBox[{"\[Beta]", "^", "m"}]}], ";", "\[IndentingNewLine]", 
           RowBox[{"d", " ", "=", " ", 
            RowBox[{"stp", " ", "s0"}]}], ";", "\[IndentingNewLine]", 
           RowBox[{"x", " ", "=", " ", 
            RowBox[{"x0", " ", "+", " ", "d"}]}], ";", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"f", ",", " ", "g"}], "}"}], " ", "=", " ", 
            RowBox[{
             RowBox[{"fcn", "[", "x", "]"}], "\[LeftDoubleBracket]", 
             RowBox[{"1", ";;", "2"}], "\[RightDoubleBracket]"}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"nfev", " ", "=", " ", 
            RowBox[{"nfev", " ", "+", " ", "1"}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"a", " ", "=", " ", 
            RowBox[{
             RowBox[{"f", " ", "-", " ", "f0"}], " ", "\[LessEqual]", " ", 
             RowBox[{"\[Alpha]", " ", 
              RowBox[{"g0", ".", "d"}]}]}]}], ";", "\[IndentingNewLine]", 
           RowBox[{"If", "[", 
            RowBox[{"a", ",", " ", 
             RowBox[{"Break", "[", "]"}]}], "]"}], ";"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"{", 
           RowBox[{"m", ",", " ", "m0", ",", " ", "mf"}], "}"}]}], 
         "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
        "\[IndentingNewLine]", 
        RowBox[{"info", " ", "=", " ", 
         RowBox[{"If", "[", 
          RowBox[{"a", ",", " ", "1", ",", " ", 
           RowBox[{
            RowBox[{"Message", "[", 
             RowBox[{
              RowBox[{"Armijo", "::", "ls"}], ",", " ", 
              RowBox[{"m0", " ", "+", " ", "nfev", " ", "-", " ", "1"}]}], 
             "]"}], ";", " ", "0"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"{", 
         RowBox[{"x", ",", 
          RowBox[{"{", 
           RowBox[{"f", ",", "g"}], "}"}], ",", "stp", ",", "info", ",", 
          "nfev"}], "}"}]}]}], "\[IndentingNewLine]", "]"}]}], ";"}], "*)"}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"Armijo", "[", 
    RowBox[{"F", ",", " ", "x0", ",", " ", 
     RowBox[{"{", 
      RowBox[{"f0", ",", " ", "g0"}], "}"}], ",", " ", "s0"}], "]"}], 
   "*)"}]}]], "Input",
 CellChangeTimes->{{3.849883883686223*^9, 3.849883903991733*^9}, {
   3.849883990310281*^9, 3.849884029429226*^9}, {3.84988512938907*^9, 
   3.849885236228321*^9}, {3.8498852891303453`*^9, 3.849885475415247*^9}, {
   3.8498855104261017`*^9, 3.8498856064501953`*^9}, {3.849885703814837*^9, 
   3.84988570700117*^9}, {3.8498859152593107`*^9, 3.849885975818481*^9}, {
   3.849886083404541*^9, 3.849886094886197*^9}, {3.8498862265779953`*^9, 
   3.849886257749495*^9}, {3.849886288252227*^9, 3.849886339605171*^9}, {
   3.849886471386203*^9, 3.849886471416864*^9}, {3.8498865020425386`*^9, 
   3.849886502046814*^9}, {3.849888115369492*^9, 3.8498881212463837`*^9}, {
   3.8498881854888983`*^9, 3.8498881933041697`*^9}, {3.849889773207582*^9, 
   3.849889783157937*^9}, {3.849890009657136*^9, 3.849890071073757*^9}, {
   3.849890148170649*^9, 3.849890162698823*^9}, {3.8498902115768137`*^9, 
   3.849890249513049*^9}, {3.849890290386085*^9, 3.849890290728149*^9}, {
   3.849890332153256*^9, 3.849890338905616*^9}, {3.8498918470369177`*^9, 
   3.8498918777336197`*^9}, {3.849893003500836*^9, 3.8498930037974777`*^9}, {
   3.84989651186967*^9, 3.849896549670246*^9}, {3.849896615406604*^9, 
   3.849896627096457*^9}, {3.8498969055451527`*^9, 3.849896918706279*^9}, {
   3.849897656313829*^9, 3.849897657043894*^9}, {3.8498978183775263`*^9, 
   3.8498978184055433`*^9}, 3.849897967403721*^9, {3.849898000899973*^9, 
   3.849898020772238*^9}, 3.849898070674271*^9, {3.84989813275097*^9, 
   3.849898257994688*^9}, {3.849898319397675*^9, 3.849898523843079*^9}, {
   3.849898593860539*^9, 3.849898652780731*^9}, {3.849898695538267*^9, 
   3.8498987534900637`*^9}, {3.8498988227140408`*^9, 
   3.8498988228731327`*^9}, {3.849898964585394*^9, 3.84989899680295*^9}, {
   3.84989909734743*^9, 3.849899102610282*^9}, {3.849900223407037*^9, 
   3.8499002355611467`*^9}, {3.849900285077807*^9, 3.8499002853984213`*^9}, {
   3.849900658534374*^9, 3.849900663203487*^9}, {3.849900693343431*^9, 
   3.849900867341629*^9}, {3.849901008745695*^9, 3.849901010833774*^9}, {
   3.849901226387755*^9, 3.8499012848565407`*^9}, {3.8501877611447897`*^9, 
   3.8501877626783533`*^9}, {3.850187794310369*^9, 3.850187797058967*^9}, {
   3.850187971532555*^9, 3.850187971778294*^9}, {3.850188105993477*^9, 
   3.850188106310652*^9}, 3.850188723848126*^9, {3.8501901490570517`*^9, 
   3.850190266886951*^9}, {3.850190312370481*^9, 3.850190312742819*^9}, {
   3.8501903455768967`*^9, 3.850190367929468*^9}, {3.850190447399701*^9, 
   3.85019044772609*^9}, {3.850190514645327*^9, 3.850190524560926*^9}, {
   3.850190621099559*^9, 3.8501906288271217`*^9}, {3.850190678903104*^9, 
   3.850190732118621*^9}, {3.85019083752456*^9, 3.850190859371907*^9}, {
   3.8502018974968576`*^9, 3.8502019090683527`*^9}, 3.8502022846552067`*^9, {
   3.850213625503612*^9, 3.850213646945012*^9}, {3.850213746863802*^9, 
   3.850213750167152*^9}, 3.850220340412459*^9, {3.850220461683352*^9, 
   3.850220462810334*^9}, {3.850220666592319*^9, 
   3.8502206686804857`*^9}},ExpressionUUID->"081d3ed7-ecdb-45ac-b31d-\
41ae64c9cfcb"]
}, Open  ]]
},
AutoGeneratedPackage->Automatic,
WindowSize->{766.8, 789.5999999999999},
WindowMargins->{{Automatic, -6}, {Automatic, 0}},
FrontEndVersion->"12.3 for Microsoft Windows (64-bit) (July 9, 2021)",
StyleDefinitions->"Default.nb",
ExpressionUUID->"2f204b76-925b-412a-bfc7-84208b0b0e80"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[558, 20, 2605, 54, 279, "Code",ExpressionUUID->"1d6d73e4-c217-48bc-a17f-2dfb09dcda35",
 InitializationCell->True],
Cell[3166, 76, 435, 9, 58, "Text",ExpressionUUID->"5c35d829-3669-43fe-bb18-c6fb2216ddc1"],
Cell[CellGroupData[{
Cell[3626, 89, 117, 2, 67, "Section",ExpressionUUID->"fc54ff8f-4e73-4132-9730-f91f80506212",
 InitializationCell->True],
Cell[3746, 93, 537, 10, 64, "Input",ExpressionUUID->"cb6c0dbe-4431-4f14-9f39-fe2a620f6c37",
 InitializationCell->True]
}, Open  ]],
Cell[CellGroupData[{
Cell[4320, 108, 248, 5, 67, "Section",ExpressionUUID->"c85da61e-5377-4f27-b2d3-a8be43386bc2",
 InitializationCell->True],
Cell[4571, 115, 1550, 28, 140, "Input",ExpressionUUID->"3e35e74f-9e43-420a-966b-1de9c2f4a3f8",
 InitializationCell->True],
Cell[6124, 145, 1101, 21, 64, "Input",ExpressionUUID->"b4b6046b-f382-4c77-abc0-a96d564f6dab",
 InitializationCell->True],
Cell[CellGroupData[{
Cell[7250, 170, 291, 5, 54, "Subsection",ExpressionUUID->"5b093abc-2e2c-4e76-a397-46e49cd4a0fd",
 InitializationCell->True],
Cell[7544, 177, 9195, 156, 463, "Input",ExpressionUUID->"fa07d37d-66e0-49bc-8b09-34820865c60d",
 InitializationCell->True]
}, Open  ]],
Cell[CellGroupData[{
Cell[16776, 338, 281, 5, 54, "Subsection",ExpressionUUID->"f41536ae-645d-452a-b5d5-0a9ab63e8f51",
 InitializationCell->True],
Cell[17060, 345, 9363, 158, 463, "Input",ExpressionUUID->"097ae072-31e3-4586-8ba2-ff1ae9ff03e6",
 InitializationCell->True]
}, Open  ]],
Cell[CellGroupData[{
Cell[26460, 508, 278, 5, 74, "Subsection",ExpressionUUID->"087f367a-c755-4eae-bc84-ad3b3fa08c25",
 InitializationCell->True],
Cell[26741, 515, 8231, 135, 685, "Input",ExpressionUUID->"ec2b7adf-b751-40d3-b5ea-1554794315b9",
 InitializationCell->True]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[35021, 656, 115, 2, 95, "Section",ExpressionUUID->"1bf2bd9b-80c7-4503-adde-d938e8435fb8",
 InitializationCell->True],
Cell[35139, 660, 201, 4, 100, "Input",ExpressionUUID->"ef66720e-06d7-4a2f-a9a6-da5a338dd6a1",
 InitializationCell->True]
}, Open  ]],
Cell[CellGroupData[{
Cell[35377, 669, 81, 0, 95, "Section",ExpressionUUID->"4e553687-a34f-418c-a0e5-13173470ad74"],
Cell[35461, 671, 4406, 119, 396, "Input",ExpressionUUID->"a549a7e8-e5fc-4f55-84dd-ebad66fede1d"]
}, Open  ]],
Cell[CellGroupData[{
Cell[39904, 795, 158, 3, 95, "Section",ExpressionUUID->"145fb849-443d-4be1-98fd-71a5621eaa4d"],
Cell[40065, 800, 8738, 170, 1566, "Input",ExpressionUUID->"081d3ed7-ecdb-45ac-b31d-41ae64c9cfcb"]
}, Open  ]]
}
]
*)

